<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jason Curl" />
  <title>C# Coding Standards</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <style type="text/css">
html {
font-size: 100%;
overflow-y: scroll;
-webkit-text-size-adjust: 100%;
-ms-text-size-adjust: 100%;
}
body {
color: #444;
font-family: Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;
font-size: 13px;
line-height: 1.7;
padding: 1em;
margin: auto;
max-width: 20cm;
background: #fefefe;
}
a {
color: #0645ad;
text-decoration: none;
}
a:visited {
color: #0b0080;
}
a:hover {
color: #06e;
}
a:active {
color: #faa700;
}
a:focus {
outline: thin dotted;
}
*::-moz-selection {
background: rgba(255, 255, 0, 0.3);
color: #000;
}
*::selection {
background: rgba(255, 255, 0, 0.3);
color: #000;
}
a::-moz-selection {
background: rgba(255, 255, 0, 0.3);
color: #0645ad;
}
a::selection {
background: rgba(255, 255, 0, 0.3);
color: #0645ad;
}
p {
margin: 1em 0;
}
img {
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
color: #111;
line-height: 125%;
margin-top: 2em;
font-weight: normal;
}
h4, h5, h6 {
font-weight: bold;
}
h1 {
font-size: 2.5em;
}
h2 {
font-size: 2em;
}
h3 {
font-size: 1.5em;
}
h4 {
font-size: 1.2em;
}
h5 {
font-size: 1em;
}
h6 {
font-size: 0.9em;
}
blockquote {
color: #666666;
margin: 0;
padding-left: 3em;
border-left: 0.5em #EEE solid;
}
hr {
display: block;
height: 2px;
border: 0;
border-top: 1px solid #aaa;
border-bottom: 1px solid #eee;
margin: 1em 0;
padding: 0;
}
pre, code, kbd, samp {
color: #000;
background-color: #eee;
font-family: monospace, monospace;
_font-family: 'courier new', monospace;
font-size: 0.90em;
overflow: visible;
}
pre code {

white-space: pre !important;
white-space: pre-wrap !important; 
white-space: -moz-pre-wrap !important; 
white-space: -pre-wrap !important; 
white-space: -o-pre-wrap !important; 
word-wrap: break-word !important; 
}
pre {
font-size: 0.75em;
}
b, strong {
font-weight: bold;
}
dfn {
font-style: italic;
}
ins {
background: #ff9;
color: #000;
text-decoration: none;
}
mark {
background: #e0a0f0;
color: #000;
font-style: italic;
font-weight: bold;
}
sub, sup {
font-size: 75%;
line-height: 0;
position: relative;
vertical-align: baseline;
}
sup {
top: -0.5em;
}
sub {
bottom: -0.25em;
}
ul, ol {
margin: 1em 0;
padding: 0 0 0 2em;
}
li p:last-child {
margin-bottom: 0;
}
ul ul, ol ol {
margin: .3em 0;
}
dl {
margin-bottom: 1em;
}
dt {
font-weight: bold;
margin-bottom: .8em;
}
dd {
margin: 0 0 .8em 2em;
}
dd:last-child {
margin-bottom: 0;
}
img {
border: 0;
-ms-interpolation-mode: bicubic;
vertical-align: middle;
}
figure {
display: block;
text-align: center;
margin: 1em 0;
}
figure img {
border: none;
margin: 0 auto;
}
figcaption {
font-size: 0.8em;
font-style: italic;
margin: 0 0 .8em;
}
table {
margin-bottom: 2em;
border-bottom: 1px solid #ddd;
border-right: 1px solid #ddd;
border-spacing: 0;
border-collapse: collapse;
font-size: 12px;
}
table th {
padding: .2em 1em;
background-color: #eee;
border-top: 1px solid #ddd;
border-left: 1px solid #ddd;
}
table td {
padding: .2em 1em;
border-top: 1px solid #ddd;
border-left: 1px solid #ddd;
vertical-align: top;
}
.author {
font-size: 1.2em;
text-align: center;
}

@media print {
* {
background: transparent !important;
color: black !important;
filter: none !important;
-ms-filter: none !important;
}
body {
max-width: 100%;
}
a, a:visited {
text-decoration: underline;
}
hr {
height: 1px;
border: 0;
border-bottom: 1px solid black;
}
a[href]:after {
content: " (" attr(href) ")";
}
abbr[title]:after {
content: " (" attr(title) ")";
}
.ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
content: "";
}
pre, blockquote {
border: 1px solid #999;
padding-right: 1em;
page-break-inside: avoid;
}
tr, img {
page-break-inside: avoid;
}
img {
max-width: 100% !important;
}
@page :left {
margin: 15mm 20mm 15mm 10mm;
}
@page :right {
margin: 15mm 10mm 15mm 20mm;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3 {
page-break-after: avoid;
}
}</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">C# Coding Standards</h1>
<p class="author">Jason Curl</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><span class="toc-section-number">1</span> Usage of Coding Standards for C#
<ul>
<li><span class="toc-section-number">1.1</span> Introduction</li>
<li><span class="toc-section-number">1.2</span> New Projects</li>
<li><span class="toc-section-number">1.3</span> Existing Projects</li>
<li><span class="toc-section-number">1.4</span> Revision History
<ul>
<li><span class="toc-section-number">1.4.1</span> Version 1.0.0 (2016-07-31)</li>
<li><span class="toc-section-number">1.4.2</span> Version 1.1.0 (2018-06-04)</li>
<li><span class="toc-section-number">1.4.3</span> Version 1.2.0 (2019-11-02)</li>
<li><span class="toc-section-number">1.4.4</span> Version 1.2.1 (2019-11-15)</li>
<li><span class="toc-section-number">1.4.5</span> Version 1.2.2 (2019-12-20)</li>
<li><span class="toc-section-number">1.4.6</span> Version 1.2.3 (2022-06-30)</li>
</ul></li>
</ul></li>
<li><span class="toc-section-number">2</span> Naming
<ul>
<li><span class="toc-section-number">2.1</span> Variable Naming
<ul>
<li><span class="toc-section-number">2.1.1</span> Casing of Parameters and Stack Variables Naming</li>
<li><span class="toc-section-number">2.1.2</span> Module Variables</li>
<li><span class="toc-section-number">2.1.3</span> Variable Types in the Name</li>
</ul></li>
<li><span class="toc-section-number">2.2</span> Name Abbreviations
<ul>
<li><span class="toc-section-number">2.2.1</span> Abbreviations and Contractions</li>
<li><span class="toc-section-number">2.2.2</span> Commonly Used Abbreviations</li>
<li><span class="toc-section-number">2.2.3</span> Casing of Abbreviations</li>
<li><span class="toc-section-number">2.2.4</span> Common Limited Scoped Variables</li>
</ul></li>
<li><span class="toc-section-number">2.3</span> Namespaces
<ul>
<li><span class="toc-section-number">2.3.1</span> Namespace Elements</li>
<li><span class="toc-section-number">2.3.2</span> Unique Naming</li>
</ul></li>
<li><span class="toc-section-number">2.4</span> Class Naming
<ul>
<li><span class="toc-section-number">2.4.1</span> Name of the Class</li>
</ul></li>
<li><span class="toc-section-number">2.5</span> Interfaces
<ul>
<li><span class="toc-section-number">2.5.1</span> Name of the Interface</li>
</ul></li>
</ul></li>
<li><span class="toc-section-number">3</span> Code Formatting Style for C#
<ul>
<li><span class="toc-section-number">3.1</span> Visual Studio 2019 and the .editorconfig</li>
<li><span class="toc-section-number">3.2</span> Colour Scheme in VS2017 and VS2019</li>
<li><span class="toc-section-number">3.3</span> Usage of Braces for Control Statements</li>
<li><span class="toc-section-number">3.4</span> Position of Braces for Control Statements</li>
<li><span class="toc-section-number">3.5</span> Switch and Case Statements</li>
<li><span class="toc-section-number">3.6</span> Spaces for Indentation</li>
<li><span class="toc-section-number">3.7</span> Commenting within the Code</li>
</ul></li>
<li><span class="toc-section-number">4</span> C# Language Specific Features
<ul>
<li><span class="toc-section-number">4.1</span> Using Statements
<ul>
<li><span class="toc-section-number">4.1.1</span> Using System (and non-project references) Inside the Namespace</li>
<li><span class="toc-section-number">4.1.2</span> Using Project References Inside the Namespace</li>
<li><span class="toc-section-number">4.1.3</span> Sort Using</li>
<li><span class="toc-section-number">4.1.4</span> Remove Unused Using</li>
<li><span class="toc-section-number">4.1.5</span> Static Using</li>
</ul></li>
<li><span class="toc-section-number">4.2</span> Parameters
<ul>
<li><span class="toc-section-number">4.2.1</span> Don&#39;t use Optional Parameters for Public API</li>
<li><span class="toc-section-number">4.2.2</span> Named Parameters</li>
<li><span class="toc-section-number">4.2.3</span> Prefer Return Values over ref and out</li>
</ul></li>
<li><span class="toc-section-number">4.3</span> NameOf</li>
<li><span class="toc-section-number">4.4</span> Classes
<ul>
<li><span class="toc-section-number">4.4.1</span> Partial Classes</li>
<li><span class="toc-section-number">4.4.2</span> Nested Classes</li>
<li><span class="toc-section-number">4.4.3</span> Calling the base</li>
</ul></li>
<li><span class="toc-section-number">4.5</span> Types
<ul>
<li><span class="toc-section-number">4.5.1</span> Use the Native Types</li>
<li><span class="toc-section-number">4.5.2</span> Use TypeCasts instead of &#39;as&#39;</li>
<li><span class="toc-section-number">4.5.3</span> Using the &#39;as&#39; and &#39;is&#39; operator</li>
</ul></li>
<li><span class="toc-section-number">4.6</span> Properties
<ul>
<li><span class="toc-section-number">4.6.1</span> Use Auto Properties</li>
<li><span class="toc-section-number">4.6.2</span> Auto Property Assignment</li>
<li><span class="toc-section-number">4.6.3</span> Initialization of Properties that are Read Only</li>
</ul></li>
<li><span class="toc-section-number">4.7</span> Strings
<ul>
<li><span class="toc-section-number">4.7.1</span> String Interpolation (Production Code)</li>
</ul></li>
</ul></li>
<li><span class="toc-section-number">5</span> Design Patterns
<ul>
<li><span class="toc-section-number">5.1</span> Compatibility with .NET
<ul>
<li><span class="toc-section-number">5.1.1</span> CLSCompliant</li>
<li><span class="toc-section-number">5.1.2</span> Case Insensitivity</li>
</ul></li>
<li><span class="toc-section-number">5.2</span> Boxing and Unboxing
<ul>
<li><span class="toc-section-number">5.2.1</span> Using Generics to Avoid Boxing and Unboxing</li>
<li><span class="toc-section-number">5.2.2</span> Enum.HasFlag</li>
<li><span class="toc-section-number">5.2.3</span> Argument Parameters</li>
<li><span class="toc-section-number">5.2.4</span> Tracing</li>
</ul></li>
<li><span class="toc-section-number">5.3</span> Properties
<ul>
<li><span class="toc-section-number">5.3.1</span> Exceptions in Get Properties</li>
<li><span class="toc-section-number">5.3.2</span> Property State</li>
<li><span class="toc-section-number">5.3.3</span> Property Changed Events</li>
<li><span class="toc-section-number">5.3.4</span> Boolean State Properties</li>
<li><span class="toc-section-number">5.3.5</span> Read Only and Write Only Properties</li>
<li><span class="toc-section-number">5.3.6</span> Don&#39;t Expose Public Fields</li>
</ul></li>
<li><span class="toc-section-number">5.4</span> Methods
<ul>
<li><span class="toc-section-number">5.4.1</span> Overloading</li>
<li><span class="toc-section-number">5.4.2</span> Overloading instead of Default Arguments</li>
<li><span class="toc-section-number">5.4.3</span> Overloading Specific Types</li>
<li><span class="toc-section-number">5.4.4</span> Overloaded methods should be adjacent</li>
<li><span class="toc-section-number">5.4.5</span> Ordering of Parameters of Overloaded Methods</li>
<li><span class="toc-section-number">5.4.6</span> Variable Number of Arguments</li>
</ul></li>
<li><span class="toc-section-number">5.5</span> Strings
<ul>
<li><span class="toc-section-number">5.5.1</span> String Comparisons</li>
<li><span class="toc-section-number">5.5.2</span> Generic Collections</li>
</ul></li>
<li><span class="toc-section-number">5.6</span> Constructors
<ul>
<li><span class="toc-section-number">5.6.1</span> No Blocking Behavior</li>
<li><span class="toc-section-number">5.6.2</span> Static Only Classes</li>
<li><span class="toc-section-number">5.6.3</span> Structs Empty Constructor</li>
<li><span class="toc-section-number">5.6.4</span> Structs Constructor for Initialisation</li>
<li><span class="toc-section-number">5.6.5</span> Copying and Side Effects</li>
<li><span class="toc-section-number">5.6.6</span> Organizing Class Constructors with Default Parameters</li>
</ul></li>
<li><span class="toc-section-number">5.7</span> Dispose Pattern (IDispose)
<ul>
<li><span class="toc-section-number">5.7.1</span> Sealed Classes</li>
<li><span class="toc-section-number">5.7.2</span> Virtual Classes</li>
<li><span class="toc-section-number">5.7.3</span> Unmanaged Resources</li>
</ul></li>
<li><span class="toc-section-number">5.8</span> Using &#39;null&#39;
<ul>
<li><span class="toc-section-number">5.8.1</span> Nullable Types</li>
<li><span class="toc-section-number">5.8.2</span> Null Inputs and Null Properties</li>
</ul></li>
<li><span class="toc-section-number">5.9</span> Singletons
<ul>
<li><span class="toc-section-number">5.9.1</span> Usage</li>
<li><span class="toc-section-number">5.9.2</span> Implementing a Singleton</li>
</ul></li>
<li><span class="toc-section-number">5.10</span> Common Implementations
<ul>
<li><span class="toc-section-number">5.10.1</span> Buffers and Range Checking</li>
</ul></li>
<li><span class="toc-section-number">5.11</span> Critical Sections
<ul>
<li><span class="toc-section-number">5.11.1</span> Use Locks instead of Monitor</li>
<li><span class="toc-section-number">5.11.2</span> Define an Object for a Lock</li>
<li><span class="toc-section-number">5.11.3</span> Locks shall be readonly</li>
</ul></li>
<li><span class="toc-section-number">5.12</span> Tasks and Parallel Programming
<ul>
<li><span class="toc-section-number">5.12.1</span> Prefer async/await over BeginXXX and EndXXX</li>
<li><span class="toc-section-number">5.12.2</span> Never Use Referenced Parameters for output</li>
<li><span class="toc-section-number">5.12.3</span> Tuples</li>
</ul></li>
<li><span class="toc-section-number">5.13</span> Synchronization
<ul>
<li><span class="toc-section-number">5.13.1</span> Thread.Resume and Thread.Suspend</li>
<li><span class="toc-section-number">5.13.2</span> Thread.Sleep</li>
<li><span class="toc-section-number">5.13.3</span> Do Not Synchronize on Operating System Real-Time Clock</li>
</ul></li>
<li><span class="toc-section-number">5.14</span> Safe Handles
<ul>
<li><span class="toc-section-number">5.14.1</span> Unmanaged Handles</li>
<li><span class="toc-section-number">5.14.2</span> DangerousGetHandle</li>
</ul></li>
<li><span class="toc-section-number">5.15</span> Exceptions
<ul>
<li><span class="toc-section-number">5.15.1</span> Naming</li>
<li><span class="toc-section-number">5.15.2</span> Implementation</li>
<li><span class="toc-section-number">5.15.3</span> Serializable</li>
<li><span class="toc-section-number">5.15.4</span> Program Execution Flow</li>
<li><span class="toc-section-number">5.15.5</span> Returning Exceptions</li>
<li><span class="toc-section-number">5.15.6</span> System Exceptions</li>
<li><span class="toc-section-number">5.15.7</span> Debug and Release Mode</li>
<li><span class="toc-section-number">5.15.8</span> Deriving Exceptions</li>
<li><span class="toc-section-number">5.15.9</span> Extra Information</li>
</ul></li>
<li><span class="toc-section-number">5.16</span> Events
<ul>
<li><span class="toc-section-number">5.16.1</span> Implementing IDispose</li>
<li><span class="toc-section-number">5.16.2</span> EventArgs</li>
<li><span class="toc-section-number">5.16.3</span> Generic EventHandler&lt;T&gt;</li>
<li><span class="toc-section-number">5.16.4</span> Non-Generic EventHandler</li>
<li><span class="toc-section-number">5.16.5</span> Event Naming</li>
<li><span class="toc-section-number">5.16.6</span> OnEvent Protected Method</li>
<li><span class="toc-section-number">5.16.7</span> Pre-Events and Post-Events</li>
</ul></li>
<li><span class="toc-section-number">5.17</span> Streams
<ul>
<li><span class="toc-section-number">5.17.1</span> Naming</li>
<li><span class="toc-section-number">5.17.2</span> Simultaneous Reading and Writing</li>
</ul></li>
<li><span class="toc-section-number">5.18</span> Attributes</li>
<li><span class="toc-section-number">5.19</span> Abstract Classes
<ul>
<li><span class="toc-section-number">5.19.1</span> Object Oriented Design</li>
<li><span class="toc-section-number">5.19.2</span> Abstract Class Constructors</li>
<li><span class="toc-section-number">5.19.3</span> Abstract vs. Interfaces</li>
</ul></li>
<li><span class="toc-section-number">5.20</span> Single Responsibility Principle
<ul>
<li><span class="toc-section-number">5.20.1</span> Responsibility and Policy</li>
</ul></li>
<li><span class="toc-section-number">5.21</span> The Model
<ul>
<li><span class="toc-section-number">5.21.1</span> Small and Simple Applications - The Model folder</li>
</ul></li>
<li><span class="toc-section-number">5.22</span> Object Oriented Design
<ul>
<li><span class="toc-section-number">5.22.1</span> Object Inheritance and Code Reuse</li>
<li><span class="toc-section-number">5.22.2</span> Extending Objects and the Open/Closed Principle</li>
</ul></li>
</ul></li>
<li><span class="toc-section-number">6</span> Public Documentation
<ul>
<li><span class="toc-section-number">6.1</span> Assembly Public Documentation for Framework Components</li>
<li><span class="toc-section-number">6.2</span> SHFB</li>
<li><span class="toc-section-number">6.3</span> Build Conditions</li>
<li><span class="toc-section-number">6.4</span> Spelling and Grammar</li>
</ul></li>
<li><span class="toc-section-number">7</span> Testing
<ul>
<li><span class="toc-section-number">7.1</span> The Model
<ul>
<li><span class="toc-section-number">7.1.1</span> Application Methods should be Public</li>
<li><span class="toc-section-number">7.1.2</span> Appropriate Model</li>
<li><span class="toc-section-number">7.1.3</span> Test Patterns</li>
</ul></li>
<li><span class="toc-section-number">7.2</span> Unit Testing
<ul>
<li><span class="toc-section-number">7.2.1</span> Test Project Structure</li>
<li><span class="toc-section-number">7.2.2</span> NUnit Test Framework</li>
</ul></li>
<li><span class="toc-section-number">7.3</span> Accessor Framework and Internal Classes
<ul>
<li><span class="toc-section-number">7.3.1</span> InternalsVisibleTo</li>
<li><span class="toc-section-number">7.3.2</span> AccessorBase</li>
<li><span class="toc-section-number">7.3.3</span> Internal and Private Members</li>
</ul></li>
<li><span class="toc-section-number">7.4</span> Debug and Conditional Checks
<ul>
<li><span class="toc-section-number">7.4.1</span> Debug.Assert</li>
<li><span class="toc-section-number">7.4.2</span> Contracts</li>
</ul></li>
</ul></li>
<li><span class="toc-section-number">8</span> Visual Studio Extensions
<ul>
<li><span class="toc-section-number">8.1</span> Spell Checker (High)</li>
<li><span class="toc-section-number">8.2</span> GhostDoc (Commercial, Mid)</li>
<li><span class="toc-section-number">8.3</span> ReSharper (Commercial, Low)</li>
<li><span class="toc-section-number">8.4</span> Concurrency Analysis (Mid)</li>
</ul></li>
<li><span class="toc-section-number">9</span> Visual Studio Analyzers
<ul>
<li><span class="toc-section-number">9.1</span> Difference between VSIX and NuGet Analyzers</li>
<li><span class="toc-section-number">9.2</span> Suppression of Rules
<ul>
<li><span class="toc-section-number">9.2.1</span> Pragma Usage</li>
<li><span class="toc-section-number">9.2.2</span> VSIX Global Suppression</li>
<li><span class="toc-section-number">9.2.3</span> NuGet Global Suppression</li>
<li><span class="toc-section-number">9.2.4</span> Suppression in Source</li>
<li><span class="toc-section-number">9.2.5</span> Suppression with .editorconfig</li>
<li><span class="toc-section-number">9.2.6</span> False Positives</li>
</ul></li>
<li><span class="toc-section-number">9.3</span> SonarLint for Visual Studio (High)
<ul>
<li><span class="toc-section-number">9.3.1</span> Rules which should not be ignored</li>
<li><span class="toc-section-number">9.3.2</span> Aesthetic Rules which Should be Enabled</li>
<li><span class="toc-section-number">9.3.3</span> Rules for Disablement</li>
</ul></li>
<li><span class="toc-section-number">9.4</span> Visual Studio 2019 Code Analyzers (v16.3.9)
<ul>
<li><span class="toc-section-number">9.4.1</span> Rules Which should not be Ignored</li>
<li><span class="toc-section-number">9.4.2</span> Aesthetic Rules which Should be Enabled</li>
<li><span class="toc-section-number">9.4.3</span> Rules for Disablement</li>
</ul></li>
<li><span class="toc-section-number">9.5</span> Code Analysis: Mandatory Ruleset (Microsoft Managed Recommended Rules)
<ul>
<li><span class="toc-section-number">9.5.1</span> Microsoft Binary Analysis (Mid-High)</li>
<li><span class="toc-section-number">9.5.2</span> Microsoft.CodeAnalysis.CSharp</li>
<li><span class="toc-section-number">9.5.3</span> Microsoft.CodeAnalysis.CSharp.EditorFeatures</li>
<li><span class="toc-section-number">9.5.4</span> Microsoft.CodeAnalysis.CSharp.Features</li>
</ul></li>
</ul></li>
</ul>
</nav>
STANDARDS
<h1 data-number="1"><span class="header-section-number">1</span> Usage of Coding Standards for C#</h1>
<p><sup><em>Requirement: CREQ0001; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:04:00Z; Modified: 2015-11-30 21:20:05Z.</em></sup></p>
<h2 data-number="1.1"><span class="header-section-number">1.1</span> Introduction</h2>
<p><sup><em>Requirement: CREQ0002; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:06:10Z; Modified: 2019-11-02 12:25:22Z.</em></sup></p>
<p>There are two aspects to coding standards:</p>
<ul>
<li><p>Guidelines to assist developers in reading and identifying code, especially in teams of two or more developers. This assists developers in better understanding the intentions of others.</p></li>
<li><p>Applying design patterns. By documenting lessons learned in previous projects, the application of design patterns can improve code readability, design and reduce the chance of defects by less experienced developers.</p></li>
</ul>
<p>Where possible, coding standards should also include rationale, to help assist developers in understanding <em>why</em> such a coding standard exists and how it is intended to benefit the project.</p>
<p>These coding standards use the text <strong>Rationale</strong>to explain any reasoning behind decisions in implementation. This also encourages developers to decide on a more appropriate guideline, or to decide the circumstances under which a guideline should be applied. It also challenges the author of such a guideline to justify the means for a restriction on the writing of code, which may lead to a more solid foundation of the guidelines, or an update improving the guidelines themselves.</p>
<p>Keywords and coding words are in bold, such as <strong>return</strong>, <strong>IEnumerable</strong>, etc.</p>
<h2 data-number="1.2"><span class="header-section-number">1.2</span> New Projects</h2>
<p><sup><em>Requirement: CREQ0003; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:04:49Z; Modified: 2015-11-30 21:05:12Z.</em></sup></p>
<p>New project should strive to conform to this set of coding standards where it&#39;s mandated.</p>
<h2 data-number="1.3"><span class="header-section-number">1.3</span> Existing Projects</h2>
<p><sup><em>Requirement: CREQ0004; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:05:16Z; Modified: 2015-11-30 21:05:53Z.</em></sup></p>
<p>Coding standards for existing projects should be maintained. That is, do not rewrite large chunks of code simply because it doesn&#39;t conform to the coding standards. Adhere to the standards that are in use for that project.</p>
<h2 data-number="1.4"><span class="header-section-number">1.4</span> Revision History</h2>
<p><sup><em>Requirement: CREQ0186; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:40:30Z; Modified: 2019-11-01 21:40:34Z.</em></sup></p>
<h3 data-number="1.4.1"><span class="header-section-number">1.4.1</span> Version 1.0.0 (2016-07-31)</h3>
<p><sup><em>Requirement: CREQ0188; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:42:38Z; Modified: 2019-11-01 21:43:31Z.</em></sup></p>
<p>Initial version of the coding standards, taken from various sources and experience from code reviews.</p>
<h3 data-number="1.4.2"><span class="header-section-number">1.4.2</span> Version 1.1.0 (2018-06-04)</h3>
<p><sup><em>Requirement: CREQ0189; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:43:36Z; Modified: 2019-11-01 21:55:30Z.</em></sup></p>
<p>Following changes</p>
<ul>
<li><p>CREQ0012: Change constants to have no prefix</p></li>
<li><p>CREQ0029: A title &quot;Ordering&quot; without content</p></li>
</ul>
<ul>
<li><p>CREQ0070: Title change to SafeHandles</p></li>
<li><p>CREQ0071: Added rationale for SafeHandles</p></li>
</ul>
<ul>
<li><p>CREQ0103: The Model, and design principles</p></li>
<li><p>CREQ0105: NUnit Test Framework should be used instead of MSTest</p></li>
</ul>
<ul>
<li><p>CREQ0137: Define pseudo constants (private static readonly variables)</p></li>
<li><p>CREQ0129: Implementing a Singleton in C#</p></li>
<li><p>CREQ0130: Critical Sections and subsection</p></li>
<li><p>CREQ0135: Optional Parameters and subsection</p></li>
<li><p>CREQ0138: Abstract classes</p></li>
<li><p>CREQ0142: Null conditional operator, do not use for event handlers</p></li>
<li><p>CREQ0148: Use of nameof keyword</p></li>
<li><p>CREQ0149: Don&#39;t use named parameters</p></li>
<li><p>CREQ0150: SafeHandle and DangerousGetHandle</p></li>
</ul>
<ul>
<li><p>CREQ0151: Avoid side effects in construction</p></li>
<li><p>CREQ0152: Use AccessorBase implementation</p></li>
<li><p>CREQ0156: Single Responsibility Principle</p></li>
<li><p>CREQ0158: Virtual protected methods for Events</p></li>
<li><p>CREQ0159: Don&#39;t use Enum.HasFlag</p></li>
<li><p>CREQ0160: Argument Parameters (boxing/unboxing)</p></li>
</ul>
<h3 data-number="1.4.3"><span class="header-section-number">1.4.3</span> Version 1.2.0 (2019-11-02)</h3>
<p><sup><em>Requirement: CREQ0187; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:40:39Z; Modified: 2019-11-04 20:11:49Z.</em></sup></p>
<p>Following changes</p>
<ul>
<li><p>CREQ0162: String comparisons</p></li>
<li><p>CREQ0175: Design patterns for testing</p></li>
<li><p>CREQ0177: Debug and conditional checks</p></li>
<li><p>CREQ0181: Common implementation, buffer range checks</p></li>
<li><p>CREQ0182: Editor Config file</p></li>
<li><p>CREQ0183: Sort usings</p></li>
<li><p>CREQ0185: Don&#39;t use static usings.</p></li>
<li><p>CREQ0190: Organizing test code</p></li>
<li><p>CREQ0195-202: NUnit Asserts and Fluent style</p></li>
<li><p>CREQ0203: Visual Studio Analyzers, codes and rationale</p></li>
<li><p>CREQ0235: Overloads should be adjacent</p></li>
<li><p>CREQ0293: New section on types</p></li>
<li><p>CREQ0297: New section about classes</p></li>
<li><p>CREQ0300: New section about properties</p></li>
<li><p>CREQ0305: String interpolation</p></li>
<li><p>CREQ0306: Rule Suppression</p></li>
<li><p>CREQ0313: Synchronization Primitives</p></li>
</ul>
<h3 data-number="1.4.4"><span class="header-section-number">1.4.4</span> Version 1.2.1 (2019-11-15)</h3>
<p><sup><em>Requirement: CREQ0318; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-06 19:14:53Z; Modified: 2019-11-15 20:17:55Z.</em></sup></p>
<p>Following changes</p>
<ul>
<li><p>CREQ0317: IDE0016, IDE0066, IDE1006 should be disabled</p></li>
<li><p>CREQ0321: Null</p></li>
<li><p>CREQ0324: Object Oriented Design</p></li>
</ul>
<h3 data-number="1.4.5"><span class="header-section-number">1.4.5</span> Version 1.2.2 (2019-12-20)</h3>
<p><sup><em>Requirement: CREQ0328; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-09 07:32:54Z; Modified: 2019-12-20 14:46:44Z.</em></sup></p>
<p>Following changes</p>
<ul>
<li><p>CREQ0058: Renamed to blocking behaviour</p></li>
<li><p>CREQ0327: Document using factories to easily convert o async</p></li>
<li><p>CREQ0330: Async programming model</p></li>
</ul>
<h3 data-number="1.4.6"><span class="header-section-number">1.4.6</span> Version 1.2.3 (2022-06-30)</h3>
<p><sup><em>Requirement: CREQ0335; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2022-05-07 10:38:49Z; Modified: 2022-06-29 21:37:51Z.</em></sup></p>
<p>Following changes</p>
<ul>
<li><p>CREQ0215: Allow P/Invoke for partial classes</p></li>
<li><p>CREQ0336: Single character variables</p></li>
<li><p>CREQ0337: Read Only Properties</p></li>
</ul>
<h1 data-number="2"><span class="header-section-number">2</span> Naming</h1>
<p><sup><em>Requirement: CREQ0005; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:05:22Z; Modified: 2015-11-10 21:05:24Z.</em></sup></p>
<h2 data-number="2.1"><span class="header-section-number">2.1</span> Variable Naming</h2>
<p><sup><em>Requirement: CREQ0006; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:38:52Z; Modified: 2019-11-02 12:26:16Z.</em></sup></p>
<p>The variable naming scheme was chosen during the initial development of the Automation framework based on the .NET framework reference sources. The .NET reference sources have changed since then, these guidelines maintain some rules for historical reasons, and some more modern rules.</p>
<h3 data-number="2.1.1"><span class="header-section-number">2.1.1</span> Casing of Parameters and Stack Variables Naming</h3>
<p><sup><em>Requirement: CREQ0007; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:42:15Z; Modified: 2015-11-10 21:10:30Z.</em></sup></p>
<p>Names of private variables (variables defined on the stack of a method, or naming of parameters in a method) shall follow camelCasing with the initial letter being lower case.</p>
<h3 data-number="2.1.2"><span class="header-section-number">2.1.2</span> Module Variables</h3>
<p><sup><em>Requirement: CREQ0008; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:53:42Z; Modified: 2015-11-09 08:53:44Z.</em></sup></p>
<h4 data-number="2.1.2.1"><span class="header-section-number">2.1.2.1</span> Module Variable Casing Naming</h4>
<p><sup><em>Requirement: CREQ0009; Author: jcurl; Status: Approved; Version: 1.0; Created: 2015-11-09 08:54:54Z; Modified: 2017-07-10 16:34:52Z.</em></sup></p>
<p>The module variable shall have a prefix, followed by the name in PascalCasing with a capital letter at the beginning.</p>
<h4 data-number="2.1.2.2"><span class="header-section-number">2.1.2.2</span> Module Global Prefix</h4>
<p><sup><em>Requirement: CREQ0010; Author: jcurl; Status: Approved; Version: 1.0; Created: 2015-11-09 08:40:37Z; Modified: 2019-11-02 15:44:38Z.</em></sup></p>
<p>Module global names shall have the scope of private, and be prefixed with <strong>m_</strong></p>
<p><strong>Example</strong>:</p>
<pre><code>private string m_Name;</code></pre>
<h4 data-number="2.1.2.3"><span class="header-section-number">2.1.2.3</span> Module Static Prefix</h4>
<p><sup><em>Requirement: CREQ0011; Author: jcurl; Status: Approved; Version: 1.0; Created: 2015-11-09 08:41:03Z; Modified: 2022-05-07 10:34:25Z.</em></sup></p>
<p>Module global static names shall have the scope of private, and be prefixed with <strong>s_</strong></p>
<p><strong>Example</strong>:</p>
<pre><code>private static object s_Lock = new object();</code></pre>
<h4 data-number="2.1.2.4"><span class="header-section-number">2.1.2.4</span> Module Constants Prefix</h4>
<p><sup><em>Requirement: CREQ0012; Author: jcurl; Status: Approved; Version: 1.0; Created: 2015-11-09 08:41:52Z; Modified: 2019-11-02 12:26:42Z.</em></sup></p>
<p>Modules with <strong>public</strong>, <strong>protected</strong>, <strong>internal</strong>and <strong>private</strong>scope shall have no prefix.</p>
<p><strong>Example</strong>:</p>
<pre><code>private const string DefaultName = &quot;Default&quot;;
public const int NoSizeLimit = 0;</code></pre>
<h4 data-number="2.1.2.5"><span class="header-section-number">2.1.2.5</span> Pseudo Constants (Private Static Readonly)</h4>
<p><sup><em>Requirement: CREQ0137; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-07-10 17:55:33Z; Modified: 2019-11-02 12:27:03Z.</em></sup></p>
<p>In some cases, the intention of a variable is for it to be a constant (but cannot be due to runtime considerations). Variables marked as <strong>private static readonly Xx[] Value</strong> may be also considered as a constant.</p>
<p><strong>Example</strong>:</p>
<pre><code>private static readonly short[] Table = { ... };</code></pre>
<h3 data-number="2.1.3"><span class="header-section-number">2.1.3</span> Variable Types in the Name</h3>
<p><sup><em>Requirement: CREQ0013; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:53:23Z; Modified: 2015-11-09 08:53:27Z.</em></sup></p>
<h4 data-number="2.1.3.1"><span class="header-section-number">2.1.3.1</span> Type Name in the Class Type</h4>
<p><sup><em>Requirement: CREQ0014; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:55:47Z; Modified: 2016-07-25 20:32:52Z.</em></sup></p>
<p>Naming of new classes should follow the naming guidelines of MSDN (TBD: Reference).</p>
<p>Such examples are:</p>
<ul>
<li><p>class MyStream : Stream</p></li>
<li><p>class MyEventArgs : EventArgs</p></li>
<li><p>class MyException : Exception</p></li>
<li><p>class MyAttribute : Attribute</p></li>
</ul>
<p>This is different to Hungarian notation where the type name is abbreviated and placed first.</p>
<h4 data-number="2.1.3.2"><span class="header-section-number">2.1.3.2</span> Hungarian Notation</h4>
<p><sup><em>Requirement: CREQ0015; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:43:07Z; Modified: 2015-11-09 08:53:31Z.</em></sup></p>
<p>Hungarian notation shall not be used for any non-Windows forms code.</p>
<h4 data-number="2.1.3.3"><span class="header-section-number">2.1.3.3</span> Windows Forms Hungarian Notation</h4>
<p><sup><em>Requirement: CREQ0016; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:44:02Z; Modified: 2022-06-29 20:37:08Z.</em></sup></p>
<p>A best practice from Visual Basic (since version 3!) is to use Hungarian notation for the identification of GUI objects. This makes it easy to identify the type of control being references, as well as to sort the controls.</p>
<p>Objects in a Windows Forms project shall be prefixed with the object type (starting in lower case), followed by a more detailed description of the object.</p>
<h5 data-number="2.1.3.3.1"><span class="header-section-number">2.1.3.3.1</span> Recommended Abbreviations for Windows Forms</h5>
<p><sup><em>Requirement: CREQ0017; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:45:14Z; Modified: 2022-06-29 20:37:33Z.</em></sup></p>
<p>An example is given at: https://support.microsoft.com/en-us/kb/173738</p>
<p>The following prefixes for Windows forms should be used:</p>
<ul>
<li><p>btn - Button Control</p></li>
</ul>
<ul>
<li><p>chk - Checkbox</p></li>
<li><p>cmb - Combobox</p></li>
<li><p>fra - Frame</p></li>
<li><p>frm - Form</p></li>
<li><p>grp - Group Box</p></li>
<li><p>img - Image list</p></li>
<li><p>lbl - Label</p></li>
<li><p>lbltxt - A Label control that usually prefixes a Text control in the tabbing order of the same name.</p></li>
<li><p>lst - List Control</p></li>
<li><p>lvw - List View</p></li>
<li><p>opt - Option Button</p></li>
<li><p>pic - Picture Control</p></li>
<li><p>prg - Progress Bar</p></li>
<li><p>tab - Tab Control</p></li>
<li><p>tvw - Tree View</p></li>
<li><p>txt - Text Control</p></li>
<li><p>mnu - Menu Item</p></li>
</ul>
<p>Other prefixes are sometimes used in projects. The project should be at least consistent in the usage of the prefixes. For example:</p>
<ul>
<li><p>but, cmd - Button</p></li>
<li><p>cbo - Combo Box</p></li>
<li><p>lstv - List View</p></li>
<li><p>pro - Progress Bar</p></li>
<li><p>rdo - Radio Button (option button)</p></li>
<li><p>tre - Tree View</p></li>
</ul>
<h2 data-number="2.2"><span class="header-section-number">2.2</span> Name Abbreviations</h2>
<p><sup><em>Requirement: CREQ0018; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:19:32Z; Modified: 2015-11-16 21:06:31Z.</em></sup></p>
<h3 data-number="2.2.1"><span class="header-section-number">2.2.1</span> Abbreviations and Contractions</h3>
<p><sup><em>Requirement: CREQ0019; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:06:03Z; Modified: 2017-08-12 18:25:22Z.</em></sup></p>
<p>Variable names should avoid abbreviations or contractions of identifiers where possible and be correctly spelled.</p>
<p><strong>GOOD</strong>: TraceServer</p>
<p><strong>BAD</strong>: TraceSvr</p>
<p><strong>GOOD</strong>: CommandLine</p>
<p><strong>BAD</strong>: CmdLine</p>
<h3 data-number="2.2.2"><span class="header-section-number">2.2.2</span> Commonly Used Abbreviations</h3>
<p><sup><em>Requirement: CREQ0020; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:06:59Z; Modified: 2017-08-12 18:25:31Z.</em></sup></p>
<p>The usage of appropriate abbreviations should be used where they are common in the computing domain.</p>
<p><strong>Example</strong>: Dns, Xml, IP, IO, Gui, Http</p>
<h3 data-number="2.2.3"><span class="header-section-number">2.2.3</span> Casing of Abbreviations</h3>
<p><sup><em>Requirement: CREQ0021; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:08:06Z; Modified: 2019-11-04 19:54:47Z.</em></sup></p>
<p>Common abbreviations that are two characters should be both upper case. Abbreviations of three characters or more should be capitalized, with the remaining characters being lower case.</p>
<p><strong>Example</strong>:</p>
<p>The namespace <strong>MyCompany.IO</strong> is preferred over <strong>MyCompany.Io</strong>.</p>
<h3 data-number="2.2.4"><span class="header-section-number">2.2.4</span> Common Limited Scoped Variables</h3>
<p><sup><em>Requirement: CREQ0336; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2022-06-29 20:38:02Z; Modified: 2022-06-29 21:15:21Z.</em></sup></p>
<p>Simple variable names may be used where there use is limited in scope.</p>
<p><strong>Example</strong>: for (int i = 0; i &lt; 10; i++) { ... }</p>
<p><strong>Example</strong>: while (i &lt; 10) { char c = myVar[i]; i++ }</p>
<p><strong>Example</strong>: float f = 10.0;</p>
<p><strong>Rationale</strong>:</p>
<p>Variables should be concise, accurate and reflect the domain in which they&#39;re used. Cartesian coordinates such as p = (x, y, z), or loop variables i, j, k (and similar single character names, as taken from Fortran 77) for example. The higher the cyclomatic complexity, the less suitable single character variables. And so this is dependent on the ideas being expressed in code.</p>
<h2 data-number="2.3"><span class="header-section-number">2.3</span> Namespaces</h2>
<p><sup><em>Requirement: CREQ0022; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:02:22Z; Modified: 2015-11-10 21:05:53Z.</em></sup></p>
<h3 data-number="2.3.1"><span class="header-section-number">2.3.1</span> Namespace Elements</h3>
<p><sup><em>Requirement: CREQ0023; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:10:38Z; Modified: 2022-06-29 21:17:19Z.</em></sup></p>
<p>The first element(s) of the namespace should represent the organization, followed by the technology, then further the feature and design.</p>
<p><strong>Example</strong>:</p>
<ul>
<li><p>RJCP.Log.Dlt</p></li>
<li><p>RJCP.Windows.Forms</p></li>
</ul>
<h3 data-number="2.3.2"><span class="header-section-number">2.3.2</span> Unique Naming</h3>
<p><sup><em>Requirement: CREQ0024; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:06:30Z; Modified: 2017-12-26 14:49:51Z.</em></sup></p>
<p>A class name should be different to any of the existing names in the namespace, or resolvable class names.</p>
<p><strong>Example</strong>:</p>
<pre><code>namespace NS1 {
  class CS1 { }
}</code></pre>
<pre><code>namespace NS1.NS2 {
  // Not allowed
  class CS1 { }
}</code></pre>
<pre><code>namespace NS1 {
  // Not allowed
  class NS2 { }
}</code></pre>
<h2 data-number="2.4"><span class="header-section-number">2.4</span> Class Naming</h2>
<p><sup><em>Requirement: CREQ0025; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:12:40Z; Modified: 2015-11-16 21:12:44Z.</em></sup></p>
<h3 data-number="2.4.1"><span class="header-section-number">2.4.1</span> Name of the Class</h3>
<p><sup><em>Requirement: CREQ0026; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:12:45Z; Modified: 2015-11-16 21:13:47Z.</em></sup></p>
<p>The name of the class should be a noun, or a noun phrase, following the general naming rules given above (PascalCasing, no underscores, etc.).</p>
<h2 data-number="2.5"><span class="header-section-number">2.5</span> Interfaces</h2>
<p><sup><em>Requirement: CREQ0027; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:14:06Z; Modified: 2015-11-16 21:14:09Z.</em></sup></p>
<h3 data-number="2.5.1"><span class="header-section-number">2.5.1</span> Name of the Interface</h3>
<p><sup><em>Requirement: CREQ0028; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:14:11Z; Modified: 2015-11-16 21:14:53Z.</em></sup></p>
<p>Interfaces should follow the same rules as the Class, but always begin with the capital letter &#39;I&#39; (i).</p>
<h1 data-number="3"><span class="header-section-number">3</span> Code Formatting Style for C#</h1>
<p><sup><em>Requirement: CREQ0030; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:43:07Z; Modified: 2015-11-10 20:51:37Z.</em></sup></p>
<p>The coding style attempts to provide as much information as possible on a single screen to help avoid errors associated with complexity.</p>
<ul>
<li><p>Reduce the amount of whitespace on the screen, so that each method should ideally fit within a single screen. If a method is longer, then the cyclomatic complexity is likely too high.</p></li>
<li><p>Make it visually easier to identify where a method starts and then stops.</p></li>
</ul>
<h2 data-number="3.1"><span class="header-section-number">3.1</span> Visual Studio 2019 and the .editorconfig</h2>
<p><sup><em>Requirement: CREQ0182; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:29:10Z; Modified: 2019-11-01 21:30:13Z.</em></sup></p>
<p>The project should define a file called <strong>.editorconfig</strong>, which is in the root folder. The configuration file should define the styles given in this coding standard.</p>
<h2 data-number="3.2"><span class="header-section-number">3.2</span> Colour Scheme in VS2017 and VS2019</h2>
<p><sup><em>Requirement: CREQ0329; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-15 20:39:53Z; Modified: 2019-12-15 20:40:43Z.</em></sup></p>
<p>Do not use the High Contrast colour scheme in Visual Studio. It has been observed that &quot;fade unused code blocks and using&quot; does not work. Changing the colour scheme to a non-high contrast scheme works as expected.</p>
<h2 data-number="3.3"><span class="header-section-number">3.3</span> Usage of Braces for Control Statements</h2>
<p><sup><em>Requirement: CREQ0031; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-14 22:29:00Z; Modified: 2019-11-01 21:30:56Z.</em></sup></p>
<p>Braces should be used for all control statements, even if that control statement has only one line.</p>
<p>Exceptions to this rule might be for single line statements that either throw an exception or return immediately.</p>
<p>No exceptions should be made on if-statements if there is an else or an else-if statement in use.</p>
<p><strong>Rationale</strong>: Often, in reviews and code changes, the lack of braces and incorrect formatting can lead to code appearing as though it is within a control block, where although in reality it is outside of the control block leading to unexpected behavior.</p>
<p>The second is the &quot;dangling else&quot; case, where it is not clear to which control statement an else statement may belong.</p>
<p><strong>Example</strong>:</p>
<pre><code>if (a)
  if (b)
    c;
else
  d;</code></pre>
<p>is not distinguishable from</p>
<pre><code>if (a)
  if (b)
    c;
  else
    d;</code></pre>
<p>Although the two examples are identical, it&#39;s not clear to which if statement the &#39;else&#39; belongs to. This should be made explicit with braces.</p>
<h2 data-number="3.4"><span class="header-section-number">3.4</span> Position of Braces for Control Statements</h2>
<p><sup><em>Requirement: CREQ0032; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:46:05Z; Modified: 2019-11-01 21:33:18Z.</em></sup></p>
<p>The opening brace &#39;{&#39; shall be on the same line as the <strong>if</strong>, <strong>else if</strong>, <strong>else</strong>, switch delegates and other constructs which occur within a method.</p>
<p>The closing brace &#39;}&#39; should begin on a new line (unless the complete statement and substatements fit completely on a single line). Following the closing brace on the same line should be chained statements, such as <strong>else</strong>, <strong>else if</strong>.</p>
<p><strong>Example</strong>:</p>
<pre><code>if (a) {
  DoSomething();
} else if {
  SecondOption();
} else {
  DoSomethingElse();
}</code></pre>
<h2 data-number="3.5"><span class="header-section-number">3.5</span> Switch and Case Statements</h2>
<p><sup><em>Requirement: CREQ0033; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:48:53Z; Modified: 2019-11-01 21:34:11Z.</em></sup></p>
<p>The case statements shall align to the left of the switch statement.</p>
<p>This helps avoid the situation that code appears heavily nested.</p>
<p><strong>Example</strong>:</p>
<pre><code>switch (value) {
case 1:
  Console.WriteLine(&quot;One&quot;);
  break;
case 2:
  Console.WriteLine(&quot;Two&quot;);
  break;
default:
  Console.WriteLine(&quot;Unknown&quot;);
  break;
}</code></pre>
<h2 data-number="3.6"><span class="header-section-number">3.6</span> Spaces for Indentation</h2>
<p><sup><em>Requirement: CREQ0034; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:49:56Z; Modified: 2017-08-12 18:26:10Z.</em></sup></p>
<p>Spaces shall be used for indentation, with 4 spaces being equivalent to 1 tab.</p>
<p><strong>Rationale</strong>: A single tab is typically 8 spaces. This makes spacing excessive. One can configure an IDE to interpret a tab as 4 spaces but is tedious and manual work. By using spaces, it can be guaranteed consistent results regardless of the IDE (or diff tool) in use.</p>
<p>Other projects might have used 2 or 3 spaces for tabs. Using 2 spaces provides insufficient indentation to identify problematic code due to heavily nested statements. 3 spaces is discarded as it&#39;s not aligned with any of the default tabbing.</p>
<h2 data-number="3.7"><span class="header-section-number">3.7</span> Commenting within the Code</h2>
<p><sup><em>Requirement: CREQ0035; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-14 22:33:55Z; Modified: 2017-08-12 18:26:13Z.</em></sup></p>
<p>Comments within the code should be avoided, instead a preference to more descriptive naming of variables and method that describes the code in the same way.</p>
<p>Similarly, MAML documentation of internal and private methods should only be provided if it brings value, with a preference instead for descriptive naming of the method and parameters of the method.</p>
<p><strong>Rationale</strong>: Providing documentation for simple methods increases workload and burden, allowing for a higher probability later of incorrect documentation should the code change (as it&#39;s often documentation is not updated when code is updated).</p>
<h1 data-number="4"><span class="header-section-number">4</span> C# Language Specific Features</h1>
<p><sup><em>Requirement: CREQ0134; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:45:56Z; Modified: 2017-02-15 21:46:05Z.</em></sup></p>
<h2 data-number="4.1"><span class="header-section-number">4.1</span> Using Statements</h2>
<p><sup><em>Requirement: CREQ0036; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:13:46Z; Modified: 2019-11-02 12:29:53Z.</em></sup></p>
<p>The <strong>using</strong> statement has an effect if different when it is inside the namespace or outside the namespace.</p>
<p>Having project references inside the namespace means that each <strong>using</strong>statement doesn&#39;t need to have the complete tree referenced. Having non-project references (e.g. the System namespace) inside the namespace implies that they take preference over the project namespaces.</p>
<p>There is a tradeoff between the desire of just being able to update the project namespace, without having to update all references of the project namespace, and having the standard namespaces as first.</p>
<p>Let&#39;s say we have the namespace <strong>MYPROJECT.Environment</strong> (there&#39;s also a <strong>System.Environment</strong>) and <strong>MYPROJECT.NewFeature</strong>.</p>
<pre><code>namespace MYPROJECT.AnotherFeature {
  using System;
  using NewFeature;

  public class NextGenFeature {
    public void DoSomething() {
      // Equivalent: MYPROJECT.NewFeature.NewFeatureClass.StaticMethod()
      NewFeatureClass.StaticMethod();

      // Equivalent: System.Environment.Exit(0)
      Environment.Exit(0);
    }
  }
}</code></pre>
<h3 data-number="4.1.1"><span class="header-section-number">4.1.1</span> Using System (and non-project references) Inside the Namespace</h3>
<p><sup><em>Requirement: CREQ0037; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:14:03Z; Modified: 2019-11-02 12:30:04Z.</em></sup></p>
<p>The <strong>using</strong>statements of the <strong>System.*</strong> namespace should occur within the namespace. They should be first and sorted in alphabetical order.</p>
<h3 data-number="4.1.2"><span class="header-section-number">4.1.2</span> Using Project References Inside the Namespace</h3>
<p><sup><em>Requirement: CREQ0038; Author: jcurl; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2015-11-09 08:14:56Z; Modified: 2022-06-29 21:40:47Z.</em></sup></p>
<p>The <strong>using</strong>statements should occur within the namespace. They should occur last, be in alphabetical order. They should not reference the namespace in which they reside.</p>
<p><strong>Rationale</strong>: Some of the software used may be exported as Open Source (see https://github.com/jcurl/serialportstream). In this case, to ensure that the namespaces are separated to avoid any possible conflicts with open source, the root namespace is changed to suit that of the project (<strong>RJCP.IO.Ports</strong> renamed to <strong>NEWPROJ.IO.Ports</strong>). The number of internal reference changes is minimal.</p>
<h3 data-number="4.1.3"><span class="header-section-number">4.1.3</span> Sort Using</h3>
<p><sup><em>Requirement: CREQ0183; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:36:28Z; Modified: 2019-11-02 12:30:30Z.</em></sup></p>
<p>There is an option in Visual Studio 2013 and later to ensure that <strong>System.*</strong> namespaces are sorted first:</p>
<ul>
<li><p>Options -&gt; Text Editor -&gt; C# -&gt; Advanced</p></li>
<li><p>Organize Usings -&gt; Place &#39;System&#39; directives first when sorting usings</p></li>
</ul>
<p><strong>Rationale</strong>: Sorting in alphabetical order helps to quickly identify the using statements.</p>
<h3 data-number="4.1.4"><span class="header-section-number">4.1.4</span> Remove Unused Using</h3>
<p><sup><em>Requirement: CREQ0184; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:37:34Z; Modified: 2019-11-01 21:38:03Z.</em></sup></p>
<p>Source files should have any <strong>using</strong>statement which is not referenced as being removed.</p>
<h3 data-number="4.1.5"><span class="header-section-number">4.1.5</span> Static Using</h3>
<p><sup><em>Requirement: CREQ0185; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-01 21:38:54Z; Modified: 2019-11-01 21:40:14Z.</em></sup></p>
<p>Do not use the feature</p>
<pre><code>using static Class;</code></pre>
<p><strong>Rationale</strong>:</p>
<p>Many code reviews are done within WebEditors, such as Gerrit, BitBucket, GitHub, etc. Excessive usage of this feature may make it difficult more to know the source of the function being called, and can lead to a loss of quality during the code review.</p>
<h2 data-number="4.2"><span class="header-section-number">4.2</span> Parameters</h2>
<p><sup><em>Requirement: CREQ0135; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:47:42Z; Modified: 2019-11-02 18:07:30Z.</em></sup></p>
<h3 data-number="4.2.1"><span class="header-section-number">4.2.1</span> Don&#39;t use Optional Parameters for Public API</h3>
<p><sup><em>Requirement: CREQ0136; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:47:50Z; Modified: 2022-06-29 21:19:48Z.</em></sup></p>
<p>Optional parameters shall not be used for public API&#39;s.</p>
<p><strong>Rationale</strong>:</p>
<ul>
<li><p>Changing a method signature using optional parameters can cause existing clients to break. That leads to breaking backwards compatibility.</p></li>
<li><p>When avoiding the backwards compatibility issue by adding a new overload, an ambiguity on determining the correct method may then result.</p></li>
</ul>
<p>For more information, see the link: http://haacked.com/archive/2010/08/10/versioning-issues-with-optional-arguments.aspx/</p>
<p>An exception to this rule would be to have similar API to what is provided in the .NET framework (e.g. streams in .NET Core 5).</p>
<h3 data-number="4.2.2"><span class="header-section-number">4.2.2</span> Named Parameters</h3>
<p><sup><em>Requirement: CREQ0149; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 14:42:08Z; Modified: 2019-11-02 18:07:56Z.</em></sup></p>
<p>Avoid named parameters in function/constructor calls</p>
<p>C# allows the use of named parameters when calling functions to improve readability. This is especially true for boolean inputs. However, there are other reasons against.</p>
<p><strong>Rationale</strong>:</p>
<ul>
<li><p>Using named parameters makes reviews in Web Browsers (such as Crucible, BitBucket, Gerrit) more difficult when trying to find the correct function being reviewed. MSDN lists each overload showing the type, not the parameter name. To find the documentation for a specific function using MSDN is easier without named parameters.</p></li>
<li><p>If a parameter name changes, but not the signature, software will no longer compile.</p></li>
</ul>
<p>An exception to this rule might be defining attributes in code for:</p>
<ul>
<li><p>Code analysis warning/message suppression</p></li>
<li><p>Test case attributes specifying the test name or other properties</p></li>
</ul>
<h3 data-number="4.2.3"><span class="header-section-number">4.2.3</span> Prefer Return Values over ref and out</h3>
<p><sup><em>Requirement: CREQ0331; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-15 20:45:47Z; Modified: 2022-06-29 21:20:40Z.</em></sup></p>
<p>Prefer the usage of returning values from a function than the usage of referenced parameters (those with the keyword <strong>ref</strong>and <strong>out</strong>).</p>
<p>The usage of <strong>out</strong>is suitable for situations where users are used to similar situations with existing frameworks, e.g.</p>
<pre><code>bool TryGetValue(string key, out object value)</code></pre>
<p><strong>Rationale</strong>: This promotes functional style programming which is easier to verify.</p>
<p><strong>Rationale</strong>: In newer versions of the language, you can return Tuples.</p>
<h2 data-number="4.3"><span class="header-section-number">4.3</span> NameOf</h2>
<p><sup><em>Requirement: CREQ0148; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 14:39:46Z; Modified: 2019-11-02 18:08:01Z.</em></sup></p>
<p>Using the <strong>nameof</strong>keyword (available in C# 5.0, VS2012 and later) avoids incorrect spelling of method and parameter names (errors thus resulting in compilation failures). IDEs also typically support refactoring of variable renaming resulting in automatic updates to the arguments of <strong>nameof</strong>, reducing effort.</p>
<p><strong>Rationale</strong>:</p>
<p>Using the <strong>nameof</strong>keyword avoid incorrect spelling of names (that would otherwise result in compilation failures), and assists with renaming of variables.</p>
<p>It can be used for exception parameter names, or in reflection for names of methods and properties (when using Invoke).</p>
<h2 data-number="4.4"><span class="header-section-number">4.4</span> Classes</h2>
<p><sup><em>Requirement: CREQ0297; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:11:31Z; Modified: 2019-11-02 15:11:34Z.</em></sup></p>
<h3 data-number="4.4.1"><span class="header-section-number">4.4.1</span> Partial Classes</h3>
<p><sup><em>Requirement: CREQ0215; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:07:47Z; Modified: 2022-06-29 21:21:40Z.</em></sup></p>
<p>The use of <strong>partial</strong>classes should generally be avoided.</p>
<p>Some instances where partial classes are useful:</p>
<ul>
<li><p>Use with code generators, where a user might provide their implementation on top, while IDE helpers keep the generated code separated (such an example is WinForms).</p></li>
<li><p>P/Invoke, where the top level class is used like a namespace (e.g. Kernel32) and it is expected to contain a lot of nested classes and structs.</p></li>
</ul>
<p>Using it in the design for normal classes shows that the class is likely too large and should be refactored into smaller components.</p>
<h3 data-number="4.4.2"><span class="header-section-number">4.4.2</span> Nested Classes</h3>
<p><sup><em>Requirement: CREQ0216; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:09:12Z; Modified: 2019-11-02 15:11:38Z.</em></sup></p>
<p>Related to <strong>partial</strong>classes, nested classes should be kept at a minimum.</p>
<p>It is considered a problem when the usage of nested classes leads to source files so large that partial classes are considered. Consider using namespaces instead.</p>
<p>One exception to this might be providing a suite of functions within a static class. The <strong>static</strong>class could be <strong>partial</strong>, while the functions themselves are considered in a single source file. However, even this case should be reconsidered if it should be instead that a single <strong>static</strong>class provides a wrapper for new <strong>internal static</strong>classes that are separated (and would therefore increase code readability).</p>
<h3 data-number="4.4.3"><span class="header-section-number">4.4.3</span> Calling the base</h3>
<p><sup><em>Requirement: CREQ0298; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:11:43Z; Modified: 2019-11-02 15:12:49Z.</em></sup></p>
<p>Do not state the default constructor of the base class explicitly</p>
<p><strong>Old</strong>:</p>
<pre><code>public class MyClass : BaseClass {
  public MyClass(string var) : base() { ... }
}</code></pre>
<p><strong>New</strong></p>
<pre><code>public class MyClass : BaseClass {
  public MyClass(string var) { ... }
}</code></pre>
<h2 data-number="4.5"><span class="header-section-number">4.5</span> Types</h2>
<p><sup><em>Requirement: CREQ0293; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:00:42Z; Modified: 2019-11-02 15:09:37Z.</em></sup></p>
<h3 data-number="4.5.1"><span class="header-section-number">4.5.1</span> Use the Native Types</h3>
<p><sup><em>Requirement: CREQ0296; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:09:42Z; Modified: 2019-11-02 15:10:52Z.</em></sup></p>
<p>Prefer the following types in C# over the System types</p>
<ul>
<li><p><strong>int</strong>over <strong>Int32</strong></p></li>
<li><p><strong>uint</strong>over <strong>UInt32</strong></p></li>
<li><p><strong>short</strong>over <strong>Int16</strong></p></li>
<li><p><strong>ushort</strong>over <strong>UInt16</strong></p></li>
<li><p><strong>byte</strong>over <strong>UInt8</strong></p></li>
<li><p><strong>sbyte</strong>of <strong>Int8</strong></p></li>
</ul>
<h3 data-number="4.5.2"><span class="header-section-number">4.5.2</span> Use TypeCasts instead of &#39;as&#39;</h3>
<p><sup><em>Requirement: CREQ0294; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:00:51Z; Modified: 2022-06-29 21:23:01Z.</em></sup></p>
<p>Where the type of an object is known at design time, type casts should be done directly.</p>
<p><strong>Example</strong>:</p>
<pre><code>IList list = new List();
List list2 = (List)list;</code></pre>
<p><strong>Rationale</strong>: Type casting directly is faster.</p>
<h3 data-number="4.5.3"><span class="header-section-number">4.5.3</span> Using the &#39;as&#39; and &#39;is&#39; operator</h3>
<p><sup><em>Requirement: CREQ0295; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:02:03Z; Modified: 2019-11-02 15:09:23Z.</em></sup></p>
<p>Use the <strong>as</strong>operator for a safe typecast, which can be used later by checking against <strong>null</strong>if the object is that type or not.</p>
<p><strong>Good (older)</strong>:</p>
<pre><code>public void (ICollection collection) {
  Queue queue = collection as Queue;
  if (queue != null) {
    ..
  }
}</code></pre>
<p><strong>Not recommended</strong>:</p>
<p>is preferred over doing a cast twice</p>
<pre><code>public void (ICollection collection) {
  if (collection is Queue) {
    Queue queue = (Queue)collection;
    ...
  }
}</code></pre>
<p>and certainly not</p>
<pre><code>public void (ICollection collection) {
  if (collection is Queue) {
    Queue queue = collection as Queue;
    ...
  }
}</code></pre>
<p>use the <strong>is</strong>operator if only types need to be compared, but are not used.</p>
<p><strong>Good (New)</strong>:</p>
<p>In newer versions of C# this should now be written as</p>
<pre><code>public void (ICollection collection) {
  if (collection is Queue queue) {
    ...
  }
}</code></pre>
<h2 data-number="4.6"><span class="header-section-number">4.6</span> Properties</h2>
<p><sup><em>Requirement: CREQ0300; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:18:39Z; Modified: 2019-11-02 15:20:02Z.</em></sup></p>
<h3 data-number="4.6.1"><span class="header-section-number">4.6.1</span> Use Auto Properties</h3>
<p><sup><em>Requirement: CREQ0302; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:20:37Z; Modified: 2019-11-02 15:21:51Z.</em></sup></p>
<p>Auto properties should be used where ever possible. These look like a field, make code smaller and compact avoiding boiler plate code.</p>
<h3 data-number="4.6.2"><span class="header-section-number">4.6.2</span> Auto Property Assignment</h3>
<p><sup><em>Requirement: CREQ0303; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:21:56Z; Modified: 2022-06-29 21:23:58Z.</em></sup></p>
<p>In Visual Studio 2017 and later, it is now possible to assign values to auto properties.</p>
<p><strong>Example</strong>:</p>
<pre><code>public int MyProperty { get; private set; } = 42;</code></pre>
<p>By assigning auto properties like this, it no longer needs to be explicitly done in the constructor. The addition of new constructors is less error prone as such properties will be set and less likley to be forgotten.</p>
<p><strong>Old</strong>:</p>
<pre><code>private int m_MyProperty = 42;
public int MyProperty {
  get { return m_MyProperty; }
  private set { m_MyProperty = value; }
}</code></pre>
<h3 data-number="4.6.3"><span class="header-section-number">4.6.3</span> Initialization of Properties that are Read Only</h3>
<p><sup><em>Requirement: CREQ0337; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2022-06-29 21:23:30Z; Modified: 2022-06-29 21:25:33Z.</em></sup></p>
<p>In newer versions of .NET do not provide a private setter if that property is only set in the constructor.</p>
<p><strong>Example</strong>:</p>
<pre><code>public int MyProperty { get; } = 42;</code></pre>
<p><strong>Rationale</strong>: This is equivalent to readonly properties, and prevents code from setting the properties when they shouldn&#39;t.</p>
<h2 data-number="4.7"><span class="header-section-number">4.7</span> Strings</h2>
<p><sup><em>Requirement: CREQ0304; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:08:22Z; Modified: 2019-11-02 18:08:23Z.</em></sup></p>
<h3 data-number="4.7.1"><span class="header-section-number">4.7.1</span> String Interpolation (Production Code)</h3>
<p><sup><em>Requirement: CREQ0305; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:08:26Z; Modified: 2022-06-29 21:26:37Z.</em></sup></p>
<p>Production code and code bases which should be maintained over a longer period of time should not use string interpolation.</p>
<p>String interpolation can be used in projects where the language is expected to remain constant, for example, unit test projects and logging.</p>
<p><strong>Rationale</strong>:</p>
<p>String interpolation does not allow extracting the strings into resources for Internationalization. As projects grow and are used by more teams across the world internationalization is important.</p>
<h1 data-number="5"><span class="header-section-number">5</span> Design Patterns</h1>
<p><sup><em>Requirement: CREQ0039; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:52:04Z; Modified: 2015-11-10 20:52:11Z.</em></sup></p>
<h2 data-number="5.1"><span class="header-section-number">5.1</span> Compatibility with .NET</h2>
<p><sup><em>Requirement: CREQ0040; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:16:13Z; Modified: 2015-11-17 08:16:17Z.</em></sup></p>
<h3 data-number="5.1.1"><span class="header-section-number">5.1.1</span> CLSCompliant</h3>
<p><sup><em>Requirement: CREQ0041; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:18:34Z; Modified: 2019-11-02 12:13:00Z.</em></sup></p>
<p>Assemblies should be marked as explicit <strong>CLSCompliant(true)</strong>, and methods should explicitly indicate that they are not <strong>CLSCompliant</strong>.</p>
<h3 data-number="5.1.2"><span class="header-section-number">5.1.2</span> Case Insensitivity</h3>
<p><sup><em>Requirement: CREQ0042; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:02:31Z; Modified: 2015-11-17 08:17:52Z.</em></sup></p>
<p>Variables, methods, fields, types and name spaces shall differ by more than just their case. This allows support for other .NET languages and higher reuse (e.g. Visual Basic .NET is case insensitive, while C# is not).</p>
<h2 data-number="5.2"><span class="header-section-number">5.2</span> Boxing and Unboxing</h2>
<p><sup><em>Requirement: CREQ0043; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:21:39Z; Modified: 2019-11-02 12:33:05Z.</em></sup></p>
<p>Boxing is the process of taking a value type, allocating memory on the heap and copying the value to the new memory so that there is now a reference to it.</p>
<p>There is the explicit instruction in IL called <strong>box</strong> that does this.</p>
<h3 data-number="5.2.1"><span class="header-section-number">5.2.1</span> Using Generics to Avoid Boxing and Unboxing</h3>
<p><sup><em>Requirement: CREQ0044; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 20:18:31Z; Modified: 2015-11-17 08:16:09Z.</em></sup></p>
<p>Datastructures should use Generics instead of the base object type, especially when value types can be used.</p>
<p>The operation of copying a value type into the reference type object is expensive, involving a copy operation when converting from the value type to the reference type.</p>
<h3 data-number="5.2.2"><span class="header-section-number">5.2.2</span> Enum.HasFlag</h3>
<p><sup><em>Requirement: CREQ0159; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2018-06-01 23:07:39Z; Modified: 2019-11-02 12:33:19Z.</em></sup></p>
<p>Avoid using the <strong>Enum.HasFlag</strong> in performance critical code. It will box twice, cause at least two memory allocations for each check. As an alternative, do bit comparisons.</p>
<pre><code>myEnum.HasFlag(MyEnum.EnumValue);</code></pre>
<p>results in boxing when converting the value type myEnum to a reference type, and then again converting MyEnum.EnumValue to a reference type:</p>
<pre><code>// else if (((Enum)(object)myEnum).HasFlag((Enum)(object)MyEnum.EnumValue))
IL_0106: ldloc.0
IL_0107: box MyEnum
IL_010c: ldc.i4.2
IL_010d: box MyEnum
IL_0112: call instance bool [mscorlib]System.Enum::HasFlag(class [mscorlib]System.Enum)
// (no C# code)
IL_0117: brfalse.s IL_0126</code></pre>
<p>As a reference, see https://stackoverflow.com/questions/7368652/what-is-it-that-makes-enum-hasflag-so-slow</p>
<h3 data-number="5.2.3"><span class="header-section-number">5.2.3</span> Argument Parameters</h3>
<p><sup><em>Requirement: CREQ0160; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2018-06-01 23:12:39Z; Modified: 2018-06-04 20:53:44Z.</em></sup></p>
<p>Be careful with methods that have a signature such as:</p>
<pre><code>Console.WriteLine(string format, params object[] arguments);</code></pre>
<p>Using it such as:</p>
<pre><code>Console.WriteLine(&quot;Values: {0} {1}&quot;, 1, 2);</code></pre>
<p>will result in boxing the integer value types to reference types. There are two things that happen here:</p>
<ol type="1">
<li><p>An array is automatically created by the compiler for arguments</p></li>
<li><p>The value types are boxed into reference types and then stored into the array</p></li>
</ol>
<p>It is not at all efficient like C, where values are pushed onto the stack, but instead type safe and cannot cause stack corruption.</p>
<h3 data-number="5.2.4"><span class="header-section-number">5.2.4</span> Tracing</h3>
<p><sup><em>Requirement: CREQ0161; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2018-06-01 23:20:24Z; Modified: 2019-11-02 12:33:55Z.</em></sup></p>
<p>A typical scenario where this occurs is tracing. Executing a trace, even if tracing is disabled, will result in a performance impact:</p>
<pre><code>int bytesRead = stream.Read(buffer, 0, buffer.Length);
TraceSource.TraceEvent(TraceEventType.Information, 0,
  &quot;{0}: Logged {1} bytes&quot;, m_Name, bytesRead);</code></pre>
<p>This will also result in a new array being created, and the value type <strong>bytesRead</strong>being boxed into the array. Even if the user doesn&#39;t enable tracing, this will still occur.</p>
<p>If a lot of tracing occurs (which typically does at verbose level) one should check to see if tracing is enabled first.</p>
<p>MSDN suggests to not use <strong>TraceSource.ShouldTrace</strong>, however no other reasonable viable alternative is found.</p>
<p>This will speed up your code in hot paths and reduce the number of allocations required on the heap.</p>
<h2 data-number="5.3"><span class="header-section-number">5.3</span> Properties</h2>
<p><sup><em>Requirement: CREQ0045; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:19:19Z; Modified: 2015-11-17 08:19:22Z.</em></sup></p>
<h3 data-number="5.3.1"><span class="header-section-number">5.3.1</span> Exceptions in Get Properties</h3>
<p><sup><em>Requirement: CREQ0046; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:29:46Z; Modified: 2019-11-02 12:34:30Z.</em></sup></p>
<p>Do not raise exceptions in the get field of a property. Instead return a default value.</p>
<p>The only exception to this are exceptions of type <strong>InvalidOperationException</strong>and derived types (e.g. also <strong>ObjectDisposedException</strong>).</p>
<h3 data-number="5.3.2"><span class="header-section-number">5.3.2</span> Property State</h3>
<p><sup><em>Requirement: CREQ0047; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:19:35Z; Modified: 2019-11-02 12:34:54Z.</em></sup></p>
<p>Properties should be allowed to be set in any order, and should be stateless with respect to other properties.</p>
<p><strong>Rationale</strong>:</p>
<p>A property looks like a variable to the programmer, and they expect it to behave like a variable. Only when a specific method is called, would the class enter a particular state that then uses these variables. Until then, the state of the properties shouldn&#39;t matter.</p>
<h3 data-number="5.3.3"><span class="header-section-number">5.3.3</span> Property Changed Events</h3>
<p><sup><em>Requirement: CREQ0048; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:22:09Z; Modified: 2019-11-02 12:35:04Z.</em></sup></p>
<p>In the case that properties change, raise an event that ends in the name <strong>Changed</strong>.</p>
<p><strong>Example</strong>:</p>
<pre><code>public event EventHandler TextChanged;</code></pre>
<h3 data-number="5.3.4"><span class="header-section-number">5.3.4</span> Boolean State Properties</h3>
<p><sup><em>Requirement: CREQ0049; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:23:17Z; Modified: 2019-11-02 12:35:34Z.</em></sup></p>
<p>Consider naming read-only properties that describe state or testing a feature by prefixing the property with <strong>Is</strong> or <strong>Has</strong>.</p>
<p>Example:</p>
<ul>
<li><p>IsConnected</p></li>
<li><p>HasFeature</p></li>
</ul>
<p>The read/write property if something is enabled or not would be <strong>Enabled</strong> and not <strong>IsEnabled</strong> as it&#39;s also writable.</p>
<h3 data-number="5.3.5"><span class="header-section-number">5.3.5</span> Read Only and Write Only Properties</h3>
<p><sup><em>Requirement: CREQ0050; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:25:25Z; Modified: 2019-11-02 12:36:02Z.</em></sup></p>
<p>Properties may be read only. When writing them, they could raise an exception indicating that it is read only. The appropriate exception is <strong>InvalidOperationException</strong>.</p>
<p>Properties should not be write-only. Replace such properties as methods.</p>
<h3 data-number="5.3.6"><span class="header-section-number">5.3.6</span> Don&#39;t Expose Public Fields</h3>
<p><sup><em>Requirement: CREQ0301; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:19:49Z; Modified: 2019-11-04 19:51:11Z.</em></sup></p>
<p>Never expose fields as public.</p>
<p>By using properties, implementations can extend to include performance optimizations (e.g. lazy initialization) and throw exceptions on invalid input. Often properties are exposed as read only, and shouldn&#39;t be set, which can&#39;t be done with fields.</p>
<p>Converting from a public field to a property is a breaking change, requiring recompilation from all dependent projects.</p>
<h2 data-number="5.4"><span class="header-section-number">5.4</span> Methods</h2>
<p><sup><em>Requirement: CREQ0051; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:27:09Z; Modified: 2015-11-17 08:27:10Z.</em></sup></p>
<h3 data-number="5.4.1"><span class="header-section-number">5.4.1</span> Overloading</h3>
<p><sup><em>Requirement: CREQ0052; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:27:11Z; Modified: 2019-11-02 12:37:37Z.</em></sup></p>
<p>Overloading is having two methods of the same name with different signatures.</p>
<p>All overloaded methods in the class should return the same type (or be <strong>void</strong>). IL does allow overloaded methods to return different types, this should be avoided for compatibility.</p>
<p>Overloaded methods should be semantically the same.</p>
<h3 data-number="5.4.2"><span class="header-section-number">5.4.2</span> Overloading instead of Default Arguments</h3>
<p><sup><em>Requirement: CREQ0053; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:29:18Z; Modified: 2015-11-17 08:30:07Z.</em></sup></p>
<p>Use overloading instead of defining default variables in the parameter list. Default arguments do not version well and therefore are not allowed in the Common Language Specification (CLS).</p>
<h3 data-number="5.4.3"><span class="header-section-number">5.4.3</span> Overloading Specific Types</h3>
<p><sup><em>Requirement: CREQ0054; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:32:58Z; Modified: 2019-11-02 12:37:57Z.</em></sup></p>
<p>When operating on different types in the methods, it makes sense to overload. The .NET runtime will always resolve the method that is the most specific type.</p>
<p><strong>Example</strong>:</p>
<pre><code>WriteLine(MyStream stream);
WriteLine(Stream stream);</code></pre>
<p>If <strong>WriteLine()</strong> is called with a type of <strong>MyStream</strong>(or derived types), it will call the first example. If called with <strong>MemoryStream</strong>(derived from <strong>Stream</strong>, but not <strong>MyStream</strong>), it will call the second instance.</p>
<p>This makes code more readable/understandable.</p>
<h3 data-number="5.4.4"><span class="header-section-number">5.4.4</span> Overloaded methods should be adjacent</h3>
<p><sup><em>Requirement: CREQ0235; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:36:26Z; Modified: 2019-11-02 12:37:00Z.</em></sup></p>
<p>When providing overloaded methods, try and keep all overloaded methods adjacent to one another. This allows for code to be found quicker.</p>
<h3 data-number="5.4.5"><span class="header-section-number">5.4.5</span> Ordering of Parameters of Overloaded Methods</h3>
<p><sup><em>Requirement: CREQ0236; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:38:05Z; Modified: 2019-11-02 12:42:26Z.</em></sup></p>
<p>When having a method with multiple overloaded implementations, design the ordering of the API to extend previous methods.</p>
<p><strong>Rationale</strong>:</p>
<p>The Visual Studio IDE presents the user with information about the API, using the smallest number of parameters that match the current line. The user can use the up/down arrow keys to search through the APIs found to suit.</p>
<p>If the following overloads are defined</p>
<pre><code>int MyMethod();
int MyMethod(string message);
int MyMethod(string format, object params args[]);</code></pre>
<p>the user can type and it will automatically show them the third method.</p>
<p>But if the overloads were to be:</p>
<pre><code>int MyMethod();
int MyMethod(string message);
int MyMethod(int count, string message);</code></pre>
<p>the user would start with a string, and they would not be prompted with the count. Changing the last method to the signature below allows the IDE to present to the user the APIs the user is most likely searching for</p>
<pre><code>int MyMethod(string message, int count);</code></pre>
<h3 data-number="5.4.6"><span class="header-section-number">5.4.6</span> Variable Number of Arguments</h3>
<p><sup><em>Requirement: CREQ0055; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:31:21Z; Modified: 2017-08-17 21:13:30Z.</em></sup></p>
<p>Choose variable arguments in the signature for methods that are expected to take an unbounded number of elements.</p>
<p><strong>Example</strong>:</p>
<pre><code>SprintF(char format, params object[] args) { ... }</code></pre>
<h2 data-number="5.5"><span class="header-section-number">5.5</span> Strings</h2>
<p><sup><em>Requirement: CREQ0162; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:21:35Z; Modified: 2019-06-20 13:21:38Z.</em></sup></p>
<h3 data-number="5.5.1"><span class="header-section-number">5.5.1</span> String Comparisons</h3>
<p><sup><em>Requirement: CREQ0163; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:21:43Z; Modified: 2019-06-20 13:22:16Z.</em></sup></p>
<p>Information for this section is derived from Microsoft&#39;s Best Practices for strings, found at https://docs.microsoft.com/en-us/dotnet/standard/base-types/best-practices-strings</p>
<h4 data-number="5.5.1.1"><span class="header-section-number">5.5.1.1</span> Default String Operations</h4>
<p><sup><em>Requirement: CREQ0172; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:30:06Z; Modified: 2019-11-02 11:37:27Z.</em></sup></p>
<p>Use overloads that explicitly specify the string comparison rules for string operations. Typically, this involves calling a method overload that has a parameter of type <strong>StringComparison</strong>.</p>
<h4 data-number="5.5.1.2"><span class="header-section-number">5.5.1.2</span> Sorting vs Equality</h4>
<p><sup><em>Requirement: CREQ0167; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:25:38Z; Modified: 2019-11-02 11:37:43Z.</em></sup></p>
<p>Use the <strong>String.Compare</strong> and <strong>String.CompareTo</strong> methods to sort strings, not to check for equality.</p>
<p>Use an overload of the <strong>String.Equals</strong> method to test whether two strings are equal.</p>
<p>Do not use an overload of the <strong>String.Compare</strong> or <strong>CompareTo</strong>method and test for a return value of zero to determine whether two strings are equal.</p>
<h4 data-number="5.5.1.3"><span class="header-section-number">5.5.1.3</span> Linquistic Irrelevant Output should use StringComparison.Ordinal[IgnoreCase]</h4>
<p><sup><em>Requirement: CREQ0165; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:23:16Z; Modified: 2019-11-02 11:38:01Z.</em></sup></p>
<p>Use the non-linguistic <strong>StringComparison.Ordinal</strong> or <strong>StringComparison.OrdinalIgnoreCase</strong> values instead of string operations based on <strong>CultureInfo.InvariantCulture</strong> when the comparison is linguistically irrelevant (symbolic, for example).</p>
<p>Use <strong>StringComparison.Ordinal</strong> or <strong>StringComparison.OrdinalIgnoreCase</strong> for comparisons as your safe default for culture-agnostic string matching.</p>
<h4 data-number="5.5.1.4"><span class="header-section-number">5.5.1.4</span> User Output should use StringComparison.CurrentCulture</h4>
<p><sup><em>Requirement: CREQ0164; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:22:19Z; Modified: 2019-11-02 11:38:04Z.</em></sup></p>
<p>Use string operations that are based on <strong>StringComparison.CurrentCulture</strong> when you display output to the user.</p>
<h4 data-number="5.5.1.5"><span class="header-section-number">5.5.1.5</span> User Output should use Culture-Sensitive formatting</h4>
<p><sup><em>Requirement: CREQ0169; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:27:46Z; Modified: 2019-06-20 13:28:03Z.</em></sup></p>
<p>Use culture-sensitive formatting to display non-string data, such as numbers and dates, in a user interface. Use formatting with the invariant culture to persist non-string data in string form.</p>
<h4 data-number="5.5.1.6"><span class="header-section-number">5.5.1.6</span> Persistent Data should use InvariantCulture</h4>
<p><sup><em>Requirement: CREQ0171; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:29:41Z; Modified: 2019-06-20 13:31:40Z.</em></sup></p>
<p>Do not use culture-sensitive formatting to persist numeric data or date and time data in string form.</p>
<p>Comparison and casing behavior in .NET changes when the culture changes. This happens when an application executes on a computer that has a different culture than the computer on which the application was developed, or when the executing thread changes its culture.</p>
<h4 data-number="5.5.1.7"><span class="header-section-number">5.5.1.7</span> Normalized Comparison should use String.ToUpperVariant</h4>
<p><sup><em>Requirement: CREQ0166; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:24:59Z; Modified: 2019-11-02 11:38:11Z.</em></sup></p>
<p>Use the <strong>String.ToUpperInvariant</strong> method instead of the <strong>String.ToLowerInvariant</strong> method when you normalize strings for comparison.</p>
<h4 data-number="5.5.1.8"><span class="header-section-number">5.5.1.8</span> Avoid StringComparison.InvariantCulture</h4>
<p><sup><em>Requirement: CREQ0170; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:28:39Z; Modified: 2019-11-02 11:38:15Z.</em></sup></p>
<p>Do not use string operations based on <strong>StringComparison.InvariantCulture</strong> in most cases. One of the few exceptions is when you are persisting linguistically meaningful but culturally agnostic data.</p>
<h4 data-number="5.5.1.9"><span class="header-section-number">5.5.1.9</span> Performance</h4>
<p><sup><em>Requirement: CREQ0168; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 13:26:40Z; Modified: 2019-11-02 11:38:20Z.</em></sup></p>
<p>Use comparisons with <strong>StringComparison.Ordinal</strong> or <strong>StringComparison.OrdinalIgnoreCase</strong> for better performance.</p>
<p>But this should only be used in according to the other functional rules given in this section.</p>
<h3 data-number="5.5.2"><span class="header-section-number">5.5.2</span> Generic Collections</h3>
<p><sup><em>Requirement: CREQ0173; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 19:13:31Z; Modified: 2019-06-20 19:13:36Z.</em></sup></p>
<h4 data-number="5.5.2.1"><span class="header-section-number">5.5.2.1</span> Overload MyCollection&lt;T&gt; Comparison methods with IEqualityComparer&lt;T&gt;</h4>
<p><sup><em>Requirement: CREQ0174; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-20 19:13:41Z; Modified: 2019-11-02 12:43:13Z.</em></sup></p>
<p>If the generic type <strong>T</strong> could possibly be a string, then it is mandatory to provide an overload of a comparison method with the parameter</p>
<pre><code>IEqualityComparer&lt;T&gt; comparer</code></pre>
<p><strong>Rationale</strong>:</p>
<p>You have a collection and it contains a method called ContainsValue.</p>
<pre><code>public class MyCollection&lt;T&gt; {
  public bool ContainsValue(T item) {
    foreach (var entry in m_Items) {
      if (m_Items.Equals(item) return true;
    }
    return false;
  }</code></pre>
<pre><code>  public bool ContainsValue(T item, IEqualityComparer&lt;T&gt; comparer) {
    foreach (var entry in m_Items) {
      if (comparer.Equals(item, entry)) return true;
    }
  }
}</code></pre>
<p>This allows the method to be called as such:</p>
<p>MyCollection&lt;string&gt; collection = new MyCollection&lt;string&gt;();</p>
<p>collection.ContainsValue(item, StringComparer.Ordinal);</p>
<p>Such an overload is mandatory when following the section on &quot;String Comparisons&quot;.</p>
<h2 data-number="5.6"><span class="header-section-number">5.6</span> Constructors</h2>
<p><sup><em>Requirement: CREQ0056; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:36:32Z; Modified: 2017-12-26 16:00:22Z.</em></sup></p>
<h3 data-number="5.6.1"><span class="header-section-number">5.6.1</span> No Blocking Behavior</h3>
<p><sup><em>Requirement: CREQ0058; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:43:14Z; Modified: 2019-12-09 07:30:28Z.</em></sup></p>
<p>The constructor of a class should do as little work as possible, generally only initializing the object. Doing more can be CPU expensive for the application.</p>
<p>Do NOT:</p>
<ul>
<li><p>perform CPU intensive operations in the constructor</p></li>
<li><p>load files in the constructor</p></li>
</ul>
<p>Do:</p>
<ul>
<li><p>Initialize variables only</p></li>
</ul>
<p><strong>Rationale</strong>:</p>
<p>Initializing a class should not block, so as to not block GUI operations or cause unexpected delays in application code. It is not possible to implement asynchronous constructors.</p>
<h4 data-number="5.6.1.1"><span class="header-section-number">5.6.1.1</span> Use the Factory Pattern</h4>
<p><sup><em>Requirement: CREQ0327; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-09 07:26:16Z; Modified: 2019-12-09 07:31:43Z.</em></sup></p>
<p>A factory can be used to create an object and then to immediately use a method of that object to perform a long running operation if required. A factory method can be easily refactored to be an asynchronous method if required, returning a <strong>Task</strong>instead.</p>
<h3 data-number="5.6.2"><span class="header-section-number">5.6.2</span> Static Only Classes</h3>
<p><sup><em>Requirement: CREQ0057; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:36:36Z; Modified: 2019-11-02 12:43:20Z.</em></sup></p>
<p>Classes should be marked as <strong>static</strong>if it only contains <strong>static</strong>methods and properties. This marks the class as non-instantiable.</p>
<p>If this is not possible, then a class should have a private default constructor defined that marks it as non-instantiable.</p>
<h3 data-number="5.6.3"><span class="header-section-number">5.6.3</span> Structs Empty Constructor</h3>
<p><sup><em>Requirement: CREQ0059; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:44:27Z; Modified: 2019-11-02 11:38:47Z.</em></sup></p>
<p>Avoid defining an empty constructor for <strong>struct</strong>s. When a <strong>struct</strong>is defined on the heap, it is initialized with default values (e.g. zero), making initialization of the <strong>struct</strong>faster.</p>
<h3 data-number="5.6.4"><span class="header-section-number">5.6.4</span> Structs Constructor for Initialisation</h3>
<p><sup><em>Requirement: CREQ0060; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:45:30Z; Modified: 2019-11-02 11:38:52Z.</em></sup></p>
<p>Having a constructor for a <strong>struct</strong>should only be a shortcut for setting the properties in the <strong>struct</strong>.</p>
<p><strong>Example</strong>:</p>
<pre><code>struct foo = new Foo(&quot;a&quot;, &quot;b&quot;);</code></pre>
<p>should be equivalent to:</p>
<pre><code>struct foo = new Foo();
foo.a = &quot;a&quot;;
foo.b = &quot;b&quot;;</code></pre>
<h3 data-number="5.6.5"><span class="header-section-number">5.6.5</span> Copying and Side Effects</h3>
<p><sup><em>Requirement: CREQ0151; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 15:56:49Z; Modified: 2017-12-26 16:00:25Z.</em></sup></p>
<p>When accepting an object as an input to a constructor, perform a deep copy.</p>
<p><strong>Rationale</strong>:</p>
<p>Making a deep copy prevents side effects if the input object were to be inadvertently changed later.</p>
<p><strong>Example</strong>:</p>
<p>A constructor takes a list of objects as an input. That list should be copied into a new list private to the new object. If not, there are now two references to the list, and modifying the original list will modify the state of the new object.</p>
<pre><code>public ctor(IEnumerable input) {
  m_List = new List(input);
}</code></pre>
<h3 data-number="5.6.6"><span class="header-section-number">5.6.6</span> Organizing Class Constructors with Default Parameters</h3>
<p><sup><em>Requirement: CREQ0299; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 15:12:55Z; Modified: 2019-11-02 18:05:02Z.</em></sup></p>
<p>When providing <em>convenience</em> constructors where parameters are not specified as they have default implementations, implement the constructor with the most parameters as the constructor with the implementation.</p>
<p>One shouldn&#39;t define parameters with default values. Instead provide overloads. The overloads for the simplest case should just call the overload for the most complex case with the default value explicitly provided.</p>
<p><strong>Example</strong>:</p>
<pre><code>public class MyClass {
  public MyClass() : this(null, -1) { }
  public MyClass(string var) : this (var, -1) { }
  public MyClass(string var, int count) {
    // implementation
  }
}</code></pre>
<p><strong>Example</strong>:</p>
<pre><code>public class MyClass {
  public MyClass() {
    Initialize(null, -1);
  }
  public MyClass(string var) {
    if (var == null) throw new ArgumentNullException(nameof(var);
    Initialize(var, -1);
  }
  public MyClass(string var, int count) {
    if (var == null) throw new ArgumentNullException(var);
    if (count &lt; 0) throw new ArgumentOutOfRangeException();
    Initialize(var, count)
  }

   private Initialize(string var, int count) { ... }
}</code></pre>
<h2 data-number="5.7"><span class="header-section-number">5.7</span> Dispose Pattern (IDispose)</h2>
<p><sup><em>Requirement: CREQ0061; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:52:18Z; Modified: 2019-11-02 12:43:51Z.</em></sup></p>
<p>Software shall take extra care in implementation of the <strong>Dispose</strong>pattern, as recommended by Microsoft.</p>
<h3 data-number="5.7.1"><span class="header-section-number">5.7.1</span> Sealed Classes</h3>
<p><sup><em>Requirement: CREQ0062; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:52:50Z; Modified: 2019-11-15 07:08:02Z.</em></sup></p>
<p>Classes that are <strong>sealed</strong>must implement <strong>Dispose</strong>without the <strong>protected</strong>method. If there are no unmanaged resources, the <strong>Dispose</strong>method does not need to call <strong>GC.SuppressFinalize(this)</strong>.</p>
<h3 data-number="5.7.2"><span class="header-section-number">5.7.2</span> Virtual Classes</h3>
<p><sup><em>Requirement: CREQ0063; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:53:10Z; Modified: 2019-11-15 07:07:57Z.</em></sup></p>
<p>Classes that are inheritable, shall implement the <strong>publicDispose</strong> method, along with the <strong>protectedDispose</strong> method.</p>
<p><strong>Example</strong>:</p>
<pre><code>public Dispose() {
  Dispose(true);
  GC.SuppressFinalize(this);
}

protected Dispose(bool disposing) {
  if (disposing) {
    // Dispose .NET methods
  }
  // Free unmanaged resources
}</code></pre>
<h3 data-number="5.7.3"><span class="header-section-number">5.7.3</span> Unmanaged Resources</h3>
<p><sup><em>Requirement: CREQ0064; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:54:48Z; Modified: 2015-11-10 21:23:57Z.</em></sup></p>
<h4 data-number="5.7.3.1"><span class="header-section-number">5.7.3.1</span> Separation of Managed and Unmanaged Resources</h4>
<p><sup><em>Requirement: CREQ0065; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:23:30Z; Modified: 2019-11-02 12:44:42Z.</em></sup></p>
<p>A class should not have both managed and unmanaged objects in the <strong>Dispose</strong>pattern. Classes should be created explicitly to handle unmanaged resources, and only unmanaged resources.</p>
<p>A class that then has managed and unmanaged resources simultaneously should be rewritten to handle only managed resources, where those managed resources might have the responsibility of handling the unmanaged resource alone.</p>
<h4 data-number="5.7.3.2"><span class="header-section-number">5.7.3.2</span> Sealed Classes</h4>
<p><sup><em>Requirement: CREQ0066; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:24:23Z; Modified: 2019-11-02 12:44:53Z.</em></sup></p>
<p>An class managing unmanaged resources should generally be <strong>sealed</strong>, so it can&#39;t be inherited from.</p>
<h4 data-number="5.7.3.3"><span class="header-section-number">5.7.3.3</span> Finalizer</h4>
<p><sup><em>Requirement: CREQ0067; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:22:12Z; Modified: 2019-11-02 12:45:13Z.</em></sup></p>
<p>A class shall only implement a finalizer when it has unmanaged resources. Otherwise, no finalizer shall be implemented to optimize the performance of the Garbage Collector.</p>
<p>Combine this with the class being <strong>sealed</strong>, the time required for Garbage Collection is minimized.</p>
<p><strong>Rationale</strong>:</p>
<p>Say that there are two classes, B2 and D2.</p>
<pre><code>class B2 : IDisposable {
  public B2() { ... }
  public void Dispose() { ... }
  protected virtual void Dispose(bool disposing) { ... }
  public ~B2() { ... }
}

class D2 : B2 {
  public D2() { ... }
  public void Dispose() { ... }
  protected virtual void Dispose(bool disposing) { ... }
  public ~D2() { ... }
}</code></pre>
<p>When the GC calls D2.Finalize (the destructor), the following methods are called:</p>
<ul>
<li><p>D2.Finalize</p></li>
<li><p>D2.Dispose(False)</p></li>
<li><p>B2.Dispose(False)</p></li>
<li><p>B2.Finalize</p></li>
<li><p>D2.Dispose(False)</p></li>
<li><p>B2.Dispose(False)</p></li>
</ul>
<p>You can see that if the D2 finalizer is called, this results in the dispose method for the inheritance tree being called twice.</p>
<h2 data-number="5.8"><span class="header-section-number">5.8</span> Using &#39;null&#39;</h2>
<p><sup><em>Requirement: CREQ0321; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-15 07:08:24Z; Modified: 2019-11-15 07:08:29Z.</em></sup></p>
<h3 data-number="5.8.1"><span class="header-section-number">5.8.1</span> Nullable Types</h3>
<p><sup><em>Requirement: CREQ0322; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-15 07:08:43Z; Modified: 2019-11-15 07:10:59Z.</em></sup></p>
<p>Avoid whereever possible the use of nullable value types, like <strong>int?</strong>.</p>
<p><strong>Rationale</strong>:</p>
<p>It has been discussed that the null value is probably the biggest programming mistake made in history. Making a value type now a reference type that can be null increases the complexity of software and adds a new failure mode.</p>
<h3 data-number="5.8.2"><span class="header-section-number">5.8.2</span> Null Inputs and Null Properties</h3>
<p><sup><em>Requirement: CREQ0323; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-15 07:11:05Z; Modified: 2019-11-15 07:16:51Z.</em></sup></p>
<p>Whereever possible, prevent inputs from being <strong>null</strong>. Prevent properties on your class from being <strong>null</strong>.</p>
<p><strong>Rationale</strong>:</p>
<p>Whenever a property can be <strong>null</strong>, it must be checked prior in user code for all instances of null. It is a common user mistake to not check for <strong>null</strong>, even if C# has introduced null coalescing operators, and the &quot;Elvis&quot; operator.</p>
<p>If a property can never be <strong>null</strong>by design, this is one less <strong>NullReferenceException</strong>that can occur. Instead, return <strong>String.Empty</strong> for strings, provide default values for other reference types where possible.</p>
<p>One design pattern in code is to receive inputs in the constructor of a class and then to set properties of the class appropriately. Don&#39;t allow those inputs to be <strong>null</strong>, and thus the properties also won&#39;t be <strong>null</strong>, and there is less code overall that has to check for <strong>null</strong>, making code simpler to read and potentially faster by removing unnecessary checks.</p>
<h2 data-number="5.9"><span class="header-section-number">5.9</span> Singletons</h2>
<p><sup><em>Requirement: CREQ0068; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:40:34Z; Modified: 2015-11-17 08:40:36Z.</em></sup></p>
<h3 data-number="5.9.1"><span class="header-section-number">5.9.1</span> Usage</h3>
<p><sup><em>Requirement: CREQ0069; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:40:46Z; Modified: 2015-11-17 08:42:51Z.</em></sup></p>
<p>Singletons should be generally avoided, or they are used sparingly.</p>
<p>A singleton generally only makes sense if that class should, by design, only be instantiated once in the entire application. Framework / reusable components generally don&#39;t need singleton classes.</p>
<p>A singleton makes sense for application specific classes, such as holding application state or configuration (as for example, the main design pattern of WPF). This saves the object having to be passed in various places in the application model layer.</p>
<h3 data-number="5.9.2"><span class="header-section-number">5.9.2</span> Implementing a Singleton</h3>
<p><sup><em>Requirement: CREQ0129; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:22:35Z; Modified: 2019-11-02 12:45:36Z.</em></sup></p>
<p>If a singleton should be required, one of the following design patterns should be used. <em>http://csharpindepth.com/Articles/General/Singleton.aspx</em></p>
<p>Be careful of the usage of keywords such as <strong>volatile</strong>, <strong>readonly</strong>as given in the specific example. There may be the possibility of implementing subtle race conditions if used incorrectly.</p>
<p>PROs of the static constructor implementation:</p>
<ol type="1">
<li><p>Less code than double-check locking =&gt; less error-prone (the shorter the code, the fewer the bugs J).</p></li>
<li><p>It is thread-safe without making use of locking mechanisms + allows CLR optimizations =&gt; from a performance perspective, it is more efficient.</p></li>
</ol>
<h2 data-number="5.10"><span class="header-section-number">5.10</span> Common Implementations</h2>
<p><sup><em>Requirement: CREQ0180; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-07-06 21:12:33Z; Modified: 2019-07-06 21:12:43Z.</em></sup></p>
<h3 data-number="5.10.1"><span class="header-section-number">5.10.1</span> Buffers and Range Checking</h3>
<p><sup><em>Requirement: CREQ0181; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-07-06 21:12:46Z; Modified: 2019-11-02 12:46:04Z.</em></sup></p>
<p>Many methods take as an input an <strong>array</strong>, an <strong>offset</strong>and a <strong>length</strong>.</p>
<p><strong>Example</strong>:</p>
<pre><code>public void CopyTo(T[] array, int offset, int length)
public int Read(byte[] buffer, int offset, int length)
public void Write(byte[] buffer, int offset, int length)</code></pre>
<p>The following checks should be standard, to be similar to .NET implementation and that user know how to handle the exceptions.</p>
<p><strong>ArgumentNullException</strong>: Returned if the array/buffer is <strong>null</strong>. The parameter name is the argument.</p>
<p><strong>ArgumentOutOfRangeException</strong>: Returned if the <strong>offset</strong>, or <strong>length</strong>, are less than zero. The parameter name is the argument.</p>
<p><strong>ArgumentException</strong>: If the <strong>offset</strong>and <strong>length</strong>would exceed the boundaries of the <strong>array</strong>. The check should be using differences, rather than summation, to avoid potential overflow issues. There is no parameter name.</p>
<p><strong>Example</strong>:</p>
<pre><code>if (buffer == null)
  throw new ArgumentNullException(nameof(buffer));
if (offset &lt; 0)
  throw new ArgumentOutOfRangeException(nameof(offset), &quot;may not be negative&quot;);
if (length &lt; 0)
  throw new ArgumentOutOfRangeException(nameof(length), &quot;may not be negative&quot;);
if (offset &gt; buffer.Length - length)
  throw new ArgumentException(&quot;The length and offset would exceed the boundaries of the array/buffer&quot;);</code></pre>
<h2 data-number="5.11"><span class="header-section-number">5.11</span> Critical Sections</h2>
<p><sup><em>Requirement: CREQ0130; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:23:40Z; Modified: 2017-02-15 21:23:52Z.</em></sup></p>
<h3 data-number="5.11.1"><span class="header-section-number">5.11.1</span> Use Locks instead of Monitor</h3>
<p><sup><em>Requirement: CREQ0131; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:23:54Z; Modified: 2019-11-02 12:46:21Z.</em></sup></p>
<p>Where possible, the C# construct <strong>lock(object) { }</strong> should be used instead of the explicit implementation <strong>Monitor.Enter</strong> and <strong>Monitor.Exit</strong>.</p>
<p><strong>Rationale</strong>:</p>
<p>The compiler knows the precise scope of the <strong>lock</strong>and ensures that the <strong>lock</strong>is always freed properly. The <strong>lock</strong>construct also ensures that a critical section&#39;s scope remains completely within a single function.</p>
<h3 data-number="5.11.2"><span class="header-section-number">5.11.2</span> Define an Object for a Lock</h3>
<p><sup><em>Requirement: CREQ0132; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:25:59Z; Modified: 2019-11-02 12:46:58Z.</em></sup></p>
<p>Generally, locks should be made on dedicated <strong>lock object</strong>s instead of data types.</p>
<p><strong>Rationale</strong>:</p>
<ul>
<li><p>A <strong>lock object</strong> can be named to make clear the condition it protects. Generally a <strong>lock</strong>is named after a verb on an <strong>object</strong>, e.g. <strong>m_ReadLock</strong> on the object <strong>m_Socket</strong>.</p></li>
<li><p>If an <strong>object</strong>is ever exposed outside of the class, a client application may use that <strong>object</strong>as a <strong>lock</strong>handle. If we have our own <strong>lock</strong>object, there can be no additional side effects.</p></li>
</ul>
<h3 data-number="5.11.3"><span class="header-section-number">5.11.3</span> Locks shall be readonly</h3>
<p><sup><em>Requirement: CREQ0133; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-02-15 21:30:20Z; Modified: 2019-11-02 12:47:48Z.</em></sup></p>
<p>A <strong>lock</strong>object should be marked as <strong>readonly</strong>and initialized as an object in the constructor.</p>
<p>This prevents a <strong>lock object</strong>from being reassigned, ensuring that the <strong>lock object</strong> remains constant throughout the lifetime of a class.</p>
<p><strong>Rationale</strong>:</p>
<p>Often a collection <strong>object</strong>is also its own <strong>lock</strong>to synchronize modification to it. If in an add/remove operation we <strong>lock</strong>the collection, but in a <strong>Reset</strong>method we were to simply create a new instance, current locks are invalid and may lead to obscure race conditions.</p>
<p>By making a dedicated <strong>lock object</strong>, we avoid this problem (CREQ0132), but if the collection were marked <strong>readonly</strong>, the compiler would complain if the collection object were to be reassigned.</p>
<p>If for legacy reasons it&#39;s not easy to create a new lock, simply assigning objects as <strong>readonly</strong>which are used as locks may help to identify unidentified bugs.</p>
<h2 data-number="5.12"><span class="header-section-number">5.12</span> Tasks and Parallel Programming</h2>
<p><sup><em>Requirement: CREQ0330; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-15 20:44:02Z; Modified: 2019-12-15 20:49:37Z.</em></sup></p>
<h3 data-number="5.12.1"><span class="header-section-number">5.12.1</span> Prefer async/await over BeginXXX and EndXXX</h3>
<p><sup><em>Requirement: CREQ0333; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-15 20:50:22Z; Modified: 2019-12-15 20:51:43Z.</em></sup></p>
<p>The usage of <strong>Task</strong>and the <strong>async</strong>and <strong>await</strong>keywords is much more readable than the usage of <strong>BeginXXX</strong>and <strong>EndXXX</strong></p>
<p>Libraries targeted for .NET 4.0 and earlier cannot use the <strong>async</strong>and <strong>await</strong>keywords (only formally introduced and working in .NET 4.5).</p>
<h3 data-number="5.12.2"><span class="header-section-number">5.12.2</span> Never Use Referenced Parameters for output</h3>
<p><sup><em>Requirement: CREQ0332; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-15 20:47:40Z; Modified: 2019-12-20 14:42:14Z.</em></sup></p>
<p>Avoid the usage of referenced parameters (usage of the <strong>ref</strong>or <strong>out</strong>keyword) for operations that do not complete immediately.</p>
<p><strong>Rationale</strong>:</p>
<p>These operations cannot be easily rewritten in an asynchronous programming model using either <strong>BeginXXX</strong>/<strong>EndXXX</strong> or <strong>Task</strong>. Even when doing so requires an implementation where the asynchronous methods look and behave differently to the synchronous methods.</p>
<h3 data-number="5.12.3"><span class="header-section-number">5.12.3</span> Tuples</h3>
<p><sup><em>Requirement: CREQ0334; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-12-20 14:42:17Z; Modified: 2019-12-20 14:46:09Z.</em></sup></p>
<p>Consider using <strong>Tuples</strong>in C# 7.1 when using the <strong>async</strong>programming model instead of <strong>ref</strong>or <strong>out</strong>.</p>
<p><strong>Rationale</strong>:</p>
<p>Often when functions return results as a reference parameter (with the out keyword), it is because the result of the function call might return the success of the operation (to avoid unnecessarily raising exceptions).</p>
<p>Rewriting the method to return Tuples instead can keep code compact and readable and avoid having to create &quot;mini&quot; structs or classes just to contain a small number of return values.</p>
<p><strong>Example</strong>:</p>
<p>The following method attempts to get the branch name, with the result code indicating if the call was successful, and if so, then the name of the branch.</p>
<pre><code>bool GetBranch(string path, out string branch);</code></pre>
<p>This could be rewritten as:</p>
<pre><code>Task&lt;(bool success, string branch)&gt; GetBranchAsync(string path);</code></pre>
<h2 data-number="5.13"><span class="header-section-number">5.13</span> Synchronization</h2>
<p><sup><em>Requirement: CREQ0313; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-04 19:55:56Z; Modified: 2019-11-04 19:56:02Z.</em></sup></p>
<h3 data-number="5.13.1"><span class="header-section-number">5.13.1</span> Thread.Resume and Thread.Suspend</h3>
<p><sup><em>Requirement: CREQ0314; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-04 19:56:04Z; Modified: 2019-11-04 19:58:53Z.</em></sup></p>
<p>Do not use <strong>Thread.Suspend</strong> or <strong>Thread.Resume</strong> to manage your threads. Synchronize threads using <strong>WaitHandle</strong>objects and loops.</p>
<p><strong>Rationale</strong>:</p>
<p>Using <strong>Thread.Suspend</strong> and <strong>Thread.Resume</strong> doesn&#39;t allow any control when a thread is suspended or resumed. It could do so in the middle of a lock, including a lock that is system wide in the framework or in the Operating System. Suspending may occur and block all other threads unexpectedly, including unmanaged locks.</p>
<p>Also, when a thread is suspended, a call to <strong>Thread.Abort</strong> may raise an exception in .NET for WIndows, or can be simply ignored under Mono. The behavior in this case is not well defined.</p>
<h3 data-number="5.13.2"><span class="header-section-number">5.13.2</span> Thread.Sleep</h3>
<p><sup><em>Requirement: CREQ0315; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-04 19:59:00Z; Modified: 2019-11-04 20:08:49Z.</em></sup></p>
<p>Do not use <strong>Thread.Sleep</strong> for synchronizing different portions of code. All code must be properly synchronized using synchronization mechanisms provided in the run-time.</p>
<p>Often, an object might need to sleep for some period of time as it waits for external events. Use <strong>WaitHandle.Wait()</strong> methods with timeouts, especially on <strong>ManualResetEvent</strong>objects. Quite often, your class may be requested to dispose during a sleep operation, which when using <strong>WaitHandle.Wait()</strong> can be easily interrupted.</p>
<p>Using <strong>Thread.Sleep</strong> often leads to test case failures as timeouts occur, or the system is sporadically overloaded. Software should be able to function properly even if under heavy load, something that the <strong>Thread.Sleep</strong> doesn&#39;t allow.</p>
<p><strong>Thread.Sleep</strong> never guarantees how long it will sleep, only that the thread is slept for at least the timeout specified, but it can be significantly longer.</p>
<p><strong>Example</strong>:</p>
<p>In this fictitious (and incomplete) example, code might be sleeping, until it performs the next operation. If however it is sleeping in a long operation and it is told to <strong>Dispose()</strong>, it can abort the sleep and clean up, setting the object <strong>m_Closed</strong> when done. Thus everything is properly synchronized and no sleep operation is performed.</p>
<pre><code>ManualResetEvent m_Close = new ManualResetEvent(false);

...
private bool Sleep(int timeout) {
  // Sleep and wait for an answer, unless aborted
  return m_Close.Wait(timeout);
}

protected virtual void Dispose(bool disposing) {
  if (!disposing) return;
  m_Close.Set();
  m_Closed.Wait(-1);
}</code></pre>
<h3 data-number="5.13.3"><span class="header-section-number">5.13.3</span> Do Not Synchronize on Operating System Real-Time Clock</h3>
<p><sup><em>Requirement: CREQ0316; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-04 20:08:56Z; Modified: 2019-11-04 20:11:18Z.</em></sup></p>
<p>Never base sleep periods based on the Operating System Clock. Always use Operating System primitives that are based on the internal monotonic clock that is not at all related to the CMOS real-time clock.</p>
<p><strong>Rationale</strong>:</p>
<p>The real-time clock is never guaranteed to be monotonic (e.g. Daylight savings can cause the clock to roll back), and never guaranteed to be a measure of real time of when your process is running. There are many situations that can distort the clock such as:</p>
<ul>
<li><p>Time synchronization services, such as Windows Time, or NTP</p></li>
<li><p>Daylight Savings changes</p></li>
<li><p>System Suspend and Resume</p></li>
</ul>
<h2 data-number="5.14"><span class="header-section-number">5.14</span> Safe Handles</h2>
<p><sup><em>Requirement: CREQ0070; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:00:12Z; Modified: 2017-12-26 15:50:46Z.</em></sup></p>
<h3 data-number="5.14.1"><span class="header-section-number">5.14.1</span> Unmanaged Handles</h3>
<p><sup><em>Requirement: CREQ0071; Author: jcurl; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:56:22Z; Modified: 2019-12-15 20:43:05Z.</em></sup></p>
<p>Unmanaged handles should be abstracted using a new class deriving from the <strong>SafeHandle</strong>object.</p>
<p><strong>Rationale</strong>:</p>
<p><strong>SafeHandle</strong>s correctly implement reference counting, especially when using P/Invoke so that in case of unexpected errors (stack overflow, memory exceptions, thread abortion, etc.) the reference counter is still properly decremented avoiding memory leaks.</p>
<h3 data-number="5.14.2"><span class="header-section-number">5.14.2</span> DangerousGetHandle</h3>
<p><sup><em>Requirement: CREQ0150; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2017-12-26 15:52:17Z; Modified: 2019-11-02 12:48:14Z.</em></sup></p>
<p>Do not use <strong>DangerousGetHandle</strong>.</p>
<p><strong>Rationale</strong>:</p>
<p>A <strong>SafeHandle</strong>(and objects derived thereof) properly implement reference counting. By passing a handle retrieved using <strong>DangerousGetHandle</strong>, there is no guarantee that the <strong>SafeHandle</strong>is disposed/closed of while it is still in use due to lack of reference counting.</p>
<p>To use <strong>DangerousGetHandle</strong>, you must use Constrained Execution Regions (CERs) properly and manually implement the reference counting with the <strong>SafeHandle</strong>.</p>
<h2 data-number="5.15"><span class="header-section-number">5.15</span> Exceptions</h2>
<p><sup><em>Requirement: CREQ0072; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:57:14Z; Modified: 2015-11-10 20:57:16Z.</em></sup></p>
<h3 data-number="5.15.1"><span class="header-section-number">5.15.1</span> Naming</h3>
<p><sup><em>Requirement: CREQ0073; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:57:19Z; Modified: 2017-12-26 14:52:34Z.</em></sup></p>
<p>Exceptions should end with the noun Exception.</p>
<p><strong>Example</strong>:</p>
<pre><code>MyErrorException</code></pre>
<h3 data-number="5.15.2"><span class="header-section-number">5.15.2</span> Implementation</h3>
<p><sup><em>Requirement: CREQ0074; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:58:02Z; Modified: 2019-11-02 12:48:21Z.</em></sup></p>
<p>Exceptions shall be public and inherit from the <strong>System.Exception</strong>object.</p>
<h3 data-number="5.15.3"><span class="header-section-number">5.15.3</span> Serializable</h3>
<p><sup><em>Requirement: CREQ0075; Author: jcurl; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2015-11-10 20:59:30Z; Modified: 2019-11-02 15:33:00Z.</em></sup></p>
<p>Make exceptions serializable. An exception must be serializable to work correctly across application domain and remoting boundaries.</p>
<h3 data-number="5.15.4"><span class="header-section-number">5.15.4</span> Program Execution Flow</h3>
<p><sup><em>Requirement: CREQ0076; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:45:01Z; Modified: 2019-11-02 12:48:33Z.</em></sup></p>
<p>Exceptions should not be used to change the flow of a program as part of ordinary execution. Exceptions should only be used to report and handle error conditions.</p>
<p><strong>Rationale</strong>:</p>
<p>A common debugging technique is for applications to attach to the <strong>Domain.FirstChanceException</strong> handler. They might log exceptions in a local buffer, or write to a log file as required for later analysis as part of debugging.</p>
<p>Raising unnecessary exceptions requires the application programmer to build in special checks to reduce log size.</p>
<p>Raising unnecessary exceptions has therefore a real performance impact. Exceptions should not be raised, especially if it might be used within a loop. These performance impacts are often observed also when running in the Visual Studio IDE debugger, as exceptions are also caught and logged, resulting in non-release code being not debuggable due to performance reasons.</p>
<h3 data-number="5.15.5"><span class="header-section-number">5.15.5</span> Returning Exceptions</h3>
<p><sup><em>Requirement: CREQ0077; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:45:34Z; Modified: 2015-11-10 21:45:52Z.</em></sup></p>
<p>Exceptions should not be returned as a return value or parameter instead of being thrown.</p>
<h3 data-number="5.15.6"><span class="header-section-number">5.15.6</span> System Exceptions</h3>
<p><sup><em>Requirement: CREQ0078; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:46:05Z; Modified: 2022-06-29 21:28:24Z.</em></sup></p>
<p>Do not throw <strong>System.Exception</strong>, <strong>System.SystemException</strong>, <strong>System.NullReferenceException</strong>, <strong>System.OutOfMemoryException</strong> or <strong>System.IndexOutOfRangeException</strong> intentionally from your own source code.</p>
<h3 data-number="5.15.7"><span class="header-section-number">5.15.7</span> Debug and Release Mode</h3>
<p><sup><em>Requirement: CREQ0079; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:46:21Z; Modified: 2015-11-10 21:46:28Z.</em></sup></p>
<p>Do not create exceptions that can be thrown in debug mode but not release mode. To identify run-time errors during the development phase, use Debug Assert instead.</p>
<h3 data-number="5.15.8"><span class="header-section-number">5.15.8</span> Deriving Exceptions</h3>
<p><sup><em>Requirement: CREQ0080; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:47:46Z; Modified: 2019-11-02 12:48:59Z.</em></sup></p>
<p>Derive exceptions from <strong>System.Exception</strong> or one of the other common base exceptions.</p>
<h3 data-number="5.15.9"><span class="header-section-number">5.15.9</span> Extra Information</h3>
<p><sup><em>Requirement: CREQ0081; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:48:38Z; Modified: 2015-11-10 21:48:44Z.</em></sup></p>
<p>Consider providing exception properties for programmatic access to extra information (besides the message string) relevant to the exception.</p>
<h2 data-number="5.16"><span class="header-section-number">5.16</span> Events</h2>
<p><sup><em>Requirement: CREQ0082; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:31:16Z; Modified: 2015-11-10 21:31:19Z.</em></sup></p>
<h3 data-number="5.16.1"><span class="header-section-number">5.16.1</span> Implementing IDispose</h3>
<p><sup><em>Requirement: CREQ0083; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:31:21Z; Modified: 2019-11-02 12:49:06Z.</em></sup></p>
<p>If your object is long lived, but the subscriber of the event is short lived, implement the <strong>IDispose</strong>interface on the subscriber object, so that removal of the event is controlled.</p>
<p>This is a very subtle memory leak in the .NET framework that has memory impact (the objects cannot be freed due to a strong reference from the no longer referenced short lived subscriber object to the long lived referenced object).</p>
<p>There is also a potential performance impact, that the no longer referenced subscriber will still have its event called, even though it&#39;s no longer required.</p>
<h3 data-number="5.16.2"><span class="header-section-number">5.16.2</span> EventArgs</h3>
<p><sup><em>Requirement: CREQ0084; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:36:26Z; Modified: 2019-11-02 12:49:14Z.</em></sup></p>
<p>Event Argument objects should derive from <strong>System.EventArgs</strong> and end with <strong>EventArgs</strong>in the name.</p>
<h3 data-number="5.16.3"><span class="header-section-number">5.16.3</span> Generic EventHandler&lt;T&gt;</h3>
<p><sup><em>Requirement: CREQ0085; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:37:59Z; Modified: 2019-11-02 12:49:30Z.</em></sup></p>
<p>The definition of events should use the Generic <strong>EventHandler&lt;EventArgs&gt;</strong> form.</p>
<pre><code>public event EventHandler&lt;MyEventArgs&gt; MyEvent;</code></pre>
<p><strong>Rationale</strong>:</p>
<p>See MSDN CA1003. Before .NET Framework 2.0, in order to pass custom information to the event handler, a new delegate had to be declared that specified a class that was derived from the <strong>System.EventArgs</strong> class. This is no longer true in .NET Framework 2.0, which introduced the <strong>System.EventHandler&lt;TEventArgs&gt;</strong> delegate. This generic delegate allows any class that is derived from <strong>EventArgs</strong>to be used together with the event handler.</p>
<h3 data-number="5.16.4"><span class="header-section-number">5.16.4</span> Non-Generic EventHandler</h3>
<p><sup><em>Requirement: CREQ0086; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:19:16Z; Modified: 2019-11-02 12:49:38Z.</em></sup></p>
<p>It&#39;s recommended to use the generic version in preference of the non-generic derived event handler. None-the-less, if a non-generic event handler is used, it shall end in the noun <strong>EventHandler</strong>.</p>
<p>See Rule MSDN CA1003, which suggests not to use this.</p>
<p><strong>Example</strong>:</p>
<ul>
<li><p>MyEventHandler</p></li>
</ul>
<h3 data-number="5.16.5"><span class="header-section-number">5.16.5</span> Event Naming</h3>
<p><sup><em>Requirement: CREQ0087; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:39:14Z; Modified: 2019-11-02 12:49:44Z.</em></sup></p>
<p>Events in assemblies should generally be a verb and end with <strong>Event</strong>in the name.</p>
<p>A general exception to this rule are Windows Forms controls.</p>
<h3 data-number="5.16.6"><span class="header-section-number">5.16.6</span> OnEvent Protected Method</h3>
<p><sup><em>Requirement: CREQ0088; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:41:00Z; Modified: 2019-11-02 12:50:15Z.</em></sup></p>
<p>For objects that implement events that can be inherited, they should also implement a <strong>bprotected virtual</strong> method for calling the <strong>event</strong>as in the example.</p>
<p><strong>Example</strong>:</p>
<pre><code>public event EventHandler&lt;MyEventArgs&gt; MyEvent;

protected virtual void OnMyEvent(object sender, MyEventArgs args) {
  EventHandler&lt;MyEventArgs&gt; handler = MyEvent;
  if (handler != null) {
    handler(sender, args);
  }
}</code></pre>
<p><strong>Rationale</strong>:</p>
<p>Overriding a <strong>class</strong>and an <strong>OnXXEvent</strong></p>
<p><strong>virtual</strong>method is significantly faster than subscribing to the appropriate <strong>event</strong>.</p>
<p><strong>Note</strong>:</p>
<p>The assignment of the <strong>event</strong>, followed by the check to <strong>null</strong>is to avoid a race condition should the event handler be modified between the check if the event is defined and the invocation of that event.</p>
<h4 data-number="5.16.6.1"><span class="header-section-number">5.16.6.1</span> Null-Conditional Operator</h4>
<p><sup><em>Requirement: CREQ0142; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:43:19Z; Modified: 2019-11-02 11:53:13Z.</em></sup></p>
<p>Usage of the null-conditional operator should be consistent with the project in use. That is, the alternative form should be used when it is consistent with the existing project.</p>
<p><strong>Example</strong>:</p>
<p>Using the null-conditional:</p>
<pre><code>protected virtual void OnMyEvent(object sender, MyEventArgs args) {
  MyEvent?.Invoke(sender, args);
}</code></pre>
<p>Using the C# 4.0 notation</p>
<pre><code>protected virtual void OnMyEvent(object sender, MyEventArgs args) {
  EventHandler&lt;MyEventArgs&gt; handler = MyEvent;
  if (handler != null) {
    handler(sender, args);
  }
}</code></pre>
<p>Preference is for the C# 4.0 notation as it is more explicit.</p>
<h4 data-number="5.16.6.2"><span class="header-section-number">5.16.6.2</span> Sender in Protected OnEvent Method Signature</h4>
<p><sup><em>Requirement: CREQ0143; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:43:52Z; Modified: 2019-11-02 12:51:27Z.</em></sup></p>
<p>Your protected methods should generally have the sender in the signature.</p>
<p><strong>Example</strong>:</p>
<pre><code>protected virtual void OnMyEvent(object sender, MyEventArgs args) {
  EventHander&lt;MyEventArgs&gt; handler = MyEvent;
  if (handler != null) handler(sender, args);
}</code></pre>
<p><strong>Rationale</strong>:</p>
<p>Much example code has functionality such as:</p>
<pre><code>protected virtual void OnMyEvent(MyEventArgs args) {
  EventHander&lt;MyEventArgs&gt; handler = MyEvent;
  if (handler != null) handler(sender, args);
}</code></pre>
<p>This has disadvantages for chaining events from other classes (a chaining function needs to be written to explicitly catch an event and to raise the protected method), where if the protected method already contains the signature for a typical event handler it can serve two purposes.</p>
<p>A second example is that often it might be useful to propagate the sender of the actual event when chaining to the user, rather than the final object of the event chain, especially if the original event is also public.</p>
<h4 data-number="5.16.6.3"><span class="header-section-number">5.16.6.3</span> Exception in Signature to OnXXXEvent Protected Method</h4>
<p><sup><em>Requirement: CREQ0158; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2017-12-26 17:31:45Z; Modified: 2019-11-02 11:52:34Z.</em></sup></p>
<p>Protected override methods should have the <strong>EventArgs</strong>in the signature. Exceptions are allowed if they&#39;re used in standard practice.</p>
<p><strong>Rationale</strong>:</p>
<p>Some framework instances have different practices. Coding standards should avoid confusion and present a consistent way of doing things, and if a framework has established a different mechanism, that should be used instead.</p>
<p><strong>Example</strong>:</p>
<p>The <strong>INotifyPropertyChanged</strong>interface defining the <strong>PropertyChanged</strong>event usually has the associated protected method defined within the implementing classes:</p>
<pre><code>protected virtual void OnPropertyChanged(string propertyName) {
  
}</code></pre>
<p>and should be used instead of:</p>
<pre><code>protected virtual void OnPropertyChanged(PropertyChangedEventArgs e) {
  
}</code></pre>
<h3 data-number="5.16.7"><span class="header-section-number">5.16.7</span> Pre-Events and Post-Events</h3>
<p><sup><em>Requirement: CREQ0089; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:21:22Z; Modified: 2017-08-12 18:27:41Z.</em></sup></p>
<p>Name the events when closing based on the &quot;gerund&quot; form for the pre-event (words usually ending in -ing).</p>
<p><strong>Example</strong>:</p>
<ul>
<li><p>Closing (pre-event) and Closed (post-event).</p></li>
</ul>
<h2 data-number="5.17"><span class="header-section-number">5.17</span> Streams</h2>
<p><sup><em>Requirement: CREQ0090; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:49:34Z; Modified: 2015-11-10 21:49:36Z.</em></sup></p>
<h3 data-number="5.17.1"><span class="header-section-number">5.17.1</span> Naming</h3>
<p><sup><em>Requirement: CREQ0091; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:49:38Z; Modified: 2019-11-02 12:52:08Z.</em></sup></p>
<p>Stream types shall end with the noun <strong>Stream</strong>.</p>
<h3 data-number="5.17.2"><span class="header-section-number">5.17.2</span> Simultaneous Reading and Writing</h3>
<p><sup><em>Requirement: CREQ0092; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 21:50:19Z; Modified: 2019-11-02 11:52:11Z.</em></sup></p>
<p>The .NET implementation of a stream doesn&#39;t support simultaneous reading and writing from a stream. If this is required, explicit implementation of <strong>BeginRead</strong>and <strong>EndRead</strong>are required.</p>
<p>If your stream is full duplex, that is, reading and writing are expected to work in parallel and are independent of each other, deadlocks may occur when using the default implementation. These deadlocks are by design in Microsoft&#39;s implementation</p>
<p>For more information, see: http://www.codeproject.com/Tips/575618/Avoiding-Deadlocks-with-System-IO-Stream-BeginRead</p>
<h2 data-number="5.18"><span class="header-section-number">5.18</span> Attributes</h2>
<p><sup><em>Requirement: CREQ0093; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-16 21:16:08Z; Modified: 2019-11-02 12:52:28Z.</em></sup></p>
<p>Attribute classes deriving from <strong>System.Attribute</strong> must always end with <strong>Attribute</strong>.</p>
<p><strong>Example</strong>:</p>
<pre><code>public class TestAttribute : System.Attribute { }</code></pre>
<h2 data-number="5.19"><span class="header-section-number">5.19</span> Abstract Classes</h2>
<p><sup><em>Requirement: CREQ0138; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:19:48Z; Modified: 2017-08-12 18:19:53Z.</em></sup></p>
<h3 data-number="5.19.1"><span class="header-section-number">5.19.1</span> Object Oriented Design</h3>
<p><sup><em>Requirement: CREQ0139; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:20:26Z; Modified: 2019-11-02 12:52:59Z.</em></sup></p>
<p>An <strong>abstract class</strong>should be used when it is expected that the class always be derived from (i.e. it is always a base class). An<strong>abstract class</strong> isn&#39;t required to have <strong>abstract</strong>methods or properties.</p>
<p><strong>Rationale</strong>:</p>
<p>Having a <strong>public class</strong> with <strong>protected</strong>constructors may appear to satisfy similar requirements, but a derived class can still instantiate a <strong>public class</strong> with a <strong>protected</strong>constructor in its own constructor, thus probably violating the intended design requirement that the base class must be derived from as in the following example:</p>
<pre><code>public void Base {
  protected Base() {
    // ...
  }
}

public void Derived : Base {
  public Derived() {
    // Here we instantiate the base, not allowed if the base
    // would be abstract
    var b = new base();
  }
}</code></pre>
<h3 data-number="5.19.2"><span class="header-section-number">5.19.2</span> Abstract Class Constructors</h3>
<p><sup><em>Requirement: CREQ0140; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:21:30Z; Modified: 2019-11-02 12:53:07Z.</em></sup></p>
<p>An <strong>abstract class</strong> should only have constructors that are <strong>protected</strong>.</p>
<p>See CA1012: Abstract types should not have constructors.</p>
<p><strong>Rationale</strong>:</p>
<p>Constructors on abstract types can be called only by derived types. Because public constructors create instances of a type, and you cannot create instances of an abstract type, an abstract type that has a public constructor is incorrectly designed.</p>
<h3 data-number="5.19.3"><span class="header-section-number">5.19.3</span> Abstract vs. Interfaces</h3>
<p><sup><em>Requirement: CREQ0141; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:30:12Z; Modified: 2019-11-02 12:53:55Z.</em></sup></p>
<p>Interfaces shall be used in preference to <strong>abstract classes</strong> when the implementation is unimportant. Almost all cases should interfaces be used for public APIs. An interface is a totally abstract set of members that can be thought of as defining a contract for conduct. The implementation of an interface is left completely to the developer.</p>
<p>Classes can inherit from multiple interfaces.</p>
<p>Abstract classes define a partial or a full implementation, thereby encapsulating common functionality for inherited classes. It is only possible for a class to inherit from a single base class.</p>
<p>To decide which should be used:</p>
<ul>
<li><p>If the functionality you are creating will be useful across a wide range of disparate objects, use an <strong>interface</strong>. Abstract classes should be used primarily for objects that are closely related, whereas interfaces are best suited for providing a common contract to unrelated classes.</p></li>
<li><p>If you are designing small, concise bits of functionality, use <strong>interface</strong>s. If you are designing large functional units, use an <strong>abstract class</strong>.</p></li>
<li><p>If you want to provide common, implemented functionality among all implementations of your component, use an<strong>abstract class</strong>. Abstract classes allow you to partially implement your class, whereas interfaces contain no implementation for any members.</p></li>
</ul>
<h2 data-number="5.20"><span class="header-section-number">5.20</span> Single Responsibility Principle</h2>
<p><sup><em>Requirement: CREQ0156; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 16:22:26Z; Modified: 2019-11-02 12:54:00Z.</em></sup></p>
<p>Classes should be designed to perform one task.</p>
<p><strong>Example</strong>:</p>
<p>See also the Dispose pattern, separating managed and unmanaged behavior.</p>
<p><strong>Rationale</strong>:</p>
<p>The Single Responsibility Principle increases testability, maintainability and readability of code.</p>
<h3 data-number="5.20.1"><span class="header-section-number">5.20.1</span> Responsibility and Policy</h3>
<p><sup><em>Requirement: CREQ0157; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 16:25:24Z; Modified: 2017-12-26 16:32:28Z.</em></sup></p>
<p>Policy should be the responsibility of the upper layers of a design. Lower layers should implement functionality.</p>
<p><strong>Example</strong>:</p>
<p>Maintaining a configuration file should have multiple classes:</p>
<ul>
<li><p>Reading the file, if it fails it should indicate a failure. Defaults should not be returned as this could be considered policy</p></li>
<li><p>The class for maintaining the configuration should be different to how it is serialized, or deserialized to/from disk.</p></li>
<li><p>Creating a default configuration. The application can decide to create defaults in case of an error, but also notify the user.</p></li>
<li><p>A configuration can be broken down into smaller classes as required for separate functionality</p></li>
</ul>
<h2 data-number="5.21"><span class="header-section-number">5.21</span> The Model</h2>
<p><sup><em>Requirement: CREQ0094; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:21:28Z; Modified: 2015-11-30 21:29:40Z.</em></sup></p>
<p>All software designs, from small to large should consider an architecture model that is suitable for the application being developed.</p>
<p>A small application should have a minimal model, typically the presentation layer separating from logic that manages the data.</p>
<p>GUI applications should consider the Model-View-Presenter (Windows Forms) or Model-View-View-Model (Windows Presentation Foundation). Whether an application uses a supporting framework, such as the Entity framework is a matter of expected scope and side of the application. If a model is too complicated for the application, more work is spent in building the infrastructure than implementing the relatively small feature scope. Too simple a model, and the more complicated it is to maintain that application among larger teams.</p>
<h3 data-number="5.21.1"><span class="header-section-number">5.21.1</span> Small and Simple Applications - The Model folder</h3>
<p><sup><em>Requirement: CREQ0095; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:29:42Z; Modified: 2019-11-02 12:54:31Z.</em></sup></p>
<p>Small applications, even Console applications should separate the presentation layer (console output, or Windows forms code) against the logic that makes decisions.</p>
<p>The logic that defines the behavior of the application should be in the <strong>Model</strong> folder.</p>
<p><strong>Rationale</strong>:</p>
<p>As an example, consider the Windows Forms application that is relatively small to simply parse a file and then to output into a different file. If the parsing is implemented using a model approach with a well thought out design at the beginning, converting the Windows application to also support a console mode is simple - a set sequence of commands are executed in a small function to read the file, parse the file, then save the converted file. If done correctly, the effort is very small.</p>
<p><strong>Rationale</strong>:</p>
<p>Unit Testing support is increased significantly by separating the GUI from the model. By having logic in the model, it is much easier to target unit tests and ensure that the system behaves as expected. The presentation layer is smaller and only needs to deal with logic related to the GUI or the presentation to the user.</p>
<h2 data-number="5.22"><span class="header-section-number">5.22</span> Object Oriented Design</h2>
<p><sup><em>Requirement: CREQ0324; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-15 07:17:50Z; Modified: 2019-11-15 07:17:55Z.</em></sup></p>
<h3 data-number="5.22.1"><span class="header-section-number">5.22.1</span> Object Inheritance and Code Reuse</h3>
<p><sup><em>Requirement: CREQ0325; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-15 07:18:01Z; Modified: 2019-11-15 07:25:57Z.</em></sup></p>
<p>Object Oriented Design is a design methodology, of which inheritance has a meaning. Use object inheritance to describe relationships between objects.</p>
<p>However it is often used just for the purpose of code reuse.</p>
<p>Reconsider the use of object inheritance if it is only for the purpose of code reuse. There are often other techniques (composition, static helper methods) that may be more suitable.</p>
<p><strong>Rationale</strong>:</p>
<p>If <strong>class B</strong> derives from <strong>class A</strong>, it is said that B is an A, but A is not a B. If in the real world modelling this is not the case, then do not use Object Inheritance to describe this.</p>
<p>Consider if there is a fundamental object and model it that way, as a user would expect, not how a programmer can reuse code which the user doesn&#39;t see anyway.</p>
<p>So do not allow the implementation to influence the design and thus leading to confusion of the user.</p>
<h3 data-number="5.22.2"><span class="header-section-number">5.22.2</span> Extending Objects and the Open/Closed Principle</h3>
<p><sup><em>Requirement: CREQ0326; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-15 07:26:04Z; Modified: 2019-11-15 07:52:49Z.</em></sup></p>
<p>The Open/Closed principle from S.O.L.I.D. says to write code that it&#39;s easy to add new functionality without modifying existing code. That prevents situations in which a change to one of your classes also requires you to adapt all depending classes.</p>
<p>However, be warned that software inheritance also introduces tight coupling if the subclasses depend on implementation details of their parent class.</p>
<p><strong>Example</strong>:</p>
<p>A basic buffer data class provides an implementation wrapped around an array. It has an indexer and a length.</p>
<pre><code>public Buffer {
  print int[] m_Array;

  public Buffer(int length) {
    m_Array = new int[length];
  }

  public virtual int Length { get { return m_Array.Length; } }

  public virtual int GetValue(int index) {
    if (index &lt; 0 || index &gt;= Length)
      throw new ArgumentOutOfRangeException();
    return m_Array[index];
  }</code></pre>
<pre><code>  public int GetSum() {
    int sum;
    for (int i = 0; i &lt; Length; i++)
      sum += m_Array[i];
    return sum;
  }
}</code></pre>
<p>Then a derived class is created which keeps the semantics, so it can be used in the place of every class requiring <strong>Buffer</strong>, but allows two arrays to still look like a continuous block of memory, the first array is maintained as part of <strong>Buffer</strong>, the second array is created in the derived class. The <strong>Length</strong>for the derived class is now the sum of both arrays.</p>
<p>The base class <strong>Buffer</strong>uses the property <strong>Length</strong>internally. When overriding the class <strong>Buffer</strong>, one must now be aware of the details that the base class may now have its behaviour changed through the derived class unexpectedly, and requires intimate knowledge of the base class to extend.</p>
<p>So the derived class overrides Length to be:</p>
<pre><code>public override int Length {
  get { return base.Length + m_SecondArray.Length; }
}</code></pre>
<p>But as you can see, the implementation of GetSum() is now broken.</p>
<p><strong>Solution</strong>:</p>
<p>Consider the Polymorphic Open/Closed principle. Derive from interfaces or very simple abstract base classes and consider composition instead of inheritance. This adds an additional level of abstraction which enables loose coupling.</p>
<p>If sharing code via inheritance, design the classes so that base classes override <strong>protected virtual</strong>methods instead of <strong>public virtual</strong> methods. The base class allows extension only via the <strong>protected</strong>methods.</p>
<p>An example of this is the Microsoft <strong>Collection&lt;T&gt;</strong> class.</p>
<h1 data-number="6"><span class="header-section-number">6</span> Public Documentation</h1>
<p><sup><em>Requirement: CREQ0096; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-15 15:29:26Z; Modified: 2015-11-09 08:38:06Z.</em></sup></p>
<h2 data-number="6.1"><span class="header-section-number">6.1</span> Assembly Public Documentation for Framework Components</h2>
<p><sup><em>Requirement: CREQ0097; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-15 15:29:34Z; Modified: 2015-11-09 08:38:18Z.</em></sup></p>
<p>XML documentation shall be provided for all API framework components.</p>
<h2 data-number="6.2"><span class="header-section-number">6.2</span> SHFB</h2>
<p><sup><em>Requirement: CREQ0098; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-15 15:30:13Z; Modified: 2019-11-01 21:32:01Z.</em></sup></p>
<p>The build system for API documentation shall be SHFB (Sandcastle Help File Builder) by Eric Woodruff.</p>
<p>Results shall be in HTML and MSHELP 2.x format compatible with Visual Studio 2017.</p>
<h2 data-number="6.3"><span class="header-section-number">6.3</span> Build Conditions</h2>
<p><sup><em>Requirement: CREQ0099; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-15 15:30:44Z; Modified: 2015-11-09 08:38:21Z.</em></sup></p>
<p>There shall be no warnings generated during the build process for Release for API documentation for framework components.</p>
<p>There shall be no warnings or errors generated when building using the current version of SHFB.</p>
<h2 data-number="6.4"><span class="header-section-number">6.4</span> Spelling and Grammar</h2>
<p><sup><em>Requirement: CREQ0100; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-15 15:34:16Z; Modified: 2017-08-12 20:58:01Z.</em></sup></p>
<p>All public documentation shall be in English. The dialect of english shall be consistent with the project (either British en-GB or American en-US).</p>
<p>For example, the Automation framework uses en-US.</p>
<p>Sentences shall be properly terminated with a period, and grammar should generally be correct.</p>
<p>The language shall be clear, concise and understandable. If examples make the concept clearer, examples should be provided.</p>
<h1 data-number="7"><span class="header-section-number">7</span> Testing</h1>
<p><sup><em>Requirement: CREQ0101; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:47:52Z; Modified: 2017-08-12 18:58:01Z.</em></sup></p>
<h2 data-number="7.1"><span class="header-section-number">7.1</span> The Model</h2>
<p><sup><em>Requirement: CREQ0103; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:34:17Z; Modified: 2017-12-26 14:54:28Z.</em></sup></p>
<p>By applying the model approach, as discussed in the section for Design Patterns makes it much easier to unit test.</p>
<p><strong>Rationale</strong>:</p>
<p>Applying tests to a model promotes a better design and software architecture. Methods are smaller to make it easier to write unit test code for. Smaller and better defined methods reduce cyclomatic complexity reducing the chance of defects in software and making code easier to read.</p>
<h3 data-number="7.1.1"><span class="header-section-number">7.1.1</span> Application Methods should be Public</h3>
<p><sup><em>Requirement: CREQ0104; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-30 21:37:23Z; Modified: 2019-11-02 12:54:57Z.</em></sup></p>
<p>The methods being tested in the EXE should be <strong>public</strong>, to make it easier to test without having to resort to reflection and other difficult to read constructs.</p>
<h3 data-number="7.1.2"><span class="header-section-number">7.1.2</span> Appropriate Model</h3>
<p><sup><em>Requirement: CREQ0145; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:58:57Z; Modified: 2017-08-12 19:00:12Z.</em></sup></p>
<p>Applications and Framework libraries should follow an appropriate design pattern, that is suited for testability, even if relatively small.</p>
<h4 data-number="7.1.2.1"><span class="header-section-number">7.1.2.1</span> MVVM - Model View View Model</h4>
<p><sup><em>Requirement: CREQ0146; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 19:00:14Z; Modified: 2017-08-12 19:00:49Z.</em></sup></p>
<p>WPF Projects should use the MVVM model. The Model and View Model should be testable.</p>
<h4 data-number="7.1.2.2"><span class="header-section-number">7.1.2.2</span> Domain Driven Design</h4>
<p><sup><em>Requirement: CREQ0147; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2017-08-12 19:00:51Z; Modified: 2017-08-12 19:02:05Z.</em></sup></p>
<p>Applications and Frameworks should follow Domain Driven Design, separating Application, Business / Model, Storage and Infrastructure into separate layers, potentially separate assemblies for strict separation.</p>
<p>Each class in each layer should be designed for testability.</p>
<h3 data-number="7.1.3"><span class="header-section-number">7.1.3</span> Test Patterns</h3>
<p><sup><em>Requirement: CREQ0176; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-29 22:47:47Z; Modified: 2019-06-29 22:48:12Z.</em></sup></p>
<p>There are many ways to write testable code, some listed in this section.</p>
<h4 data-number="7.1.3.1"><span class="header-section-number">7.1.3.1</span> Inversion of Control</h4>
<p><sup><em>Requirement: CREQ0144; Author: jcurl; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2017-08-12 18:54:20Z; Modified: 2019-06-29 22:48:14Z.</em></sup></p>
<p>Software design should use Inversion of Control where appropriate to allow testability.</p>
<p><strong>Rationale</strong>:</p>
<p>A class for implementing hardware diagnostics would have a class that necessarily requires information from hardware through specialized drivers. A business logic class might raise events depending on the data that is obtained. Testing can be challenging, especially if it requires specific hardware, or even more so difficult in error use cases.</p>
<p>By using an interface to abstract the hardware and allowing the business logic class to program against an interface instead of a specific implementation, a test case can be written to simulate error conditions without the need for specific hardware.</p>
<h4 data-number="7.1.3.2"><span class="header-section-number">7.1.3.2</span> Factories and Interfaces</h4>
<p><sup><em>Requirement: CREQ0175; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2019-06-29 22:46:31Z; Modified: 2019-06-29 22:50:40Z.</em></sup></p>
<p>Software design should use the Factory pattern to allow a test case to generate their own test objects for mocking.</p>
<p><strong>Rationale</strong>:</p>
<p>By using the factory pattern, the &quot;Program&quot; can initialize factories required for real work. Factories should implement an interface that a test program can write their own factory to replace functionality for mocking.</p>
<p>For example, a factory can create a class that can serialize an object to disk. A test program might want to replace this factory with its own, so that when the main application serializes to disk, the test class generated by the test factory raises a file system exception, otherwise exceptionally difficult for all Operating Systems when done as an integration test.</p>
<h2 data-number="7.2"><span class="header-section-number">7.2</span> Unit Testing</h2>
<p><sup><em>Requirement: CREQ0102; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-25 22:06:01Z; Modified: 2019-11-02 12:55:47Z.</em></sup></p>
<p>Unit Testing should be performed on the main executable as well as on any assemblies that are being used.</p>
<p>The major benefits of unit testing for design are:</p>
<ul>
<li><p>Early refactoring of the software to allow for a clean design that can be unit tested. This reduces the size of the functions, reducing the cyclomatic complexity.</p></li>
<li><p>Allow early capture of breaking changes, either to framework functionality or classes that are used in other locations.</p></li>
<li><p>Check functionality again after refactoring</p></li>
<li><p>Provide documentation in the form of code on how a class is expected to be used, by the way that a Unit test manipulates it.</p></li>
</ul>
<p>Advantages of Unit Testing for cross development are:</p>
<ul>
<li><p>Identify differences between operating systems and their behavior, and ensure the behavior of a class is consistent regardless of the Operating System.</p></li>
<li><p>Allow for better planning and quicker porting of software to new Operating Systems or frameworks.</p></li>
</ul>
<p>Portability is all the more important especially for supporting multiple Operating Systems.</p>
<ul>
<li><p>There are always subtle differences between the actual operating systems being used. For example, networking on Windows XP might return different results than networking on Windows 7 due to the differences in the underlying network libraries.</p></li>
<li><p>The Mono Framework on Linux is changing at a rapid pace, especially with the .NET core being open sourced. It is easy to determine for the target platform if the system is likely to work, or if there is missing functionality, or a change in new functionality (especially through the <strong>PlatformNotSupportedException</strong>).</p></li>
<li><p>Run unit tests, via the NUnit test binary, to identify issues early in an automatic way.</p></li>
</ul>
<h3 data-number="7.2.1"><span class="header-section-number">7.2.1</span> Test Project Structure</h3>
<p><sup><em>Requirement: CREQ0190; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:36:00Z; Modified: 2019-11-02 10:38:47Z.</em></sup></p>
<h4 data-number="7.2.1.1"><span class="header-section-number">7.2.1.1</span> Separate Production Code from Test Code</h4>
<p><sup><em>Requirement: CREQ0191; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:36:34Z; Modified: 2019-11-02 10:42:28Z.</em></sup></p>
<p>A separate test project shall be created that is in parallel to the production code. Do not mix test code and production code in the same project file.</p>
<p><strong>Rationale</strong>:</p>
<p>All test code, is by definition dead code (it is not used by the framework library) and should not be part of the product.</p>
<p>In case that a platform is failing, it is easy to copy the code that performs the tests to the client platform and rerun. For example NUnit 2.6.x has minimum requirements of .NET 2.0, which is less than modern code, and so requires minimal, if at all, extra installation to run the tests.</p>
<h4 data-number="7.2.1.2"><span class="header-section-number">7.2.1.2</span> Directory, File and Class Structure</h4>
<p><sup><em>Requirement: CREQ0192; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:38:26Z; Modified: 2019-11-02 10:42:34Z.</em></sup></p>
<p>The directory structure and class structure should mirror the structure of the code under test. There should be one test class for each class under test.</p>
<p>Namespaces of the test class should be the same as the class under test.</p>
<p><strong>Rationale</strong>:</p>
<p>When adding, modifying or removing code from a class, one should be able to quickly identify where the test code is maintained. This helps the developer reduce duplicated test code and by understanding the structure of the production code, test code can be easier understood.</p>
<h3 data-number="7.2.2"><span class="header-section-number">7.2.2</span> NUnit Test Framework</h3>
<p><sup><em>Requirement: CREQ0105; Author: jcurl; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:47:59Z; Modified: 2019-11-02 12:56:50Z.</em></sup></p>
<p>Software should use the NUnit Test Framework.</p>
<p><strong>Rationale</strong>:</p>
<p>The NUnit test framework is mature, used by Microsoft in the CoreFX project and is cross platform. It also offers a much richer set of features of MSTest. It is also the default test framework for Mono on other platforms.</p>
<p>It can be installed using <strong>nuget</strong> within your assembly. The NUnit Test Adaptor works also in the VS2013 and later Community Editions. Even though it can&#39;t be used in the desktop editions, NUnit has a test framework that runs outside of the Visual Studio IDE.</p>
<p>The current version is 2.6.7. The 3.x versions should not be used as they&#39;re not supported natively by MonoIDE 5.1 or earlier (at the time of writing). NUnit 3.x is not backward compatible to NUnit 2.6.7.</p>
<p>Version 2.7.0 has some minor backward compatibility issues, and should probably not be used when upgrading, instead upgrade to NUnit 3.x.</p>
<h4 data-number="7.2.2.1"><span class="header-section-number">7.2.2.1</span> Testing on Supported Platforms</h4>
<p><sup><em>Requirement: CREQ0106; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:49:47Z; Modified: 2017-08-19 21:18:06Z.</em></sup></p>
<p>By using the NUnit Framework, you can also test your application software and frameworks on supported platforms without installing the IDE. Install the NUnit test application, which will work with .NET 2.0 and later.</p>
<h4 data-number="7.2.2.2"><span class="header-section-number">7.2.2.2</span> Writing Assertions</h4>
<p><sup><em>Requirement: CREQ0107; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:51:21Z; Modified: 2019-11-02 11:07:34Z.</em></sup></p>
<p>You should write assertions using the new Constraint Model, otherwise known as Fluent style. The fluent style allows test cases to read similar to natural languages, making it easier to translate English written requirements into code that reads the same.</p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(myobject, Is.True);
Assert.That(myobject, Is.EqualTo(&quot;bar&quot;));
Assert.That(myobject, Is.Null.Or.EqualTo(&quot;foo&quot;));</code></pre>
<p>Instead of:</p>
<pre><code>Assert.IsTrue(myobject);
Assert.IsEqual(&quot;bar&quot;, myobject);</code></pre>
<p><strong>Rationale</strong>:</p>
<p>The constraint model works from left to right (where the classical model is from right to left), making it easier to write the assertions in code (you might not immediately remember the name of the variable your testing, but know what it should be, the left to right allows you to keep your train of thought).</p>
<p><strong>Rationale</strong>:</p>
<p>The constraint model is much more powerful, implementing &quot;or&quot; and &quot;and&quot; conditions easily within an assertion, as in the third example. Doing the equivalent in the classical model is much more complicated.</p>
<p>The sections following are examples only. The NUnit documentation should be followed, along with taking notes of warnings and messages for obsolescence as required.</p>
<h5 data-number="7.2.2.2.1"><span class="header-section-number">7.2.2.2.1</span> Assert.That over Assert.Pass and Assert.Fail</h5>
<p><sup><em>Requirement: CREQ0202; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:21:49Z; Modified: 2019-11-02 15:34:59Z.</em></sup></p>
<p>Avoid where ever possible the usage of <strong>Assert.Pass()</strong> and <strong>Assert.Fail()</strong> if it can be rewritten using <strong>Assert.That</strong>.</p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(bytesRead, Is.EqualTo(10), &quot;Incorrect number of bytes&quot;);</code></pre>
<p>Do not use</p>
<pre><code>if (bytesRead != 10) Assert.Fail(&quot;Incorrect number of bytes&quot;);</code></pre>
<h5 data-number="7.2.2.2.2"><span class="header-section-number">7.2.2.2.2</span> Equality</h5>
<p><sup><em>Requirement: CREQ0194; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:50:39Z; Modified: 2019-11-02 12:57:24Z.</em></sup></p>
<p>Test for equality with <strong>Is[.Not].EqualTo()</strong></p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(value, Is.EqualTo(expectedValue));
Assert.That(value, Is.Not.EqualTo(wrongValue));</code></pre>
<p>Do not use</p>
<pre><code>Assert.AreEqual(expectedValue, value);
Assert.AreNotEqual(wrongValue, value);</code></pre>
<p><strong>Note</strong>:</p>
<p>The method <strong>AreEqual()</strong> in NUnit 2.6.x will perform implicit type conversion, where as the Constraint checks will fail if the types differ. e.g.</p>
<pre><code>int value = 49;
Assert.AreEqual(&#39;1&#39;, value); // Pass
Assert.That(value, Is.EqualTo(&#39;1&#39;)); //Fail as char and int differ.</code></pre>
<p>You will need to perform necessary type casts in code.</p>
<h5 data-number="7.2.2.2.3"><span class="header-section-number">7.2.2.2.3</span> Value Type Ranges</h5>
<p><sup><em>Requirement: CREQ0201; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:20:25Z; Modified: 2019-11-02 12:57:30Z.</em></sup></p>
<p>Check that value types are within a range with <strong>Is.InRange(min, max)</strong></p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(myInt, Is.InRange(0, 5));</code></pre>
<p>Do not use</p>
<pre><code>Assert.That(myInt &gt;= 0 &amp;&amp; myInt &lt;6, Is.True);</code></pre>
<h5 data-number="7.2.2.2.4"><span class="header-section-number">7.2.2.2.4</span> Null Checks</h5>
<p><sup><em>Requirement: CREQ0195; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:53:31Z; Modified: 2019-11-02 12:57:33Z.</em></sup></p>
<p>Test for null checks with <strong>Is[.Not].Null</strong></p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(myString, Is.Not.Null);
Assert.That(myString2, Is.Null);</code></pre>
<p>Do not use</p>
<pre><code>Assert.IsNotNull(myString);
Assert.NotNull(myString);
Assert.IsNull(myString2);
Assert.Null(myString2);</code></pre>
<h5 data-number="7.2.2.2.5"><span class="header-section-number">7.2.2.2.5</span> True/False Checks</h5>
<p><sup><em>Requirement: CREQ0196; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:54:57Z; Modified: 2019-11-02 12:57:40Z.</em></sup></p>
<p>Test for true/false checks with <strong>Is.True</strong> or <strong>Is.False</strong></p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(value, Is.True);
Assert.That(value2, Is.False);</code></pre>
<p>Do not use</p>
<pre><code>Assert.IsTrue(value);
Assert.That(value);
Assert.IsFalse(value2);
Assert.That(!value2);</code></pre>
<h5 data-number="7.2.2.2.6"><span class="header-section-number">7.2.2.2.6</span> Type Comparisons</h5>
<p><sup><em>Requirement: CREQ0200; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:18:33Z; Modified: 2019-11-02 12:57:46Z.</em></sup></p>
<p>Test for the object type with <strong>Is.TypeOf&lt;T&gt;()</strong> or <strong>Is.InstanceOf&lt;T&gt;()</strong></p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(myLine, Is.TypeOf&lt;TraceLineDlt&gt;());
Assert.That(myLine, Is.InstanceOf&lt;TraceLineDltBase&gt;());</code></pre>
<p>Do not use</p>
<pre><code>Assert.That(myLine is TraceLineDltBase, Is.True);
Assert.That(myLine.GetType() == typeof(TraceLineDlt), Is.True);</code></pre>
<h5 data-number="7.2.2.2.7"><span class="header-section-number">7.2.2.2.7</span> String Comparisons</h5>
<p><sup><em>Requirement: CREQ0197; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:57:58Z; Modified: 2019-11-02 11:18:28Z.</em></sup></p>
<p><strong>Example - String Equality</strong>:</p>
<pre><code>Assert.That(myString, Is.EqualTo(&quot;string&quot;));</code></pre>
<p>Do not use</p>
<pre><code>Assert.That(myString.Equals(&quot;string&quot;), Is.True);</code></pre>
<p><strong>Example - StartsWith</strong>:</p>
<pre><code>Assert.That(myString, Does.StartWith(&quot;str&quot;));</code></pre>
<p>Do not use</p>
<pre><code>Assert.That(myString.StartsWith(&quot;str&quot;), Is.True);</code></pre>
<p><strong>Example - EndsWith</strong>:</p>
<pre><code>Assert.That(myString, Does.EndWith(&quot;ing&quot;));</code></pre>
<p>Do not use</p>
<pre><code>Assert.That(myString.EndsWith(&quot;ing&quot;), Is.True);</code></pre>
<p><strong>Example - Substrings</strong>:</p>
<pre><code>Assert.That(myString, Contains.SubString(&quot;rin&quot;));</code></pre>
<p><strong>Example - Regular Expressions</strong>:</p>
<pre><code>Assert.That(myString, Is.StringMatching(&quot;s.*g&quot;));</code></pre>
<p><strong>Example - String Length</strong>:</p>
<pre><code>Assert.That(myString, Has.Length.EqualTo(5));</code></pre>
<p><strong>Example - Compound Check with RegEx</strong>:</p>
<pre><code>Assert.That(myString, Has.Length.GreaterThan(2).And.Not.Matches(&quot;.*s$&quot;));</code></pre>
<h5 data-number="7.2.2.2.8"><span class="header-section-number">7.2.2.2.8</span> Testing Exceptions</h5>
<p><sup><em>Requirement: CREQ0198; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:08:18Z; Modified: 2019-11-02 12:58:06Z.</em></sup></p>
<p>Testing exceptions is made much simpler with the C# language construct lambdas.</p>
<p><strong>Example - Testing ArgumentNullException</strong>:</p>
<pre><code>Assert.That(() =&gt; {
  myFunction(null);
}, Throws.TypeOf&lt;ArgumentNullException&gt;());</code></pre>
<p>Note, that one should not use:</p>
<pre><code>Throws.InstanceOf&lt;ArgumentException&gt;();</code></pre>
<p>as the test would pass with the <strong>ArgumentException</strong>and all other exceptions derived thereof, not allowing test cases to properly test the API documentation for the method.</p>
<p>Do not use the attribute</p>
<pre><code>[ExpectedException(ArgumentNullException)]</code></pre>
<p>Should the exception be thrown, it applies to the entire test case. If there is an error in the test case set up, the test might pass without the implementor realizing the test case is effectively doing nothing (without analyzing code coverage results in detail).</p>
<p><strong>Example - Test No Exception is Thrown</strong>:</p>
<pre><code>Assert.That(() =&gt; {
  myFunction(string.Empty);
}, Throws.Nothing);</code></pre>
<p>While an exception would fail without the assertion, it may improve the readability depending on the test case.</p>
<h5 data-number="7.2.2.2.9"><span class="header-section-number">7.2.2.2.9</span> Collection Asserts</h5>
<p><sup><em>Requirement: CREQ0193; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 10:43:07Z; Modified: 2019-11-02 10:50:21Z.</em></sup></p>
<p>Use the following to test for equality of collections</p>
<p><strong>Example</strong>:</p>
<pre><code>IList&lt;string&gt; output = Class.GetList();</code></pre>
<p><strong>Example - List Equality</strong>:</p>
<pre><code>string[] expectedOutput = new[] { &quot;string1&quot;, &quot;string2&quot; };
Assert.That(output, Is.EqualTo(expectedOutput));</code></pre>
<p>Do not use:</p>
<pre><code>CollectionAssert.AreEqual(expectedOutput, output);</code></pre>
<p><strong>Example - Membership</strong>:</p>
<p>Assert.That(output, Has.Member(&quot;string1&quot;))</p>
<p>Do not use</p>
<pre><code>Assert.That(output.Contains(&quot;string1&quot;), Is.True);</code></pre>
<p><strong>Example - Two Lists by Reference</strong>:</p>
<p>If the list references must be compared, not the content, you need to use different assertions:</p>
<pre><code>Assert.That(output, Is.SameAs(originalList));</code></pre>
<p>Do not use</p>
<pre><code>Assert.That(ReferenceEquals(output, originalList), Is.True);</code></pre>
<p><strong>Example - Empty List</strong>:</p>
<p>If the list is expected to be empty</p>
<pre><code>Assert.That(output, Is.Empty);</code></pre>
<p>Do not use</p>
<pre><code>Assert.That(output.Count, Is.EqualTo(0));</code></pre>
<h5 data-number="7.2.2.2.10"><span class="header-section-number">7.2.2.2.10</span> TestCaseSource</h5>
<p><sup><em>Requirement: CREQ0199; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:15:24Z; Modified: 2019-11-02 11:17:46Z.</em></sup></p>
<p>For test cases that have complex types of inputs, which can be reused across multiple test cases, the attribute</p>
<pre><code>[TestCaseSource(source)]</code></pre>
<p>can be used.</p>
<p>The <strong>source</strong>parameter is the name of the function which provides the source test data.</p>
<p>Use the <strong>nameof()</strong> operator instead of a string to provide the name of the function.</p>
<p>The method providing the source must be <strong>static</strong>, to be compatible with NUnit 2 and NUnit 3. Do not use non-static methods for providing source data.</p>
<h4 data-number="7.2.2.3"><span class="header-section-number">7.2.2.3</span> Test Cases</h4>
<p><sup><em>Requirement: CREQ0108; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:56:01Z; Modified: 2019-11-02 12:58:42Z.</em></sup></p>
<p>In NUnit, you should use the <strong>[TestCase]</strong> attribute where it makes sense to improve test case coverage, without having to repeat significant portions of code.</p>
<p>You should limit the maximum number of parameters to 3, to reduce the complexity of the test cases and the code.</p>
<p><strong>Rationale</strong>:</p>
<p>It gets difficult when the number of <strong>[TestCase]</strong> attributes exceed 8. Still, there is no concrete requirement to limit the number of Test Cases, especially with string type inputs where the number of input variations can be high.</p>
<h4 data-number="7.2.2.4"><span class="header-section-number">7.2.2.4</span> Testing Complex Variations</h4>
<p><sup><em>Requirement: CREQ0109; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-17 08:57:00Z; Modified: 2019-11-02 12:58:46Z.</em></sup></p>
<p>If you have more than three operational parameters that you want to test, then instead of using the <strong>[TestCase]</strong> attribute, you should design a test class and manually program testing the various combinations.</p>
<h2 data-number="7.3"><span class="header-section-number">7.3</span> Accessor Framework and Internal Classes</h2>
<p><sup><em>Requirement: CREQ0152; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 16:03:13Z; Modified: 2017-12-26 16:05:29Z.</em></sup></p>
<h3 data-number="7.3.1"><span class="header-section-number">7.3.1</span> InternalsVisibleTo</h3>
<p><sup><em>Requirement: CREQ0154; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2017-12-26 16:05:30Z; Modified: 2019-11-02 12:58:54Z.</em></sup></p>
<p>Do not use the <strong>InternalsVisibleTo</strong>attribute to allow testability of internal objects.</p>
<p><strong>Rationale</strong>:</p>
<p>The <strong>InternalsVisibleTo</strong>attribute is a powerful and convenient mechanism to implement a test case. Having production code refer to test code however, is unnatural (the test code should refer to production code it tests). It also implies directly a change to the assembly being tested if multiple assemblies for test would be desired and causes issues with strongly named binaries (also introducing reversed dependencies and increased build complexity).</p>
<h3 data-number="7.3.2"><span class="header-section-number">7.3.2</span> AccessorBase</h3>
<p><sup><em>Requirement: CREQ0153; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 16:03:28Z; Modified: 2019-11-02 12:59:06Z.</em></sup></p>
<p>The NUnitExtensions <strong>AccessorBase</strong>implementation should be used for testing internal classes to an Assembly.</p>
<p><strong>Rationale</strong>:</p>
<p>An internal class is available for use for all components within an assembly, even if not generally available for other frameworks. It should contain sufficient test cases and have their public methods and properties tested as if it were a public class.</p>
<p><strong>Note</strong>:</p>
<p>Not all features can be tested using the <strong>AccessorBase</strong>. Features that can be tested are:</p>
<ul>
<li><p>Static and non-static types with static and non-static methods and properties;</p></li>
<li><p>Nested classes, be they static or non-static;</p></li>
<li><p>Private types returned by methods in other private types;</p></li>
<li><p>Private types used in the signature of methods in other private types;</p></li>
<li><p>Generics where the type parameters are public;</p></li>
<li><p>Private types derived from other private types.</p></li>
</ul>
<h3 data-number="7.3.3"><span class="header-section-number">7.3.3</span> Internal and Private Members</h3>
<p><sup><em>Requirement: CREQ0155; Author: Jason Curl &lt;jason.curl@harman.com&gt;; Status: Proposed; Version: 1.0; Created: 2017-12-26 16:10:45Z; Modified: 2019-11-02 12:59:58Z.</em></sup></p>
<p>Unit test cases of internal types should restrict themselves to only testing <strong>public</strong>/<strong>internal</strong> members.</p>
<p><strong>Rationale</strong>:</p>
<p>If a test cases needs to test <strong>private</strong>members, this is an indication of a design problem. Consider other alternatives such as dependency injection and <strong>abstract class</strong>es or <strong>interface</strong>s.</p>
<p><strong>Example</strong>:</p>
<p>A class <strong>ClassClient</strong>takes in its constructor an object of type <strong>ClassServer</strong> which contains a <strong>Register</strong>method. Instead of trying to test the <strong>private</strong>members of <strong>ClassServer</strong>that registration occurred, a test case should instead consider making for <strong>ClassServer</strong>also <strong>IClassServer</strong>so that the test case can implement its own <strong>Register</strong>method without needing to test the specific implementation of <strong>ClassServer</strong></p>
<p>The original code might have been:</p>
<pre><code>internal class ClassClient {
  public ClassClient(ClassServer server) {
    server.Register(this);
  }
}</code></pre>
<p>This means that an instance of <strong>ClassServer</strong>needs to be created and somehow tested that <strong>ClassClient</strong>called Register. An alternative would be to use interfaces:</p>
<pre><code>internal class ClassClient {
  public ClassClient(IClassServer server) {
    server.Register(this);
  }
}</code></pre>
<p>with the small difference being now that the test code can implement the contract specified by <strong>IClassServer</strong>and can easily maintain itself that Register was called without having to resort to reflection or complicated test code.</p>
<h2 data-number="7.4"><span class="header-section-number">7.4</span> Debug and Conditional Checks</h2>
<p><sup><em>Requirement: CREQ0177; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-29 22:51:27Z; Modified: 2019-11-04 19:53:24Z.</em></sup></p>
<p>Sometimes it is necessary to perform checks in code, but disable them for release mode for performance reasons. Debug mode should perform extra checking that ensures consistency within the program (such as a &quot;checked&quot; build).</p>
<h3 data-number="7.4.1"><span class="header-section-number">7.4.1</span> Debug.Assert</h3>
<p><sup><em>Requirement: CREQ0178; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-29 22:52:31Z; Modified: 2019-11-02 13:00:13Z.</em></sup></p>
<p>Do <strong>not</strong>use <strong>Debug.Assert</strong>.</p>
<p><strong>Rationale</strong>:</p>
<p>Using <strong>Debug.Assert</strong> will raise a window to the user for extra debug information by default. This results in tests that can&#39;t be automated if a <strong>Debug.Assert</strong> fires, because the program will generally halt waiting for the user to continue.</p>
<h3 data-number="7.4.2"><span class="header-section-number">7.4.2</span> Contracts</h3>
<p><sup><em>Requirement: CREQ0179; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-06-29 22:53:44Z; Modified: 2019-11-02 10:35:09Z.</em></sup></p>
<p>If the project build system supports contracts, then contracts should be used.</p>
<p>Contracts allow internal and private methods to state assumptions, such as methods will not be called with null values. Debug mode can throw exceptions if a contract is violated (so that unit tests may find issues faster, rather than ignoring the problem), and static analysis tools may highlight code paths were contracts may be violated.</p>
<p>THe advantage is that code states specifically what is intended and the checks are removed in release mode to allow for better performance.</p>
<p>Microsoft contracts needs specific set up and tools for binary rewriting in release mode.</p>
<p>Unit tests should therefore run in both release mode and debug mode (with and without contracts enabled).</p>
<h1 data-number="8"><span class="header-section-number">8</span> Visual Studio Extensions</h1>
<p><sup><em>Requirement: CREQ0110; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 08:01:10Z; Modified: 2019-11-02 11:24:35Z.</em></sup></p>
<p>Code quality scan tools should be used during the development. For each tool, some common conditions are highlighted that should not occur.</p>
<h2 data-number="8.1"><span class="header-section-number">8.1</span> Spell Checker (High)</h2>
<p><sup><em>Requirement: CREQ0111; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:35:06Z; Modified: 2016-07-25 20:53:26Z.</em></sup></p>
<p>The Spell Checker Plugin from E. Woodruff should be used with the English-US or English-UK dictionary. It should be consistent throughout the project.</p>
<p>These checks for spelling errors in XML comments, strings presented to the user and naming of variables.</p>
<h2 data-number="8.2"><span class="header-section-number">8.2</span> GhostDoc (Commercial, Mid)</h2>
<p><sup><em>Requirement: CREQ0112; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:37:03Z; Modified: 2019-11-02 11:25:15Z.</em></sup></p>
<p>GhostDoc makes it considerably simpler to write comments for API methods with (Ctrl-Shift-D).</p>
<p>As code may be moved to a framework component at any time, it is important the API documentation is correct and understandable.</p>
<p>Most recent versions however require a license.</p>
<h2 data-number="8.3"><span class="header-section-number">8.3</span> ReSharper (Commercial, Low)</h2>
<p><sup><em>Requirement: CREQ0113; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:39:28Z; Modified: 2015-11-10 08:03:24Z.</em></sup></p>
<p>ReSharper is a commercial tool and provides lint like functionality. Useful from ReSharper is the documentation explaining the reasoning for errors found.</p>
<p>It can find typical coding design issues (usage of virtual methods in a constructor) as well as recommendations that can make code more readable.</p>
<h2 data-number="8.4"><span class="header-section-number">8.4</span> Concurrency Analysis (Mid)</h2>
<p><sup><em>Requirement: CREQ0119; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-10-20 21:48:34Z; Modified: 2019-11-02 13:00:42Z.</em></sup></p>
<p>In use cases where performance is required on multithreaded systems, the Microsoft concurrency plugins shall be used for analyzing thread and CPU core usage.</p>
<h1 data-number="9"><span class="header-section-number">9</span> Visual Studio Analyzers</h1>
<p><sup><em>Requirement: CREQ0203; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:24:42Z; Modified: 2019-11-02 11:24:47Z.</em></sup></p>
<h2 data-number="9.1"><span class="header-section-number">9.1</span> Difference between VSIX and NuGet Analyzers</h2>
<p><sup><em>Requirement: CREQ0237; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:04:11Z; Modified: 2019-11-02 13:06:05Z.</em></sup></p>
<p>Use a VSIX analyzer in your solution if the warnings and messages should be available while developing. VSIX analyzers do not affect the build in any way.</p>
<p>Use a NuGet analyzer as part of your project if such rules should be made where warnings and errors can abort the build process (enforcing rules during the build). This is a much stricter model. There is no way to enable NuGet analyzers for all projects in a .NET Desktop solution.</p>
<h2 data-number="9.2"><span class="header-section-number">9.2</span> Suppression of Rules</h2>
<p><sup><em>Requirement: CREQ0306; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:13:18Z; Modified: 2019-11-02 18:13:24Z.</em></sup></p>
<h3 data-number="9.2.1"><span class="header-section-number">9.2.1</span> Pragma Usage</h3>
<p><sup><em>Requirement: CREQ0311; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:24:31Z; Modified: 2019-11-02 18:25:47Z.</em></sup></p>
<p>Pragmas should not be used for disabling warnings, unless there is no other way.</p>
<p>Where possible, suppress warnings through attributes.</p>
<p><strong>Rationale</strong>:</p>
<p>It is easy to write tools to parse through assemblies using reflection to find attributes, even for binaries. Pragma&#39;s only exist at the source level.</p>
<h3 data-number="9.2.2"><span class="header-section-number">9.2.2</span> VSIX Global Suppression</h3>
<p><sup><em>Requirement: CREQ0307; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:13:31Z; Modified: 2019-11-02 18:15:32Z.</em></sup></p>
<p>Each project shall have its own <strong>GlobalSuppression.cs</strong> file, which will be used to maintain a list of suppressions.</p>
<p>This file can be automatically generated by Visual Studio when suppressing a warning or a message in a file. The suppression attribute shall be modified so that:</p>
<ul>
<li><p>The <strong>Target</strong>property is removed</p></li>
<li><p>The <strong>Member</strong>property is removed</p></li>
<li><p>The <strong>Justification</strong>property is updated.</p></li>
</ul>
<p>There is no way in .NET FX to enable suppression for all projects.</p>
<h3 data-number="9.2.3"><span class="header-section-number">9.2.3</span> NuGet Global Suppression</h3>
<p><sup><em>Requirement: CREQ0309; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:16:56Z; Modified: 2019-11-02 18:17:28Z.</em></sup></p>
<p>Should an analyzer be provided in a project, the suppression of rules shall be done using the project ruleset.</p>
<h3 data-number="9.2.4"><span class="header-section-number">9.2.4</span> Suppression in Source</h3>
<p><sup><em>Requirement: CREQ0308; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:15:43Z; Modified: 2022-06-29 21:41:01Z.</em></sup></p>
<p>The suppression attribute may be applied to a member or a <strong>class</strong>.</p>
<ul>
<li><p>The <strong>Justification</strong>property shall be provided</p></li>
<li><p>The <strong>Member</strong>and <strong>Target</strong>properties are by default not provided.</p></li>
</ul>
<p>A suppression can be applied to a class for multiple members, but the suppression should be as concise as possible (i.e. at the most specific member, with the smallest scope). Thus, when applied to a <strong>class</strong>, it may be required to provide the <strong>Member</strong>property for a suppression. An example of this is S4136, adjacent methods, where the suppression would need to apply for all overloads of a member.</p>
<p><strong>Example, Member Suppression on a Class</strong>:</p>
<pre><code>[System.Diagnostics.CodeAnalysis.SuppressMessage(&quot;Minor Code Smell&quot;, &quot;S4136:Method overloads should be grouped together&quot;,
    Justification = &quot;Code organized by functional group (byte/char)&quot;,
    Scope = &quot;member&quot;, Target = &quot;~M:RJCP.Diagnostic.ConsoleReader.Read&quot;)]
public class ConsoleReader : Stream</code></pre>
<p>When applied to the class, all the <strong>Read</strong>methods are suppressed, but the <strong>Write</strong>methods are not.</p>
<h3 data-number="9.2.5"><span class="header-section-number">9.2.5</span> Suppression with .editorconfig</h3>
<p><sup><em>Requirement: CREQ0312; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-03 12:19:59Z; Modified: 2019-11-06 19:29:29Z.</em></sup></p>
<p>New in Visual Studio 2019 16.3 is the ability to suppress error messages in the IDE via the <strong>.editorconfig</strong> file. This should be avoided.</p>
<p>Even though this is a central location for the suppression of rules, it applies to the editor only, not the build system.</p>
<h3 data-number="9.2.6"><span class="header-section-number">9.2.6</span> False Positives</h3>
<p><sup><em>Requirement: CREQ0310; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 18:22:37Z; Modified: 2019-11-06 19:29:23Z.</em></sup></p>
<p>False positives should generally not be suppressed, so that fixes in the analyzer can be found. For example, SonarLint 4.12 has false positives for the usage of <strong>null</strong>parameters, that were fixed in 4.13 which shows more likely errors.</p>
<p>For cases where it must be suppressed, the Justification should contain the test &quot;False Positive, reason&quot; and be applied at the scope where the false positive has minimal effect.</p>
<h2 data-number="9.3"><span class="header-section-number">9.3</span> SonarLint for Visual Studio (High)</h2>
<p><sup><em>Requirement: CREQ0125; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 21:01:59Z; Modified: 2019-11-02 13:04:05Z.</em></sup></p>
<p>Sonar Lint for Visual Studio (as of writing version 4.13) should be used in projects. It is an Open Source tool with support by Microsoft, working with Visual Studio 2017 and later.</p>
<p>SonarLint should be installed as a Visual Studio extension, not as a NuGet package for individual projects.</p>
<h3 data-number="9.3.1"><span class="header-section-number">9.3.1</span> Rules which should not be ignored</h3>
<p><sup><em>Requirement: CREQ0241; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:33:39Z; Modified: 2019-11-02 13:33:43Z.</em></sup></p>
<h4 data-number="9.3.1.1"><span class="header-section-number">9.3.1.1</span> S108: Either remove or fill this block of code</h4>
<p><sup><em>Requirement: CREQ0242; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:33:52Z; Modified: 2019-11-02 13:43:16Z.</em></sup></p>
<p>Do not have empty statements, this indicates a probable typing error. Fix the problem by removing it, making a comment why it should be empty, or provide actual code.</p>
<pre><code>while (true) { }</code></pre>
<p>Make a comment as such:</p>
<pre><code>while (true) { /* infinite loop */ }</code></pre>
<p>A second common issue is catching and ignoring exceptions</p>
<pre><code>try {
  DoSomething();
} catch {
} finally {
}</code></pre>
<p>The catch block will catch everything, and it&#39;s not obvious why. Catch blocks shouldn&#39;t catch everything.</p>
<h4 data-number="9.3.1.2"><span class="header-section-number">9.3.1.2</span> S907: Remove this use of goto</h4>
<p><sup><em>Requirement: CREQ0291; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:56:02Z; Modified: 2019-11-02 14:56:24Z.</em></sup></p>
<p>For all those who remember spaghetti code and the 1980&#39;s</p>
<h4 data-number="9.3.1.3"><span class="header-section-number">9.3.1.3</span> S927: Rename parameter to match interface declaration</h4>
<p><sup><em>Requirement: CREQ0292; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:56:35Z; Modified: 2019-11-02 14:58:21Z.</em></sup></p>
<p>Methods defined in a class, should have the same parameter names as the methods defined in the interface it is inheriting from</p>
<p><strong>Old</strong>:</p>
<pre><code>interface MyInterface {
  void DoSomething(int a, int b);
}

public class MyClass : MyInterface {
  public void DoSomething(int b, int a);
}</code></pre>
<p><strong>New</strong>:</p>
<pre><code>interface MyInterface {
  void DoSomething(int a, int b);
}

public class MyClass : MyInterface {
  public void DoSomething(int a, int b);
}</code></pre>
<h4 data-number="9.3.1.4"><span class="header-section-number">9.3.1.4</span> S1104: Make the field private and encapsulate it in a public property</h4>
<p><sup><em>Requirement: CREQ0243; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:38:05Z; Modified: 2019-11-06 19:28:49Z.</em></sup></p>
<p>Do not make fields <strong>public</strong>.</p>
<p><strong>Old</strong>:</p>
<pre><code>public struct TraceLineData {
  public ITraceLine TraceLine;

  public TraceLineData(ITraceLine line) {
    TraceLine = line;
  }
}</code></pre>
<p><strong>New</strong>:</p>
<pre><code>public struct TraceLineData {
  public ITraceLine TraceLine { get; set; }

  public TraceLineData(ITraceLine line) {
    TraceLine = line;
  }
}</code></pre>
<p><strong>Rationale</strong>:</p>
<p>It is not possible to modify the code without breaking the API if new checks need to be made when getting or setting the property (e.g. setting might raise an exception, getting might need a performance optimization and use lazy initialization).</p>
<h4 data-number="9.3.1.5"><span class="header-section-number">9.3.1.5</span> S1116: Remove this empty statement</h4>
<p><sup><em>Requirement: CREQ0244; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:41:28Z; Modified: 2019-11-06 19:28:40Z.</em></sup></p>
<p>Do not have empty statements, this indicates a probable typing error. Fix the problem by removing it, making a comment why it should be empty, or provide actual code.</p>
<p>An example of where this is important is an accidental semicolon <strong>;</strong> after <strong>while</strong>loop, that may make it an infinite loop (note the spacing, which a person might interpret as being part of the while loop, where in reality spacing is ignored by the compiler).</p>
<pre><code>while (true);
  if (x == true) return;</code></pre>
<p>The <strong>while</strong>loop will become an infinite loop. Of course, if one really did want an infinite loop, then make a comment as such:</p>
<pre><code>while (true) { /* infinite loop */ }</code></pre>
<h4 data-number="9.3.1.6"><span class="header-section-number">9.3.1.6</span> S1118: Add a protected constructor or the static keyword to the class delcaration</h4>
<p><sup><em>Requirement: CREQ0245; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:43:31Z; Modified: 2019-11-06 19:28:17Z.</em></sup></p>
<p>THis occurs when a <strong>class</strong>only has <strong>static</strong>methods.</p>
<p><strong>Example</strong>:</p>
<pre><code>public class NetInfo {
  public static string GetCurrentInterface() { ... }
}</code></pre>
<p>Should be rewritten as</p>
<pre><code>public static class NetInfo {
  public static string GetCurrentInterface() { ... }
}</code></pre>
<h4 data-number="9.3.1.7"><span class="header-section-number">9.3.1.7</span> S1125: Remove the unnecessary boolean literals</h4>
<p><sup><em>Requirement: CREQ0248; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:48:18Z; Modified: 2019-11-06 19:28:10Z.</em></sup></p>
<p>Do not compare types which are boolean against <strong>true</strong>or <strong>false</strong>.</p>
<p><strong>Old</strong>:</p>
<pre><code>bool value = false;
if (value == false) Console.WriteLine(&quot;false&quot;);</code></pre>
<p><strong>New</strong>:</p>
<pre><code>bool value = false;
if (!value) Console.WriteLine(&quot;false&quot;);</code></pre>
<h4 data-number="9.3.1.8"><span class="header-section-number">9.3.1.8</span> S1135: Complete the task associated with the TODO comment</h4>
<p><sup><em>Requirement: CREQ0250; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:52:35Z; Modified: 2019-11-06 19:28:06Z.</em></sup></p>
<p>Programmers add &#39;<strong>TODO</strong>&#39; indicating that functionality is not complete. These warnings should be present and visible to the user so they can be acted upon.</p>
<h4 data-number="9.3.1.9"><span class="header-section-number">9.3.1.9</span> S1172: Remove this unused method parameter</h4>
<p><sup><em>Requirement: CREQ0252; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:54:27Z; Modified: 2019-11-02 13:56:02Z.</em></sup></p>
<p>The method signature contains a parameter which is unused and the object is not publicly accessible.</p>
<p><strong>Rationale</strong>:</p>
<p>Should remove unused parameters, as each parameter is pushed on to the stack. Performance code may be slightly impacted by this.</p>
<p>On the other hand, if the code is not impacted by performance, one may want to ignore this warning stating that methods follow a particular syntax.</p>
<h4 data-number="9.3.1.10"><span class="header-section-number">9.3.1.10</span> S1206: Class overrides GetHashCode and should override Equals</h4>
<p><sup><em>Requirement: CREQ0253; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:56:16Z; Modified: 2019-11-02 13:58:18Z.</em></sup></p>
<p>When providing an implementation of <strong>Equals</strong>, one must always provide an implementation of the <strong>GetHashCode</strong>method.</p>
<p>The <strong>GetHashCode</strong>method is used by .NET framework datastructures, such as <strong>Dictionary</strong>and <strong>HashSet</strong>for sorting values.</p>
<p>Users would expect that if two objects are equal, then their hash code are also equal.</p>
<p><strong>Note</strong>:</p>
<p>The reverse is not true, if two hash codes are equal, the objects are not necessarily equal.</p>
<h4 data-number="9.3.1.11"><span class="header-section-number">9.3.1.11</span> S1481: Remove the unused local variable</h4>
<p><sup><em>Requirement: CREQ0255; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:00:06Z; Modified: 2019-11-02 14:03:07Z.</em></sup></p>
<p>If the local variable is not used, it should be removed. This may indicate code paths that are not executed, showing errors. Compilers may optimize code so that the paths relying on this variable are removed.</p>
<p>Use the discard variable _, to indicate that the variable isn&#39;t needed</p>
<p><strong>Example</strong>:</p>
<pre><code>Assert.That(() =&gt; {_ = new MyObject(null); }, Throws.TypeOf&lt;ArgumentNullException&gt;());</code></pre>
<p>This example makes it clear that we&#39;re looking for an exception in test code and do not care about the object instantiated if the test should fail.</p>
<p><strong>Example</strong>:</p>
<pre><code>if (!dict.Search(&quot;input&quot;, out _, out int count)) { ... }</code></pre>
<p>This example indicates that only the second out parameter is required.</p>
<h4 data-number="9.3.1.12"><span class="header-section-number">9.3.1.12</span> S1854: Remove useless assignment to local variable</h4>
<p><sup><em>Requirement: CREQ0256; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:03:38Z; Modified: 2019-11-02 14:04:35Z.</em></sup></p>
<p>See also IDE0052 and IDE0059.</p>
<h4 data-number="9.3.1.13"><span class="header-section-number">9.3.1.13</span> S1871: Merge this branch or change one of the implementations</h4>
<p><sup><em>Requirement: CREQ0257; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:04:49Z; Modified: 2019-11-02 14:05:57Z.</em></sup></p>
<p>Indicates often a copy/paste bug. Either an <strong>else</strong>/<strong>if</strong> block or a switch case has identical implementations.</p>
<p>They should be merged, or corrected (if it was a copy/paste bug).</p>
<h4 data-number="9.3.1.14"><span class="header-section-number">9.3.1.14</span> S1905: Remove unnecessary cast</h4>
<p><sup><em>Requirement: CREQ0258; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:06:17Z; Modified: 2019-11-04 19:53:08Z.</em></sup></p>
<p>There&#39;s a cast to an object that is not required. Remove the cast.</p>
<p><strong>Example</strong>:</p>
<pre><code>protected static int Reflect(int value, int bits) { ... }

if (m_RefIn ^ m_RefOut) crc = (int)Reflect(crc, 32);</code></pre>
<p>This might indicate a coding error.</p>
<h4 data-number="9.3.1.15"><span class="header-section-number">9.3.1.15</span> S2259: Variable is null on at least one execution path</h4>
<p><sup><em>Requirement: CREQ0260; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:09:30Z; Modified: 2019-11-02 14:10:02Z.</em></sup></p>
<p>This is a probable bug, that could lead to a <strong>NullReferenceException</strong>. It should be analyzed and fixed.</p>
<h4 data-number="9.3.1.16"><span class="header-section-number">9.3.1.16</span> S2292: Make this an auto-implemented property</h4>
<p><sup><em>Requirement: CREQ0261; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:10:14Z; Modified: 2019-11-02 14:11:34Z.</em></sup></p>
<p>Reduce the amount of code, and reduce possible errors during initialization by using auto-properties.</p>
<p><strong>Old</strong>:</p>
<pre><code>private int m_Value = 42;
public int Value {
  get { return m_Value; }
  set { m_Value = value; }
}</code></pre>
<p><strong>New</strong>:</p>
<pre><code>public int Value { get; set; } = 42;</code></pre>
<h4 data-number="9.3.1.17"><span class="header-section-number">9.3.1.17</span> S2328: Refactor GetHashCode to not reference mutable fields</h4>
<p><sup><em>Requirement: CREQ0262; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:11:48Z; Modified: 2019-11-02 14:13:25Z.</em></sup></p>
<p>.NET implementations such as <strong>Dictionary</strong>and <strong>HashSet</strong>use the <strong>GetHashCode</strong>function when sorting and inserting the object into their data structure. If the <strong>GetHashCode</strong>were mutable, this would cause errors in those data structures (the objects might not be found, sorting breaks).</p>
<p>To fix this, parameters within <strong>GetHashCode</strong>should reference <strong>readonly</strong>properties only.</p>
<h4 data-number="9.3.1.18"><span class="header-section-number">9.3.1.18</span> S2347: Remove this silly bit operation</h4>
<p><sup><em>Requirement: CREQ0263; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:13:55Z; Modified: 2019-11-02 14:14:21Z.</em></sup></p>
<p>This indicates dead code and should be removed</p>
<p><strong>Example</strong>:</p>
<pre><code>typeInfo |= 0x00;</code></pre>
<h4 data-number="9.3.1.19"><span class="header-section-number">9.3.1.19</span> S2486: Handle the exception or explain why it can be ignored</h4>
<p><sup><em>Requirement: CREQ0264; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:14:33Z; Modified: 2019-11-02 14:16:29Z.</em></sup></p>
<p>MSDN rules state that general catch all&#39;s should not be used. Some exceptions are not catchable regardless of a try/catch operation (e.g. such as memory corruption, unless overridden in the applications configuration file).</p>
<p>Fix by catching only those exceptions expected and implement proper unit tests.</p>
<p>Workaround the problem by providing a comment in the block why it can be ignored.</p>
<p><strong>Example</strong>:</p>
<pre><code>try {
  lock (m_SocketLock) {
    // Indicate that we want to close the socket and end (no retries)
    m_SocketClosed.Set();
    if (m_SocketReader != null) m_SocketReader.Close();
    if (m_Socket != null) m_Socket.Close();
  }
} catch { }</code></pre>
<h4 data-number="9.3.1.20"><span class="header-section-number">9.3.1.20</span> S2583: Change condition so that it does not always evaluate to false; some subsequent code is never executed</h4>
<p><sup><em>Requirement: CREQ0265; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:16:37Z; Modified: 2019-11-06 19:27:35Z.</em></sup></p>
<p>SonarLint has detected that a variable check is always false, so that an if block is never entered. This indicates a bug by having dead code.</p>
<p><strong>Warning</strong>:</p>
<p>SonarLint 4.13 appears to have a false positive where it doesn&#39;t properly process try/catch blocks.</p>
<pre><code>bool created = false;
int attempts = CopyWaitAttempts;
DeleteFile(fullPath);
do {
  try {
    Directory.CreateDirectory(fullPath);
    created = true;
  } catch (AccessViolationException) {
    if (attempts == 0) throw;
  } catch (UnauthorizedAccessException) {
    // On windows occurs if the file is already open.
    if (attempts == 0) throw;
  }
  
  if (!created) {
    // If the copy failed, it&#39;s because it&#39;s probably already open somewhere else. So we
    // wait 250ms and try again.
    --attempts;
    Thread.Sleep(CopyWaitInterval);
  }
} while (!created);</code></pre>
<p>The bug is with the<strong>if (!created)</strong>, clearly the analyzer did not see that <strong>created</strong>is set to <strong>false</strong>, and only set to <strong>true</strong>on success.</p>
<h4 data-number="9.3.1.21"><span class="header-section-number">9.3.1.21</span> S2589: Change condition so that it does not always evaluate to true</h4>
<p><sup><em>Requirement: CREQ0266; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:19:37Z; Modified: 2019-11-02 14:19:47Z.</em></sup></p>
<h4 data-number="9.3.1.22"><span class="header-section-number">9.3.1.22</span> S2737: Add logic to this catch clause or eliminate it and rethrow automatically</h4>
<p><sup><em>Requirement: CREQ0267; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Stereotype: Functional; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:21:11Z; Modified: 2019-11-04 19:52:43Z.</em></sup></p>
<p>Should not have catch clauses that only rethrow exceptions</p>
<p><strong>Old</strong>:</p>
<pre><code>try {
  DoSomething();
} catch {
  throw;
} finally {
  CleanUp();
}</code></pre>
<p><strong>New</strong>:</p>
<pre><code>try {
  DoSomething();
} finally {
  CleanUp();
}</code></pre>
<h4 data-number="9.3.1.23"><span class="header-section-number">9.3.1.23</span> S3218: Rename this field to not shadow the outer class member</h4>
<p><sup><em>Requirement: CREQ0268; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:23:28Z; Modified: 2019-11-02 14:24:59Z.</em></sup></p>
<p>A class outer class has defined a member variable, the inner class shadows this with a new declaration.</p>
<p>Rename, so that maintainers don&#39;t get confused about which variable is being accessed.</p>
<h4 data-number="9.3.1.24"><span class="header-section-number">9.3.1.24</span> S3237: Use the value parameter in the event add/remove or property set declaration</h4>
<p><sup><em>Requirement: CREQ0269; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:25:32Z; Modified: 2019-11-02 14:26:20Z.</em></sup></p>
<p>Not using the value means that the accessor ignores the caller&#39;s intent which could cause unexpected results at runtime.</p>
<h4 data-number="9.3.1.25"><span class="header-section-number">9.3.1.25</span> S3246: Add the &#39;in&#39; keyword to make it contravariant</h4>
<p><sup><em>Requirement: CREQ0271; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:27:41Z; Modified: 2019-11-06 19:27:18Z.</em></sup></p>
<p>In the interests of making code as usable as possible, interfaces and delegates with generic parameters should use the out and in modifiers when possible to make the interfaces and delegates covariant and contravariant, respectively.</p>
<p>The <strong>out</strong>keyword can be used when the type parameter is used only as a return type in the <strong>interface</strong>or <strong>delegate</strong>. Doing so makes the parameter covariant, and allows <strong>interface</strong>and <strong>delegate</strong>instances created with a sub-type to be used as instances created with a base type. The most notable example of this is <strong>IEnumerable&lt;out T&gt;</strong>, which allows the assignment of an <strong>IEnumerable&lt;string&gt;</strong> instance to an <strong>IEnumerable&lt;object&gt;</strong> variable, for instance.</p>
<p>The in keyword can be used when the type parameter is used only as a method parameter in the interface or a parameter in the delegate. Doing so makes the parameter contravariant, and allows interface and delegate instances created with a base type to be used as instances created with a sub-type. I.e. this is the inversion of covariance. The most notable example of this is the <strong>Action&lt;in T&gt;</strong> delegate, which allows the assignment of an <strong>Action&lt;object&gt;</strong> instance to a <strong>Action&lt;string&gt;</strong> variable, for instance.</p>
<p><strong>Old</strong>:</p>
<pre><code>interface IConsumer&lt;T&gt; {  // Noncompliant
  bool Eat(T fruit);
}</code></pre>
<p><strong>New</strong>:</p>
<pre><code>interface IConsumer&lt;in T&gt; {
  bool Eat(T fruit);
}</code></pre>
<h4 data-number="9.3.1.26"><span class="header-section-number">9.3.1.26</span> S3376: Make class name end with EventArgs</h4>
<p><sup><em>Requirement: CREQ0273; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:30:05Z; Modified: 2019-11-02 14:30:31Z.</em></sup></p>
<p>Use standard naming conventions as prescribed by .NET</p>
<h4 data-number="9.3.1.27"><span class="header-section-number">9.3.1.27</span> S3415: Make sure arguments are in the correct order</h4>
<p><sup><em>Requirement: CREQ0274; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:30:50Z; Modified: 2019-11-02 14:32:21Z.</em></sup></p>
<p>Assertions in test code is comparing a value/function call against a constant. The order should be</p>
<pre><code>Assert.That(variable, Is.EqualTo(constant))
Assert.AreEqual(constant, variable)</code></pre>
<p>This checks that calls are as MSTest, NUnit or XUnit expect.</p>
<h4 data-number="9.3.1.28"><span class="header-section-number">9.3.1.28</span> S3453: This class can&#39;t be instantiated, make it&#39;s constructor public</h4>
<p><sup><em>Requirement: CREQ0275; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:32:37Z; Modified: 2019-11-06 19:26:30Z.</em></sup></p>
<p>A <strong>class</strong>is defined that it cannot be instantiated, so it is dead code.</p>
<p><strong>Warning</strong>:</p>
<p>A valid case of this warning is defining classes derived from <strong>SafeHandle</strong>. The class is instantiated by the .NET marshaller, and the constructor is expected to be <strong>private</strong>.</p>
<pre><code>internal sealed class SafeLibraryHandle : SafeHandle {
  private SafeLibraryHandle() : base(IntPtr.Zero, true) { }

  public override bool IsInvalid {
      get { return base.handle == IntPtr.Zero; }
  }

  protected override bool ReleaseHandle() {
      return UnsafeNativeMethods.FreeLibrary(base.handle);
  }
}</code></pre>
<h4 data-number="9.3.1.29"><span class="header-section-number">9.3.1.29</span> S3459: Remove unassigned autoproperty, or set its value</h4>
<p><sup><em>Requirement: CREQ0277; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:37:13Z; Modified: 2019-11-06 19:26:18Z.</em></sup></p>
<p>A property which is private, or in a <strong>private class</strong>is defined, but never set. This could indicate a bug, or dead code.</p>
<h4 data-number="9.3.1.30"><span class="header-section-number">9.3.1.30</span> S3869: Refactor code to remove SafeHandle.DangerousGetHandle</h4>
<p><sup><em>Requirement: CREQ0278; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:38:02Z; Modified: 2019-11-06 19:26:12Z.</em></sup></p>
<p>The usage of <strong>DangerousGetHandle</strong>is problematic as there is no reference counting or memory management. Should an exception occur at any time (including unexpected exceptions, such as aborting threads), handles might not be properly freed.</p>
<p>There is also the possibility that the handle obtained is freed at any time by the object it was obtained from, thus resulting in crashes with Native code.</p>
<p>This is a difficult topic, and should be avoided where ever possible.</p>
<h4 data-number="9.3.1.31"><span class="header-section-number">9.3.1.31</span> S3881: Fix implementation of IDIsposable to conform to the DIspose pattern</h4>
<p><sup><em>Requirement: CREQ0279; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:39:55Z; Modified: 2019-11-06 19:26:05Z.</em></sup></p>
<p>Not properly implementing the <strong>Dispose</strong> pattern can result in memory or resource leaks and poor performing code.</p>
<h4 data-number="9.3.1.32"><span class="header-section-number">9.3.1.32</span> S3889: Remove use of Thread.Resume and Thread.Suspend</h4>
<p><sup><em>Requirement: CREQ0280; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:40:47Z; Modified: 2019-11-06 19:25:59Z.</em></sup></p>
<p>Use other synchronization primitives, such as <strong>ManualResetEvent</strong>, etc. to properly control when threads are paused and resumed.</p>
<p>These methods should never be used.</p>
<h4 data-number="9.3.1.33"><span class="header-section-number">9.3.1.33</span> S3925: Update implementation of ISerializable to conform to recommended pattern</h4>
<p><sup><em>Requirement: CREQ0281; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:41:49Z; Modified: 2019-11-06 19:25:57Z.</em></sup></p>
<p>Typically occurs when implementing exceptions. The serialization interface patter should be properly implemented.</p>
<p><strong>Example</strong>:</p>
<pre><code>[Serializable]
public class MyException : Exception {
  public MyException() { }

  protected MyException(SerializationInfo info, StreamingContext context) {
    ...
  }

  public override void GetObjectData(SerializationInfo info, StreamingContext context) {
    ..
  }
}</code></pre>
<h4 data-number="9.3.1.34"><span class="header-section-number">9.3.1.34</span> S3928: Use a constructor overload that allows more meaningful exception error message</h4>
<p><sup><em>Requirement: CREQ0282; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:46:11Z; Modified: 2019-11-02 14:46:56Z.</em></sup></p>
<p>Avoid raising exceptions like</p>
<pre><code>throw new ArgumentException();</code></pre>
<p>Instead</p>
<pre><code>throw new ArgumentException(&quot;Input of wrong type&quot;);</code></pre>
<h4 data-number="9.3.1.35"><span class="header-section-number">9.3.1.35</span> S3966: Refactor to ensure code is only disposed once</h4>
<p><sup><em>Requirement: CREQ0283; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:47:06Z; Modified: 2019-11-02 14:47:37Z.</em></sup></p>
<p>Do not dispose an object twice. This may lead to an <strong>ObjectDisposedException</strong>.</p>
<h4 data-number="9.3.1.36"><span class="header-section-number">9.3.1.36</span> S3971: Do not call GC.SuppressFinalize</h4>
<p><sup><em>Requirement: CREQ0284; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:47:49Z; Modified: 2019-11-02 14:48:14Z.</em></sup></p>
<p>A call to <strong>GC.SuppressFinalize()</strong> should only occur in the Dispose method of an object.</p>
<h4 data-number="9.3.1.37"><span class="header-section-number">9.3.1.37</span> S4144: Update method that the implementation is not identical to another method</h4>
<p><sup><em>Requirement: CREQ0288; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:51:53Z; Modified: 2019-11-02 14:52:39Z.</em></sup></p>
<p>This is often a copy/paste bug, and indicates unintended behavior.</p>
<h4 data-number="9.3.1.38"><span class="header-section-number">9.3.1.38</span> S4487: Remove unread private field</h4>
<p><sup><em>Requirement: CREQ0289; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:53:01Z; Modified: 2019-11-02 14:53:25Z.</em></sup></p>
<p>See IDE0052</p>
<h4 data-number="9.3.1.39"><span class="header-section-number">9.3.1.39</span> S4583: Pair BeginInvoke with EndInvoke</h4>
<p><sup><em>Requirement: CREQ0290; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:53:33Z; Modified: 2019-11-06 19:25:48Z.</em></sup></p>
<p>The objects should be paired, so that thread execution is synchronized and that there are no memory leaks.</p>
<p>Alternatively, rewrite code to use threads instead;</p>
<p><strong>Old</strong>:</p>
<pre><code>Action startServer = () =&gt; {
  Thread.Sleep(2000);
  gnLogServer.Listen(TestConfig.GnLogListenPort);
};
startServer.BeginInvoke(null, null);</code></pre>
<p><strong>New (preferred)</strong>:</p>
<pre><code>Thread startServer = new Thread(() =&gt; {
  Thread.Sleep(2000);
  gnLogServer.Listen(TestConfig.GnLogListenPort);
});
startServer.Start();
Assert.That(startServer.Join(5000), Is.True);</code></pre>
<h3 data-number="9.3.2"><span class="header-section-number">9.3.2</span> Aesthetic Rules which Should be Enabled</h3>
<p><sup><em>Requirement: CREQ0246; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:45:34Z; Modified: 2019-11-02 13:45:48Z.</em></sup></p>
<h4 data-number="9.3.2.1"><span class="header-section-number">9.3.2.1</span> S125: Remove the commented out code</h4>
<p><sup><em>Requirement: CREQ0254; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:58:28Z; Modified: 2019-11-02 13:59:52Z.</em></sup></p>
<p>Commented out code usually indicates a refactoring and the code is either outdated, or is a TODO element. One should remove it if it is no longer relevant, and rely on revision control systems to know what changed.</p>
<p><strong>Warning</strong>:</p>
<p>SonarLint often marks this as a false positive if it sees some particular characters, such as <strong>;</strong>, and may need to be suppressed as needed.</p>
<h4 data-number="9.3.2.2"><span class="header-section-number">9.3.2.2</span> S1121: Extract the assignment from this expression</h4>
<p><sup><em>Requirement: CREQ0247; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:45:50Z; Modified: 2019-11-02 15:36:00Z.</em></sup></p>
<p>SonarLint is warning that the expression is probably complicated and difficult to read</p>
<p><strong>Example</strong>:</p>
<pre><code>cbuf[--i] = (char)(&#39;0&#39; | (v &gt;&gt;= 4) &amp; 0xf);</code></pre>
<p>It&#39;s stating that the variable <strong>v</strong> should be extracted.</p>
<p>It&#39;s up to the user, if readability is impacted or not. One reason to ignore this would be for code that is repetitive and repeated multiple times. Extracting this variable might increase the size of the code significantly making it larger than a screen, where what is important are the changes between each line.</p>
<h4 data-number="9.3.2.3"><span class="header-section-number">9.3.2.3</span> S1128: Remove this unnecessary using</h4>
<p><sup><em>Requirement: CREQ0249; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:49:50Z; Modified: 2019-11-06 19:25:36Z.</em></sup></p>
<p>Remove using statements within the namespace which aren&#39;t referenced anywhere.</p>
<p><strong>Example</strong>:</p>
<pre><code>using System;
using System.Text;</code></pre>
<p>There is no code using <strong>System.Text</strong>, so it should be removed.</p>
<p><strong>Warning</strong>:</p>
<p>In SonarLint 4.13.0.11687 there are two bugs:</p>
<ul>
<li><p>using System.Linq will be warned even if there is the usage of the select keyword. Removing this will break compilation.</p></li>
<li><p>using &lt;namespace&gt; will be warned even if there is a MAML documentation statement referencing the namespace. Removing this will break documentation generation.</p></li>
</ul>
<h4 data-number="9.3.2.4"><span class="header-section-number">9.3.2.4</span> S1144: Remove the unused private field</h4>
<p><sup><em>Requirement: CREQ0251; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:53:45Z; Modified: 2019-11-02 13:53:56Z.</em></sup></p>
<p>See IDE0051</p>
<h4 data-number="9.3.2.5"><span class="header-section-number">9.3.2.5</span> S1939: Interface implements another interface and so can be removed</h4>
<p><sup><em>Requirement: CREQ0259; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:07:54Z; Modified: 2019-11-06 19:25:28Z.</em></sup></p>
<p>The .NET framework has interfaces that derive from other interfaces. It is only necessary to derive from one interface, not all of them.</p>
<p><strong>Old</strong>:</p>
<pre><code>public class MyList : IList&lt;int&gt;, ICollection&lt;int&gt;, IEnumerable&lt;int&gt;</code></pre>
<p><strong>New (fix)</strong>:</p>
<pre><code>public class MyList : IList&lt;int&gt;</code></pre>
<h4 data-number="9.3.2.6"><span class="header-section-number">9.3.2.6</span> S3241: Change return type to void, not a single caller uses the value</h4>
<p><sup><em>Requirement: CREQ0270; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:26:38Z; Modified: 2019-11-02 14:27:12Z.</em></sup></p>
<p>Private methods are clearly intended for use only within their own scope. When such methods return values that are never used by any of their callers, then clearly there is no need to actually make the return, and it should be removed in the interests of efficiency and clarity.</p>
<h4 data-number="9.3.2.7"><span class="header-section-number">9.3.2.7</span> S3358: Extract this nested ternary operation</h4>
<p><sup><em>Requirement: CREQ0272; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:29:08Z; Modified: 2019-11-02 14:29:45Z.</em></sup></p>
<p>SonarLint has determined that there are nested ternary operators. The readability of the code is made much more difficult because of this, and the intent of the code can be misunderstood.</p>
<h4 data-number="9.3.2.8"><span class="header-section-number">9.3.2.8</span> S3458: Remove this empty case clause</h4>
<p><sup><em>Requirement: CREQ0276; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:34:39Z; Modified: 2019-11-06 19:25:19Z.</em></sup></p>
<p>SonarLint will indicate a warning if there is a case statement which is empty and it falls through to the default case.</p>
<p><strong>Example:</strong></p>
<pre><code>switch (subtype) {
case TraceSvr.RT_SCOPE_COUNT:
  GetScopeCount();
  break;
case TraceSvr.RT_PROCESS_COUNT:
case TraceSvr.RT_SERVER_VERSION:
default:
  overhead += packetLength;
}</code></pre>
<p>It might be desirable to keep the case statements to show that specific cases are expected to be the same as the default case, so in a code review one can see if something might be missing or not.</p>
<h4 data-number="9.3.2.9"><span class="header-section-number">9.3.2.9</span> S3973: Use curly braces or indentation with if statements</h4>
<p><sup><em>Requirement: CREQ0285; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:48:49Z; Modified: 2019-11-02 14:49:08Z.</em></sup></p>
<p>In the absence of enclosing curly braces, the line immediately after a conditional is the one that is conditionally executed. By both convention and good practice, such lines are indented. In the absence of both curly braces and indentation the intent of the original programmer is entirely unclear and perhaps not actually what is executed. Additionally, such code is highly likely to be confusing to maintainers.</p>
<h4 data-number="9.3.2.10"><span class="header-section-number">9.3.2.10</span> S4143: Verify that setting key/index was intended, value has already been set</h4>
<p><sup><em>Requirement: CREQ0287; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:50:26Z; Modified: 2019-11-02 14:51:46Z.</em></sup></p>
<p>SonarLint is able to identify in some situations where indexers are set multiple times to the same value. This would indicate dead code.</p>
<p><strong>Example</strong>:</p>
<pre><code>variables.Add(&quot;X&quot;, false);
variables.Add(&quot;Y&quot;, false);

variables[&quot;X&quot;] = false;
variables[&quot;Y&quot;] = false;</code></pre>
<h4 data-number="9.3.2.11"><span class="header-section-number">9.3.2.11</span> S4136: Method overloads should be adjacent</h4>
<p><sup><em>Requirement: CREQ0286; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 14:49:23Z; Modified: 2019-11-02 18:05:55Z.</em></sup></p>
<p>When writing code, all methods of the same name with overloads should be adjacent to one another.</p>
<p>This makes it easier to find code, and functionally should be strongly related to one another.</p>
<h3 data-number="9.3.3"><span class="header-section-number">9.3.3</span> Rules for Disablement</h3>
<p><sup><em>Requirement: CREQ0126; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 21:02:34Z; Modified: 2019-11-02 18:12:54Z.</em></sup></p>
<h4 data-number="9.3.3.1"><span class="header-section-number">9.3.3.1</span> S101: Rename class to match pascal casing rules</h4>
<p><sup><em>Requirement: CREQ0240; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:32:33Z; Modified: 2019-11-02 13:33:04Z.</em></sup></p>
<p>Renaming classes may break API, this should be checked during the code review.</p>
<h4 data-number="9.3.3.2"><span class="header-section-number">9.3.3.2</span> S1066: Collapsible &quot;if&quot; statements should be merged</h4>
<p><sup><em>Requirement: CREQ0204; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:27:17Z; Modified: 2019-11-02 11:28:30Z.</em></sup></p>
<p>Collapsing if statements may make it more difficult to read the purpose of checks.</p>
<p>In some instances of code, two if statements may be desirable, if the intended checks are independent of each other.</p>
<h4 data-number="9.3.3.3"><span class="header-section-number">9.3.3.3</span> S1168: Return an empty collection instead of null</h4>
<p><sup><em>Requirement: CREQ0205; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:30:33Z; Modified: 2019-11-02 13:01:09Z.</em></sup></p>
<p>Code should strive to never return <strong>null</strong>, and all code reviews should still consider this a code smell.</p>
<p>Where code returns <strong>null</strong>, it should be considered why, as this can lead to a <strong>NullReferenceException</strong>. Instead, code should return an empty collection.</p>
<p>However, it may not be plausible to return an empty collection when the caller must distinguish between a value empty collection and an error. It is acceptable (and preferred) that a function avoid raising exceptions where ever possible, if it is to be caught internally, and so returning null is in preference of raising exceptions.</p>
<p>For public API, one should consider instead a Try method that returns false instead of returning null.</p>
<p>For example</p>
<pre><code>if (!myClass.TryGetCollection(out List&lt;string&gt; myList)) {
  // Handle the error
}</code></pre>
<p>instead of</p>
<pre><code>List&lt;string&gt; myList = myClass.GetCollection();
if (myList == null) {
  // Handle the error
}</code></pre>
<h4 data-number="9.3.3.4"><span class="header-section-number">9.3.3.4</span> S2344: Enumeration type names should not have &#39;Flags&#39; or &#39;Enum&#39; suffixes</h4>
<p><sup><em>Requirement: CREQ0206; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:42:48Z; Modified: 2019-11-02 11:43:41Z.</em></sup></p>
<p>This rule can be ignored, it doesn&#39;t necessarily improve readability.</p>
<p>Often, code that uses P/Invoke names enumerations as such to be consistent with WinAPI.</p>
<h4 data-number="9.3.3.5"><span class="header-section-number">9.3.3.5</span> S2346: Flags enumerations zero-value members should be named &#39;None&#39;</h4>
<p><sup><em>Requirement: CREQ0207; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:43:50Z; Modified: 2019-11-02 11:45:07Z.</em></sup></p>
<p>Often it makes sense to name the zero-value members of an enumeration something else. This is often done in the case of bit fields, where a zero value is equivalent to having a bit disabled (e.g. the default value).</p>
<p>This rule doesn&#39;t necessarily improve readability.</p>
<h4 data-number="9.3.3.6"><span class="header-section-number">9.3.3.6</span> S2933: Fields should be &quot;readonly&quot;</h4>
<p><sup><em>Requirement: CREQ0127; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 21:02:54Z; Modified: 2019-11-02 13:02:20Z.</em></sup></p>
<p>This option should be disabled. The recommendation for enabling this rule is to make it clear what objects should be defined in the constructor.</p>
<p><strong>Dispose</strong> methods in framework code often want to set objects to <strong>null</strong> so that objects can be collected sooner, in case the user doesn&#39;t release the reference to the Framework code immediately. Having <strong>readonly</strong> properties makes this not possible.</p>
<p>The use of <strong>readonly</strong>on Visual Studio 2015 U3 has been observed to introduce subtle bugs in the system where fields of a <strong>struct</strong>were no longer modifiable (no exception was raised, the debugger showed the value was being updated, but immediately out of context the value was lost resulting in incorrect state).</p>
<h4 data-number="9.3.3.7"><span class="header-section-number">9.3.3.7</span> S3217: Explicit conversion of foreach loops should not be used</h4>
<p><sup><em>Requirement: CREQ0208; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:45:16Z; Modified: 2019-11-02 11:51:03Z.</em></sup></p>
<p>Code iterating over <strong>foreach</strong>loops may define a variable which is different to the <strong>IEnumerable</strong>type.</p>
<p><strong>Example</strong>:</p>
<pre><code>foreach (TraceLineDltBase line in myTraceReaderDlt) {
  // Do something
}</code></pre>
<p>The warning will be raised on this, as the object <strong>myTraceReaderDlt</strong>implements <strong>IEnumerable&lt;ITraceLine&gt;</strong>. If the API stipulates that all objects returned are a derived type, then it is no different to:</p>
<pre><code>foreach (ITraceLine readLine in myTraceReaderDlt) {
  TraceLineDltBase line = (TraceLineDltBase)readLine;
  // Do something
}</code></pre>
<p>One could argue that this should be written instead</p>
<pre><code>foreach (ITraceLine readLine in myTraceReaderDlt) {
  if (readLine is TraceLineDltBase line) {
    // Do something
  }
}</code></pre>
<p>but the usage of the <strong>is</strong>/ <strong>as</strong>operator is slower than a type cast and may be a problem for performance critical code.</p>
<p>The ultimate solution is to change the object <strong>myTraceReaderDlt</strong>to derive instead from <strong>IEnumerable&lt;TraceLineDltBase&gt;</strong>, but for some projects this might not be possible.</p>
<h4 data-number="9.3.3.8"><span class="header-section-number">9.3.3.8</span> S3626: Jump statements should not be redundant</h4>
<p><sup><em>Requirement: CREQ0209; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 11:51:09Z; Modified: 2019-11-06 19:24:56Z.</em></sup></p>
<p>Code should be reviewed so that unnecessary statements are caught and removed. However, applying this rule religiously may lead to potential maintenance issues when code is copy/pasted (one very common source of error for many programmers).</p>
<p>If there are a group of <strong>if</strong> statements, and the ordering is of no importance, it may be that it is desirable that all blocks use the keyword <strong>return</strong>, even if this would be redundant for the last <strong>if</strong> block.</p>
<p><strong>Example</strong>:</p>
<pre><code>if (x == 0) {
  if (a == 1) {
    StartStateMachine();
    return;
  } else if (a == 2) {
    ProcessInputOne();
    return;
  } else if (a == 3) {
    ProcessInputTwo();
    return;
  }
  
  // We&#39;re done
}</code></pre>
<p>Any other value results in no change in this function. If for whatever reason a bug fix requires something to be done in the case that the variable <strong>a</strong> is not in the range 1, 2, or 3, the developer may add a default case, test it, but not retest the existing cases resulting in the introduction of a bug.</p>
<p>Reviews should consider this type of code if it can be refactored (e.g. as a <strong>switch</strong>statement), but the <strong>return</strong>statement is a conscience decision from the developer to tell the reader that the function should end at the location provided.</p>
<h4 data-number="9.3.3.9"><span class="header-section-number">9.3.3.9</span> S4070: Non-flag enums should not be marked with FlagsAttribute</h4>
<p><sup><em>Requirement: CREQ0210; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:01:24Z; Modified: 2019-11-02 12:02:42Z.</em></sup></p>
<p>SonarLint often shows this warning, when the intent of the <strong>enum</strong>(the values present in the field) are clearly a bit field, even if not used as such.</p>
<p>Keeping the <strong>FlagsAttribute</strong>increases readability at makes it obvious the purpose of the <strong>enum</strong>.</p>
<h2 data-number="9.4"><span class="header-section-number">9.4</span> Visual Studio 2019 Code Analyzers (v16.3.9)</h2>
<p><sup><em>Requirement: CREQ0211; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:03:08Z; Modified: 2019-11-15 20:17:13Z.</em></sup></p>
<p>The Visual Studio IDE contains many rules implemented within the Roslyn Compiler to identify potential code errors. Many of these rules are being added as replacement for FxCop and other Microsoft analyzers.</p>
<h3 data-number="9.4.1"><span class="header-section-number">9.4.1</span> Rules Which should not be Ignored</h3>
<p><sup><em>Requirement: CREQ0220; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:18:31Z; Modified: 2019-11-02 12:18:43Z.</em></sup></p>
<h4 data-number="9.4.1.1"><span class="header-section-number">9.4.1.1</span> IDE0051: Private member is unused</h4>
<p><sup><em>Requirement: CREQ0238; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:24:56Z; Modified: 2019-11-02 13:25:53Z.</em></sup></p>
<p>This applies to private members, methods as well as constants. If the value is private but it is not read.</p>
<p>The member, method or constant should be removed.</p>
<h4 data-number="9.4.1.2"><span class="header-section-number">9.4.1.2</span> IDE0052: Private member can be removed as it&#39;s never read</h4>
<p><sup><em>Requirement: CREQ0233; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:22:45Z; Modified: 2019-11-02 13:26:50Z.</em></sup></p>
<p>Private members are assigned to, but are never read.</p>
<p>This indicates that code was likely refactored and old variables remained behind, and might still be used. Removing these members will simplify code.</p>
<h4 data-number="9.4.1.3"><span class="header-section-number">9.4.1.3</span> IDE0059: Unnecessary assignment of variable</h4>
<p><sup><em>Requirement: CREQ0234; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:22:57Z; Modified: 2019-11-06 19:24:48Z.</em></sup></p>
<p>A variable in a function is assigned to, but it is a useless assignment. Keep the variable, but remove the useless assignment.</p>
<p><strong>Old</strong>:</p>
<pre><code>FileStream filelock = null;
filelock = new FileStream(fileName);</code></pre>
<p><strong>New (fix)</strong>:</p>
<pre><code>fileStream filelock;
filelock = new FileStream(fileName);</code></pre>
<h4 data-number="9.4.1.4"><span class="header-section-number">9.4.1.4</span> IDE0067: Ensure objects are disposed</h4>
<p><sup><em>Requirement: CREQ0221; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:18:51Z; Modified: 2019-11-02 13:29:48Z.</em></sup></p>
<p>An object is instantiated that implements IDIsposable. That object is never disposed. Dispose the object to fix the warning.</p>
<h4 data-number="9.4.1.5"><span class="header-section-number">9.4.1.5</span> IDE0068: Use the recommended dispose pattern to ensure that object is disposed on all paths with a using statement or try/finally</h4>
<p><sup><em>Requirement: CREQ0222; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:19:07Z; Modified: 2019-11-02 13:31:23Z.</em></sup></p>
<p>An object is disposed on some paths, but not all paths.</p>
<h4 data-number="9.4.1.6"><span class="header-section-number">9.4.1.6</span> IDE0069: Disposable field is never disposed</h4>
<p><sup><em>Requirement: CREQ0223; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:19:14Z; Modified: 2019-11-04 19:51:28Z.</em></sup></p>
<p>Update the implementation of the class to implement the <strong>IDisposable</strong>interface and dispose of the object in the <strong>DIspose</strong>method.</p>
<p>This indicates a probably memory leak.</p>
<h3 data-number="9.4.2"><span class="header-section-number">9.4.2</span> Aesthetic Rules which Should be Enabled</h3>
<p><sup><em>Requirement: CREQ0224; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:19:21Z; Modified: 2019-11-02 12:20:52Z.</em></sup></p>
<h4 data-number="9.4.2.1"><span class="header-section-number">9.4.2.1</span> IDE0017: Object initialization can be simplified</h4>
<p><sup><em>Requirement: CREQ0225; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:19:41Z; Modified: 2019-11-06 19:24:26Z.</em></sup></p>
<p>Objects should define their properties with the newer syntax</p>
<p><strong>Old</strong>:</p>
<pre><code>DltLineConfig config = new DltLineConfig();
config.ApplicationId =&quot;FanControl&quot;;
config.EcuId = &quot;MGHI&quot;
config.SessionId = 17;</code></pre>
<p><strong>New (preferred)</strong>:</p>
<pre><code>DltLineConfig config = new DltLineConfig() {
  ApplicationId = &quot;FanControl&quot;,
  EcuId = &quot;MGHI&quot;,
  SessionId = 17
};</code></pre>
<h4 data-number="9.4.2.2"><span class="header-section-number">9.4.2.2</span> IDE0018: Variable declaration can be Inlined</h4>
<p><sup><em>Requirement: CREQ0226; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:19:54Z; Modified: 2019-11-06 19:24:17Z.</em></sup></p>
<p>Use the new inline feature for defining types. This reduces the amount of whitespace making code more condense and allows the variable to be defined immediately where it is used.</p>
<p><strong>Old</strong>:</p>
<pre><code>T item;
if (m_Items.TryGetValue(key, out item)) return item;</code></pre>
<p><strong>New (preferred)</strong>:</p>
<pre><code>if (m_Items.TryGetValue(key out T item)) return item;</code></pre>
<h4 data-number="9.4.2.3"><span class="header-section-number">9.4.2.3</span> IDE0019: Use pattern matching</h4>
<p><sup><em>Requirement: CREQ0227; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:20:05Z; Modified: 2019-11-06 19:24:09Z.</em></sup></p>
<p>Use the new pattern matching feature.</p>
<p><strong>Rationale</strong>:</p>
<ul>
<li><p>Makes unused variable usage more obvious</p></li>
<li><p>Reduces whitespace in code</p></li>
</ul>
<p><strong>Old</strong>:</p>
<pre><code>ResetFactoryDefaultReq request = service as ResetFactoryDefaultReq;
if (request == null) throw new ArgumentException(&quot;Invalid type&quot;, nameof(service));</code></pre>
<p><strong>New (preferred)</strong>:</p>
<pre><code>if (!(service is ResetFactoryDefaultReq request)
  throw new ArgumentException(&quot;Invalid type&quot;, nameof(service));</code></pre>
<p>If it turns out that <strong>request</strong>is not needed, it can simply be removed.</p>
<h4 data-number="9.4.2.4"><span class="header-section-number">9.4.2.4</span> IDE0028: Collection initialization can be simplified</h4>
<p><sup><em>Requirement: CREQ0228; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:20:12Z; Modified: 2019-11-06 19:24:00Z.</em></sup></p>
<p>Initialize the contents of a list while it&#39;s being instantiated</p>
<p><strong>Old</strong>:</p>
<pre><code>List&lt;string&gt; expressions = new List&lt;string&gt;();
expressions.Add(expression);</code></pre>
<p><strong>New (preferred)</strong>:</p>
<pre><code>List&lt;string&gt; expressions = new List&lt;string&gt;() {
  expression
};</code></pre>
<p>As the number of elements being added increase, the code becomes easier to read with less repetition.</p>
<h4 data-number="9.4.2.5"><span class="header-section-number">9.4.2.5</span> IDE0029: Null check can be simplfied (null coalescing)</h4>
<p><sup><em>Requirement: CREQ0229; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:21:02Z; Modified: 2019-11-06 19:23:53Z.</em></sup></p>
<p>Use coalescing</p>
<p><strong>Old</strong>:</p>
<pre><code>if (handler != null) handler(sender == null ? this : sender, args)</code></pre>
<p><strong>New (preferred):</strong></p>
<pre><code>If (handler != null) handler(sender ?? this, args);</code></pre>
<p>Code is shorted, the <strong>?</strong>, <strong>??</strong> operators are obvious when used in the context of <strong>null</strong>.</p>
<h4 data-number="9.4.2.6"><span class="header-section-number">9.4.2.6</span> IDE0031: Null check can be simplified (null propagation)</h4>
<p><sup><em>Requirement: CREQ0230; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:21:11Z; Modified: 2019-11-06 19:23:45Z.</em></sup></p>
<p>Use null propagation</p>
<p><strong>Old</strong>:</p>
<pre><code>return m_FileName == null ? null : m_FileName.ToString();</code></pre>
<p><strong>New (preferred):</strong></p>
<pre><code>return m_FileName?.ToString();</code></pre>
<h4 data-number="9.4.2.7"><span class="header-section-number">9.4.2.7</span> IDE0041: Null check can be simplified (object is null)</h4>
<p><sup><em>Requirement: CREQ0231; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:21:21Z; Modified: 2019-11-06 19:23:34Z.</em></sup></p>
<p>Instead of using the <strong>object.ReferenceEquals</strong>, use the <strong>is</strong> operator.</p>
<p><strong>Old</strong>:</p>
<pre><code>if (object.ReferenceEquals(null, m_OperationId)) { ... }</code></pre>
<p><strong>New (preferred)</strong>:</p>
<pre><code>if (m_OperationId is null) { ... }</code></pre>
<p>Code is shortened and made more readable.</p>
<h4 data-number="9.4.2.8"><span class="header-section-number">9.4.2.8</span> IDE0054: Use compound assignment</h4>
<p><sup><em>Requirement: CREQ0239; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 13:27:03Z; Modified: 2019-11-06 19:23:25Z.</em></sup></p>
<p>Reduce the amount of code written, by using compound assignments</p>
<p><strong>Old</strong>:</p>
<pre><code>value = value + 4;</code></pre>
<p><strong>New (preferred)</strong>:</p>
<pre><code>value += 4;</code></pre>
<h3 data-number="9.4.3"><span class="header-section-number">9.4.3</span> Rules for Disablement</h3>
<p><sup><em>Requirement: CREQ0212; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:04:30Z; Modified: 2019-11-02 12:04:33Z.</em></sup></p>
<h4 data-number="9.4.3.1"><span class="header-section-number">9.4.3.1</span> IDE0016: Null check can be simplified (Exceptions on Null)</h4>
<p><sup><em>Requirement: CREQ0317; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-06 19:10:04Z; Modified: 2019-11-06 19:23:12Z.</em></sup></p>
<p>The rule for detection of the following code</p>
<p><strong>Preferred</strong>:</p>
<pre><code>if (entryPoint == null) throw new ArgumentNullException(nameof(entryPoint));
m_Func = entryPoint;</code></pre>
<p>to convert to</p>
<p><strong>New</strong>:</p>
<pre><code>m_Func = entryPoint ?? throw new ArgumentNullException(nameof(entryPoint));</code></pre>
<p>should be disabled.</p>
<p><strong>Rationale</strong>:</p>
<p>In the case of checking only a single variable, this looks like a benefit. But for the case of checking two or more variables, it may introduce unexpected behavior. A function is expected to check all inputs first <em>before</em> assigning them to module global variables. Doing otherwise may put the object in an unknown/inconsistent state in rare error conditions.</p>
<p>So preferred is</p>
<pre><code>if (entryPoint == null) throw new ArgumentNullException(nameof(entryPoint));
if (description == null) throw new ArgumentNullException(nameof(description));
if (string.IsNullOrEmpty(description)) throw new ArgumentException(nameof(description), &quot;empty!&quot;);

m_Func = entryPoint;
m_Description = description;</code></pre>
<h4 data-number="9.4.3.2"><span class="header-section-number">9.4.3.2</span> IDE0034: Simplify &#39;default&#39; expression</h4>
<p><sup><em>Requirement: CREQ0213; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:04:34Z; Modified: 2019-11-02 13:03:03Z.</em></sup></p>
<p>This is not available in C# 7.0 and so will fail when compiling with Visual Studio 2017. More modern projects should use this if possible.</p>
<h4 data-number="9.4.3.3"><span class="header-section-number">9.4.3.3</span> IDE0039: Use local function</h4>
<p><sup><em>Requirement: CREQ0214; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:05:16Z; Modified: 2019-11-02 12:07:27Z.</em></sup></p>
<p>This is not available in C# 7.0 and so will fail when compiling with Visual Studio 2017.</p>
<p>The usage of lambdas should be used in preference to local functions, to make it obvious the use of anonymous methods.</p>
<p>Many languages have supported nested classes, multiple inheritance, nested functions. Practice has shown that this is often abused and can lead to difficult to maintain code.</p>
<h4 data-number="9.4.3.4"><span class="header-section-number">9.4.3.4</span> IDE0044: Add readonly modifier</h4>
<p><sup><em>Requirement: CREQ0217; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:13:59Z; Modified: 2019-11-06 19:15:50Z.</em></sup></p>
<p>See also S2933</p>
<h4 data-number="9.4.3.5"><span class="header-section-number">9.4.3.5</span> IDE0063: Using simple &#39;using&#39;</h4>
<p><sup><em>Requirement: CREQ0218; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:14:28Z; Modified: 2019-11-06 19:15:55Z.</em></sup></p>
<p>This is not available in C# 7.0 and so will fail when compiling with Visual Studio 2017.</p>
<p>The new form of specifying <strong>using</strong>within a function can significantly reduce nesting. The use of this new form would be encouraged for unit testing only, where the scope of the object is while it is being tested, and should always be disposed before the test case is finished (so as to avoid influencing other test cases running in the test suite).</p>
<p>For production code, use the existing syntax of <strong>using</strong>. This makes it obvious the scope of the object before it is disposed. Simply converting object not disposed to have using without considering each individual case may result in new bugs / regressions.</p>
<h4 data-number="9.4.3.6"><span class="header-section-number">9.4.3.6</span> IDE0066: Use &#39;switch&#39; expressions</h4>
<p><sup><em>Requirement: CREQ0319; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-06 19:15:43Z; Modified: 2019-11-06 19:20:18Z.</em></sup></p>
<p>Prefer the old style switch statements over the newer, more compact versions</p>
<p><strong>Preferred</strong>:</p>
<pre><code>if (window != ProcessWindow.Default) {
  si.dwFlags |= NativeMethods.STARTF.STARTF_USESHOWWINDOW;
  switch (window) {
  case ProcessWindow.Hide:
    si.wShowWindow = NativeMethods.ShowState.SW_HIDE;
    break;
  case ProcessWindow.Maximize:
    si.wShowWindow = NativeMethods.ShowState.SW_SHOWMAXIMIZED;
    break;
  case ProcessWindow.Minimize:
    si.wShowWindow = NativeMethods.ShowState.SW_SHOWMINIMIZED;
    break;
  default:
    si.wShowWindow = NativeMethods.ShowState.SW_SHOWNORMAL;
    break;
  }
}</code></pre>
<p><strong>New</strong>:</p>
<pre><code>if (window != ProcessWindow.Default) {
  si.dwFlags |= NativeMethods.STARTF.STARTF_USESHOWWINDOW;
  si.wShowWindow = window switch {
    ProcessWindow.Hide =&gt; NativeMethods.ShowState.SW_HIDE,
    ProcessWindow.Maximize =&gt; NativeMethods.ShowState.SW_SHOWMAXIMIZED,
    ProcessWindow.Minimize =&gt; NativeMethods.ShowState.SW_SHOWMINIMIZED,
    _ =&gt; NativeMethods.ShowState.SW_SHOWNORMAL,
  };
}</code></pre>
<p>The newer style is compact. In this example, it may be easier to read, but extending functionality can be tedious and introduce errors.</p>
<p>Secondly, the <strong>default</strong>case, which is known to almost all programmers familiar with other languages such as C, C++, won&#39;t necessarily know what the discard case is &#39;<strong>_</strong>&#39;. Thus, the new style is more difficult to read and maintain.</p>
<h4 data-number="9.4.3.7"><span class="header-section-number">9.4.3.7</span> IDE1005: Event Handler Invocation can be simplified</h4>
<p><sup><em>Requirement: CREQ0320; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-06 19:20:32Z; Modified: 2019-11-06 19:22:47Z.</em></sup></p>
<p>Prefer the old style, since C# 4.0, over the new nullable style.</p>
<p><strong>Preferred</strong>:</p>
<pre><code>protected void OnCollectionChanged(object sender, NotifyCollectionChangedEventArgs args) {
  NotifyCollectionChangedEventHandler handler = CollectionChanged;
  if (handler != null) handler(sender, args);
}</code></pre>
<p><strong>New</strong>:</p>
<pre><code>CollectionChanged?.Invoke(sender, args);</code></pre>
<p><strong>Rationale</strong>:</p>
<p>The first style is similar to how other languages, such as C and C++ are written for function pointers and callbacks, so is easier for those developers to read and understand the code that is being done.</p>
<p>For the newer case, there&#39;s an <strong>Invoke()</strong>, which is a method for delegates, but changes the readability from the first case.</p>
<h4 data-number="9.4.3.8"><span class="header-section-number">9.4.3.8</span> IDE1006: Naming Styles</h4>
<p><sup><em>Requirement: CREQ0219; Author: Jason Curl &lt;jcurl@arcor.de&gt;; Status: Proposed; Version: 1.0; Created: 2019-11-02 12:17:34Z; Modified: 2019-11-02 12:18:13Z.</em></sup></p>
<p>Often projects have reasons for using a different naming style, or legacy code. Enabling this message may result in a lot of false positives, making it more difficult to find real issues.</p>
<h2 data-number="9.5"><span class="header-section-number">9.5</span> Code Analysis: Mandatory Ruleset (Microsoft Managed Recommended Rules)</h2>
<p><sup><em>Requirement: CREQ0120; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 20:54:10Z; Modified: 2019-11-02 11:25:17Z.</em></sup></p>
<p>The set of rules defined by Microsoft Managed Recommended Rules shall be mandatory for all projects. This can be accessed via the project properties under the section &quot;Code Analysis&quot;. Additional rules may be specified.</p>
<h3 data-number="9.5.1"><span class="header-section-number">9.5.1</span> Microsoft Binary Analysis (Mid-High)</h3>
<p><sup><em>Requirement: CREQ0114; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-06-13 09:41:32Z; Modified: 2016-07-25 20:58:49Z.</em></sup></p>
<p>The CodeAnalysis plugin is available with paid versions of Microsoft Visual Studio as well as the Community Editions.</p>
<p>CodeAnalysis is a lint tool that highlights common errors based on Microsoft Coding Guidelines.</p>
<p>It is found in the menu Analyze -&gt; Run CodeAnalysis on Solution.</p>
<p>Below are some common error codes considered as a problem during development, but by no means all. Each error code should be analysed on a case-by-case basis and determined if it is a problem or not. Almost all issues are considered an issue and should be fixed.</p>
<h4 data-number="9.5.1.1"><span class="header-section-number">9.5.1.1</span> Some Rules and their Rationale</h4>
<p><sup><em>Requirement: CREQ0128; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 21:07:14Z; Modified: 2016-07-25 21:07:26Z.</em></sup></p>
<h5 data-number="9.5.1.1.1"><span class="header-section-number">9.5.1.1.1</span> CA1065: Do not raise exceptions in unexpected locations</h5>
<p><sup><em>Requirement: CREQ0115; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 08:09:13Z; Modified: 2016-07-25 21:07:29Z.</em></sup></p>
<h5 data-number="9.5.1.1.2"><span class="header-section-number">9.5.1.1.2</span> CA1404: Call GetLastError immediately after P/Invoke</h5>
<p><sup><em>Requirement: CREQ0116; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 08:13:55Z; Modified: 2016-07-25 21:07:30Z.</em></sup></p>
<p>It is important that Marshal.GetLastWin32Error() is called immediately after a P/Invoke, so that the error code determined is well defined, not based on any other function call.</p>
<h5 data-number="9.5.1.1.3"><span class="header-section-number">9.5.1.1.3</span> CA2213: Disposable fields should be disposed</h5>
<p><sup><em>Requirement: CREQ0117; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 08:10:40Z; Modified: 2016-07-25 21:07:31Z.</em></sup></p>
<h5 data-number="9.5.1.1.4"><span class="header-section-number">9.5.1.1.4</span> CA2214: Do not call overridable methods in constructors</h5>
<p><sup><em>Requirement: CREQ0118; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2015-11-10 08:11:11Z; Modified: 2016-07-25 21:07:32Z.</em></sup></p>
<p>A constructor should not call a virtual method from itself, as this can lead to undefined behaviour for derived classes. Refactoring/Redesign of the class is required.</p>
<p>If a derived class overrides the virtual method, and that virtual method then depends on variables of the derived class, its behaviour is undefined. That is because of the order in which the constructors are called.</p>
<p>The base class constructor is called first, which if then uses a virtual method, is executed on a class whose constructor has not yet been called, thus resulting in undefined behaviour.</p>
<h3 data-number="9.5.2"><span class="header-section-number">9.5.2</span> Microsoft.CodeAnalysis.CSharp</h3>
<p><sup><em>Requirement: CREQ0122; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 20:59:18Z; Modified: 2016-07-25 21:00:55Z.</em></sup></p>
<p>All options under this code analysis section should be enabled (part of Microsoft Managed Recommended Rules).</p>
<h3 data-number="9.5.3"><span class="header-section-number">9.5.3</span> Microsoft.CodeAnalysis.CSharp.EditorFeatures</h3>
<p><sup><em>Requirement: CREQ0123; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 20:59:48Z; Modified: 2016-07-25 21:00:58Z.</em></sup></p>
<p>All options under this code analysis section should be enabled (part of Microsoft Managed Recommended Rules).</p>
<h3 data-number="9.5.4"><span class="header-section-number">9.5.4</span> Microsoft.CodeAnalysis.CSharp.Features</h3>
<p><sup><em>Requirement: CREQ0124; Author: jcurl; Status: Proposed; Version: 1.0; Created: 2016-07-25 21:00:10Z; Modified: 2016-07-25 21:01:03Z.</em></sup></p>
<p>All options under this code analysis section should be enabled (part of Microsoft Managed Recommended Rules).</p>
</body>
</html>
